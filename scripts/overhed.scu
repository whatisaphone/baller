rmim {
    raw-block RMIH `0100`
    im {
        bmap 150 "overhed/room.bmp"
        raw-block ZP01 "overhed/RMIM_ZP01.bin"
    }
}
rmda {
    raw-block RMHD `8002e0010f00`
    raw-block CYCL `0000`
    raw-block TRNS `0500`
    raw-block NLSC `8400`
    raw-block POLD "overhed/POLD_000ae684.bin"
}

var rSavedMinJiffies@0
var rBaseClaims@1
var rBallFetcher@2
var rFieldingOrder@3
var rCurrentPlay@4
var rAutoFieldeingDelay@5
var room6@6
var rCaughtFly@7
var rBaseCorners@8
var rDefenseSentiment@9
var room10@10
var rBallWasHitHigh@11
var rCommentQueue@12
var room13@13
var r_smth_fly_caught_runners_must_return@14
var r_maybe_smth_turn@15
var rBallCatchDistance@16
var rCurrentEmote@17
var rRunnerStartingBases@18
var rCastedHitKind@19
var r_runners_zeta@20
var room21@21
var rDrawnBallDistanceDecal@22
var room23@23
var r_maybe_net_fatigue_dirty@24
var rRunnersWhenBallLastThrown@25
var room26@26
var rBallThrownToFielder@27
var room28@28
var room29@29
var room30@30
var r_maybe_disable_powerups@32
var r_maybe_pitcher_is_standing_on_the_mound@33
var room34@34
var room35@35
var room36@36
var room37@37

script NetHandleRunnerMessage@301 arg0 arg1 arg2 {
    case arg0 {
        14 {
            gTeamInfo[gBattingTeamInfoIndex][TI-RUNS] = gTeamInfo[gBattingTeamInfoIndex][TI-RUNS] + 1
            if gNetplayActive {
                start-script smth_net_stats_kludge 0
            }
        }
        20 {
            if (gCurrentRoom == 3) {
                start-script maybe_handle_basepath_click 1 arg1 arg2
            } else {
            }
        }
        else {
            debug 0
        }
    }
}

script TransitionToOverheadView@302 base_on_balls {
    var local1 local2

    if (gRunners && gWorld) {
        array-assign-list gWorld 46 49 0 0 [gWorld[HOME-PLATE-CENTER][X]]
        array-assign-list gWorld 46 49 2 2 [gWorld[HOME-PLATE-CENTER][Z]]
        array-assign-slice gWorld gWorld 35 35 0 2 32 32 0 2
        array-assign-slice gWorld gWorld 36 36 0 2 32 32 0 2
        for local1 = 0 to 3 + {
            if (gRunners[local1][R-CUR-BASE] != NONE) {
                case gRunners[local1][R-CUR-BASE] {
                    [0 R-HOME] {
                        gWorld[gRunners[local1][R-ENTITY]][X] = gWorld[HOME-PLATE-CENTER][X]
                        gWorld[gRunners[local1][R-ENTITY]][Z] = gWorld[HOME-PLATE-CENTER][Z]
                    }
                    FIRST {
                        gWorld[gRunners[local1][R-ENTITY]][X] = gWorld[FIRST-BASE-CENTER][X]
                        gWorld[gRunners[local1][R-ENTITY]][Z] = gWorld[FIRST-BASE-CENTER][Z]
                    }
                    SECOND {
                        gWorld[gRunners[local1][R-ENTITY]][X] = gWorld[SECOND-BASE-CENTER][X]
                        gWorld[gRunners[local1][R-ENTITY]][Z] = gWorld[SECOND-BASE-CENTER][Z]
                    }
                    THIRD {
                        gWorld[gRunners[local1][R-ENTITY]][X] = gWorld[THIRD-BASE-CENTER][X]
                        gWorld[gRunners[local1][R-ENTITY]][Z] = gWorld[THIRD-BASE-CENTER][Z]
                    }
                    else {
                    }
                }
            }
        }
    }
    if gNetplayActive {
        if (gOffenseControlledBy != CB-NETWORK) {
            local2 = 1
        }
    }
    if local2 {
        break-until global504
        current-room overhed
        start-script RunOverheadView
    } else {
        gCurrentRoom = 3
        break-here
        if (MODE-BATTING-PRACTICE == gGameMode) {
            g_smth_play_may_continue = 1
        }
        current-room overhed
        gSimFirstBounceFoul = false
        gBallIsFoul = false
        if base_on_balls {
            gPlayEndedReason = PE-BASE-ON-BALLS
        } else {
            g_smth_play_may_continue = 1
        }
        start-script RunOverheadView
    }
}

script CleanupRunners@303 {
    put-actor (46 - 30) 0 0 0
    put-actor (47 - 30) 0 0 0
    put-actor (48 - 30) 0 0 0
    put-actor (49 - 30) 0 0 0
    undim gRunners
    undim gBases
    gRunners = 0
    gBases = 0
    gNumRunners = 0
}

script DrawBallDistanceDecal@304 distance {
    var decal_x decal_y string

    if (not distance) {
        gLastHomeRunDistance = line-length.3d gBallPosX gBallPosY gBallPosZ gWorld[HOME-PLATE-CENTER][X] 0 gWorld[HOME-PLATE-CENTER][Z] / 12
        if gNetplayActive {
            start-script.rec maybe_net_send_message 30 1 NET-DRAW-BALL-DISTANCE-DECAL gLastHomeRunDistance
        }
    } else {
        gLastHomeRunDistance = distance
    }
    if gUserOnOffense {
        if (gLastHomeRunDistance > gUserLongestHomeRun) {
            gUserLongestHomeRun = gLastHomeRunDistance
        }
    } else if (gLastHomeRunDistance > gOpponentLongestHomeRun) {
        gOpponentLongestHomeRun = gLastHomeRunDistance
    }
    sprintf string "%d" gLastHomeRunDistance
    decal_x = actor-get-x 3 - 5
    if (decal_x > 640) {
        decal_x = 618
    }
    if (decal_x < 0) {
        decal_x = 1
    }
    decal_y = actor-get-y 3 - actor-get-elevation 3 + 6
    if (decal_y > 480) {
        decal_y = 472
    }
    if (decal_y < 0) {
        decal_y = 2
    }
    if (gLastHomeRunDistance < 100) {
        image.init image550
        image.at (decal_x - 12) (decal_y - 5)
        image.draw
        image.end
    } else {
        image.init image550
        image.at (decal_x - 8) (decal_y - 5)
        image.draw
        image.end
    }
    start-script DrawString2 decal_x decal_y 552 string
    undim string
}

script NetApplyRemoteState@305 {
    var local0 local1 local2 local3 local4 local5 local6 local7 local8 local9 local10 local11 local12 local13 local14 local15 local16 local17

    if (gCurrentRoom != 3) {
        stop-script 0
    }
    if (gNetStateBuffer[0][0] == 999) {
        stop-script 0
    }
    local1 = gNetStateBuffer[2][4]
    gBallIsFoul = gNetStateBuffer[21][5]
    gPlayEndedReason = gNetStateBuffer[3][5]
    if gPlayEndedReason {
    }
    gNumOuts = gNetStateBuffer[18][5]
    gFielderWithBall = gNetStateBuffer[18 + 1][5]
    if gNetStateBuffer[2][5] {
        local14 = band (gNetStateBuffer[2][5] >> 8) 255
        local15 = band gNetStateBuffer[2][5] 255
        start-script smth_he9_zplane local14 local15
    }
    if (not gRunners) {
        dim-array-2d.i16 gRunners 3 20
    }
    for local0 = 0 to 3 + {
        gRunners[local0][R-DEST-X] = gNetStateBuffer[18 + local0][0]
        gRunners[local0][R-DEST-Z] = gNetStateBuffer[18 + local0][1]
        local2 = gNetStateBuffer[18 + local0][2]
        gRunners[local0][R-ENTITY] = band (local2 >> 8) 255
        local3 = band local2 15
        if (band local3 8) {
            local3 = 999
        } else {
        }
        gRunners[local0][R-CUR-BASE] = local3
        local4 = band local2 240
        local4 >>= 4
        if (band local4 8) {
            local4 = 999
        } else {
        }
        gRunners[local0][R-DEST-BASE] = local4
        local5 = gNetStateBuffer[18 + local0][3]
        local14 = band (local5 >> 8) 255
        local15 = band local14 31
        local15 >>= 1
        if (local15 <= 9) {
            gRunners[local0][R-ORDER] = local15
        } else {
            gRunners[local0][R-ORDER] = 999
        }
        if (band local14 64) {
            if (room29[local0] == 0) {
                start-script.rec DrawNameUnderKid gRunners[local0][R-KID] (gRunners[local0][R-ENTITY] - 30) 113 0
                room29[local0] = 1
            }
        }
        if (band local14 32) {
            if (room28[local0] == 0) {
                start-script.rec DrawNameUnderKid gRunners[local0][R-KID] (gRunners[local0][R-ENTITY] - 30) 114 0
                room28[local0] = 1
            }
        }
        gRunners[local0][R-KID] = band local5 511
        local6 = gNetStateBuffer[18 + local0][4]
        gRunners[local0][R-STATE] = band (local6 >> 8) 255
        gRunners[local0][R-FORCED] = band local6 15
        gRunners[local0][R-DIRECTION] = band local6 240 >> 4
    }
    if (not gBases) {
        dim-array-2d.i16 gBases 4 2
    }
    for local0 = 0 to 4 + {
        local7 = gNetStateBuffer[17][local0]
        local8 = band (local7 >> 8) 255
        if (band local8 8) {
            local8 = 999
        }
        gBases[local0][BASE-RUNNERIDX] = local8
        local9 = band local7 255
        if (band local9 8) {
            local9 = 999
        }
        gBases[local0][BASE-TAGGED-WITH-BALL] = local9
    }
    if gNetStateBuffer[1][0] {
        start-script PlaySound gNetStateBuffer[1][0] (band gNetStateBuffer[1][5] 256) (band gNetStateBuffer[1][5] 1)
    }
    if gNetStateBuffer[1][1] {
        start-script PlaySound gNetStateBuffer[1][1] (band gNetStateBuffer[1][5] 512) (band gNetStateBuffer[1][5] 2)
    }
    if gNetStateBuffer[1][2] {
        start-script PlaySound gNetStateBuffer[1][2] (band gNetStateBuffer[1][5] 1024) (band gNetStateBuffer[1][5] 4)
    }
    if gNetStateBuffer[1][3] {
        start-script PlaySound gNetStateBuffer[1][3] (band gNetStateBuffer[1][5] 2048) (band gNetStateBuffer[1][5] 8)
    }
    if gNetStateBuffer[1][4] {
        if (band gNetStateBuffer[1][5] 4096) {
            sound.start gNetStateBuffer[1][4]
            sound.soft
            sound.end
        } else {
            sound.start gNetStateBuffer[1][4]
            sound.end
        }
    }
    if gNetStateBuffer[3][4] {
        local17 = band (gNetStateBuffer[3][4] >> 8) 255
        local16 = band gNetStateBuffer[3][4] 255
        start-script CastGameplay local16 local17
    }
    if (not global565) {
        if (not rFieldingOrder) {
            rFieldingOrder = gTeamInfo[abs (gBattingTeamInfoIndex - 1)][TI-FIELDING-ORDER]
        }
        for local0 = 0 to 8 + {
            actor.init (7 + local0)
            actor.new
            actor.costume (call-script maybe_kid_get_costume_fielding rFieldingOrder[local0])
            actor.animation-speed 2
            actor.ignore-boxes
            actor.shadow global423
            start-script smth_actor_palette_team_color (7 + local0) (1 - gBattingTeamInfoIndex)
            start-script smth_actor_kid_palette (7 + local0) rFieldingOrder[local0]
        }
        for local0 = 0 to 3 + {
            if (gRunners[local0][R-CUR-BASE] != NONE) {
                actor.init (16 + local0)
                actor.new
                actor.costume (call-script maybe_kid_get_costume_fielding2 gRunners[local0][R-KID])
                actor.ignore-boxes
                actor.animation-speed 2
                actor.shadow global423
                start-script smth_actor_palette_team_color (16 + local0) gBattingTeamInfoIndex
                start-script smth_actor_kid_palette (16 + local0) gRunners[local0][R-KID]
            } else {
            }
        }
        global565 = 1
    }
    actor.init 3
    actor.elevation gNetStateBuffer[2][2]
    actor.ignore-boxes
    put-actor 3 gNetStateBuffer[2][0] gNetStateBuffer[2][1] 3
    actor.init 3
    actor.scale gNetStateBuffer[2][3]
    actor.init 4
    actor.elevation gNetStateBuffer[3][2]
    actor.ignore-boxes
    put-actor 4 gNetStateBuffer[3][0] gNetStateBuffer[3][1] 3
    actor.init 4
    actor.scale gNetStateBuffer[3][3]
    for local0 = 7 to 15 + {
        local10 = actor-get-costume local0
        local12 = 1 << local0
        local11 = call-script maybe_kid_get_costume_fielding rFieldingOrder[local0 - 7]
        if (local11 != local10) {
            actor.init local0
            actor.costume local11
            start-script smth_actor_palette_team_color local0 (1 - gBattingTeamInfoIndex)
            local13 = 1
        } else {
            local13 = 0
        }
        actor.init local0
        actor.elevation gNetStateBuffer[local0 - 3][2]
        put-actor local0 gNetStateBuffer[local0 - 3][0] gNetStateBuffer[local0 - 3][1] 3
        actor.init local0
        actor.scale (band gNetStateBuffer[local0 - 3][3] 255)
        local14 = kludge-call 1969 local0
        local14 = band local14 65535
        kludge 1969 local0 (gNetStateBuffer[local0 - 3][4] << 16 + local14)
        local14 = band (gNetStateBuffer[local0 - 3][5] >> 8) 255
        actor.init local0
        actor.variable 1 (local14 / 10)
        actor.init local0
        actor.variable 2 (local14 % 10)
        local14 = actor-get-property local0 0 2
        local14 /= 4
        local15 = band (gNetStateBuffer[local0 - 3][3] >> 8) 255
        if (local14 != local15 || local13) {
            do-animation local0 local15
        }
    }
    for local0 = 16 to 19 + {
        if gNetStateBuffer[local0 - 3][0] {
            actor.init local0
            actor.elevation gNetStateBuffer[local0 - 3][2]
            put-actor local0 gNetStateBuffer[local0 - 3][0] gNetStateBuffer[local0 - 3][1] 3
            actor.init local0
            actor.scale (band gNetStateBuffer[local0 - 3][3] 255)
            local14 = kludge-call 1969 local0
            local14 = band local14 65535
            kludge 1969 local0 (gNetStateBuffer[local0 - 3][4] << 16 + local14)
            local14 = band (gNetStateBuffer[local0 - 3][5] >> 8) 255
            actor.init local0
            actor.variable 1 (local14 / 10)
            actor.init local0
            actor.variable 2 (local14 % 10)
            local14 = actor-get-property local0 0 2
            local14 /= 4
            local15 = band (gNetStateBuffer[local0 - 3][3] >> 8) 255
            if (local14 != local15 || local13) {
                do-animation local0 local15
            }
        }
    }
    gNetStateBuffer[0][0] = 999
}

local-script smth_batting_practice_kid_actors@2048 {
    actor.init 6
    actor.new
    actor.costume (call-script maybe_kid_get_costume_fielding2 gBattingPracticeKid)
    actor.elevation 4700
    if (band gKidData[gBattingPracticeKid][KD-HANDEDNESS] 48 >> 4 == 1) {
        put-actor 6 304 (440 + 4700) gCurrentRoom
    } else {
        put-actor 6 336 (440 + 4700) gCurrentRoom
    }
    start-script smth_actor_palette_team_color 6 gBattingTeamInfoIndex
    do-animation 6 6
    actor.init 6
    actor.condition [129]
    actor.init 7
    actor.new
    actor.costume (call-script maybe_kid_get_costume_fielding MR-CLANKY)
    actor.elevation 4148
    put-actor 7 320 (312 + 4148) gCurrentRoom
    start-script smth_actor_palette_team_color 7 (1 - gBattingTeamInfoIndex)
    actor.init 7
    actor.condition [133]
    do-animation 7 6
    actor.init 8
    actor.new
    actor.costume costume652
    actor.elevation 4148
    actor.shadow image257
    put-actor 8 305 (312 + 4148) gCurrentRoom
    actor.init 8
    actor.color 231 (rgb 0 0 0)
    do-animation 8 1
}

local-script NetSendSound@2049 arg0 arg1 arg2 {
    var local3 local4

    if gNetStateBuffer[1][0] {
        if gNetStateBuffer[1][1] {
            if gNetStateBuffer[1][2] {
                local3 = 3
            } else {
                local3 = 2
            }
        } else {
            local3 = 1
        }
    } else {
        local3 = 0
    }
    gNetStateBuffer[1][local3] = arg0
    if arg1 {
        local4 = 1 << (local3 - 0)
        local4 <<= 8
        gNetStateBuffer[1][5] = gNetStateBuffer[1][5] + local4
    }
    if arg2 {
        local4 = 1 << (local3 - 0)
        gNetStateBuffer[1][5] = gNetStateBuffer[1][5] + local4
    }
}

local-script AddFatigue@2050 kid arg1 {
    var local2 local3 local4 local5

    if (kid == MR-CLANKY) {
        stop-script 0
    }
    if gNetplayActive {
        if (g_net_smth_master == g_net_smth_slave) {
            stop-script 0
        }
    }
    local2 = gKidData[kid][KD-fatigue]
    if (local2 > 100) {
        stop-script 0
    }
    case arg1 {
        29 {
            local5 = 4
        }
        30 {
            local5 = 5
        }
        31 {
            local5 = 2
        }
        32 {
            local5 = 8
        }
        33 {
            local5 = 4
        }
        34 {
            local5 = 0
        }
        35 {
            local5 = 2
        }
        36 {
            local5 = 4
        }
        37 {
            local5 = 1
        }
        else {
        }
    }
    local3 = gKidData[kid][KD-STAMINA] - 50
    local4 = local5 - local5 * local3 / 100
    local2 += local4
    if (local2 > 100) {
        local2 = 100
    }
    gKidData[kid][KD-fatigue] = local2
    if gNetplayActive {
        r_maybe_net_fatigue_dirty[kid] = 1
    }
}

local-script SetCurrentEmote@2051 emote {
    rCurrentEmote = emote
    if rCurrentEmote {
        break-here.multi 20
        if (rCurrentEmote == 9) {
            break-here.multi 40
        }
        rCurrentEmote = 0
    }
}

local-script PlayKidEmoteSound@2052 kid emote {
    var local2

    if gNoPlayerChatter {
        stop-script 0
    }
    if (not emote) {
        emote = rCurrentEmote
    }
    if (kid > ALEX-RODRIGUEZ && kid < CUSTOM-KID-0) {
        stop-script 0
    }
    if (kid >= MO-VAUGHN && kid <= ALEX-RODRIGUEZ) {
        case emote {
            1 {
                local2 = random-between 2635 2637
            }
            2 {
                local2 = random-between 2638 2640
            }
            3 {
                local2 = random-between 2641 2644
            }
            4 {
                local2 = random-between 2645 2648
            }
            5 {
                local2 = 2649
            }
            6 {
                local2 = 2650
            }
            7 {
                local2 = random-between 2656 2658
            }
            8 {
                local2 = random-between 2659 2661
            }
            9 {
                local2 = random-between 2665 2667
            }
            10 {
                local2 = random-between 2676 2677
            }
            11 {
                local2 = random-between 2668 2670
            }
            else {
                if (random 1) {
                    local2 = random-between 2671 2675
                } else {
                    local2 = random-between 2651 2655
                }
            }
        }
        local2 += (kid - 31) * 46
    } else if (kid >= CUSTOM-KID-0 && kid <= 264 - 1 + 10) {
        case emote {
            1 {
                local2 = random-between 4061 4063
            }
            2 {
                local2 = random-between 4064 4066
            }
            3 {
                local2 = random-between 4067 4070
            }
            4 {
                local2 = random-between 4071 4074
            }
            5 {
                local2 = 4075
            }
            6 {
                local2 = 4076
            }
            7 {
                local2 = random-between 4082 4084
            }
            8 {
                local2 = random-between 4085 4087
            }
            9 {
                local2 = random-between 4091 4093
            }
            10 {
                local2 = random-between 4102 4103
            }
            11 {
                local2 = random-between 4094 4096
            }
            else {
                if (random 1) {
                    local2 = random-between 4097 4101
                } else {
                    local2 = random-between 4077 4081
                }
            }
        }
        if (gKidData[kid][KD-GENDER] == GIRL) {
            local2 += 46
        }
    } else {
        if (kid == SIDNEY-WEBBER) {
            kid = ASHLEY-WEBBER
        }
        case emote {
            1 {
                local2 = random-between 2 4
            }
            2 {
                local2 = random-between 5 7
            }
            3 {
                local2 = random-between 8 21
            }
            4 {
                local2 = random-between 22 29
            }
            5 {
                local2 = 30
            }
            6 {
                local2 = 31
            }
            7 {
                local2 = random-between 32 34
            }
            8 {
                local2 = random-between 35 37
            }
            9 {
                local2 = random-between 38 40
            }
            10 {
                local2 = random-between 41 42
            }
            11 {
                local2 = random-between 26 29
            }
            else {
                if (random 1 || gTeamInfo[1 - gBattingTeamInfoIndex][TI-PRIMARY-COLOR] >= 9) {
                    if (random 1) {
                        local2 = random-between 8 9
                    } else if (random 1) {
                        local2 = random-between 41 42
                    } else {
                        stop-script 0
                    }
                } else {
                    local2 = 43 + gTeamInfo[1 - gBattingTeamInfoIndex][TI-PRIMARY-COLOR] - 1
                }
            }
        }
        if (kid > KIMMY-ECKMAN) {
            local2 += (kid - 1) * 49
            if (kid > SIDNEY-WEBBER) {
                local2 -= 49
            }
        }
    }
    if gNetplayActive {
        start-script NetSendSound local2 0 1
    }
    start-script PlaySound local2 0 1
}

local-script PlayCrowdSoundForDialogue@2053 dialogue {
    var sound

    if gUserOnOffense {
        case dialogue {
            [DIALOGUE-HIT-LINE-DRIVE-CENTER-FIELD DIALOGUE-HIT-LINE-DRIVE-LEFT-FIELD DIALOGUE-HIT-LINE-DRIVE-RIGHT-FIELD DIALOGUE-HIT-LINE-DRIVE-GENERAL DIALOGUE-LINE-DRIVE-GAP DIALOGUE-FIELDER-RUNNING-TO-CATCH-FLY DIALOGUE-HIT-BUNT DIALOGUE-GROUNDER-GENERAL DIALOGUE-POP-FLY] {
                sound = 1518
            }
            [DIALOGUE-BALL-OUT-OF-PLAY DIALOGUE-RUNNER-SAFE DIALOGUE-RUNNER-SAFE-AT-FIRST DIALOGUE-RUNNER-SAFE-AT-SECOND DIALOGUE-RUNNER-SAFE-AT-THIRD DIALOGUE-STOLEN-BASE DIALOGUE-CATCH-HIGH-HIT-ERROR] {
                sound = 1517
            }
            [DIALOGUE-HIT-HOME-RUN DIALOGUE-HIT-GRAND-SLAM DIALOGUE-GROUND-RULE-DOUBLE DIALOGUE-STOLEN-HOME DIALOGUE-SCORED-RUN] {
                sound = 1516
            }
            [DIALOGUE-HIT-WITH-POWERUP DIALOGUE-HIT-TO-OUTFIELD] {
                sound = 1519
            }
            [DIALOGUE-INFIELD-FLY DIALOGUE-RUNNER-OUT DIALOGUE-RUNNER-TAGGED-OUT DIALOGUE-THIRD-OUT] {
                sound = 1520
            }
            [DIALOGUE-CATCH-HIGH-HIT-ERROR DIALOGUE-FIELDER-COLLISION] {
                sound = 1521
            }
            else {
            }
        }
    } else {
        case dialogue {
            [DIALOGUE-CATCH-LOW-HIT DIALOGUE-CATCH-GENERAL] {
                sound = 1518
            }
            [DIALOGUE-CATCH-HIGH-HIT DIALOGUE-RUNNER-TAGGED-OUT DIALOGUE-RUNNER-OUT] {
                sound = 1517
            }
            [DIALOGUE-DOUBLE-PLAY DIALOGUE-THIRD-OUT DIALOGUE-TRIPLE-PLAY] {
                sound = 1516
            }
            [DIALOGUE-HIT-WITH-POWERUP DIALOGUE-HIT-TO-OUTFIELD] {
                sound = 1519
            }
            [DIALOGUE-CATCH-HIGH-HIT-ERROR DIALOGUE-HIT-HOME-RUN DIALOGUE-HIT-GRAND-SLAM DIALOGUE-RUNNER-TAGGED-SAFE DIALOGUE-RUNNER-SAFE DIALOGUE-RUNNER-SAFE-AT-FIRST DIALOGUE-RUNNER-SAFE-AT-SECOND DIALOGUE-RUNNER-SAFE-AT-THIRD DIALOGUE-SCORED-RUN DIALOGUE-CATCH-GENERAL-ERROR DIALOGUE-BALL-OUT-OF-PLAY DIALOGUE-STOLEN-HOME DIALOGUE-GROUND-RULE-DOUBLE] {
                sound = 1520
            }
            DIALOGUE-TRIP {
                sound = 1521
            }
            else {
            }
        }
    }
    if sound {
        if (gField == BIG-CITY-STADIUM) {
            sound += 7
        } else if (gField == SUPER-COLOSSAL-DOME) {
            sound += 14
        }
        if (sound-running sound) {
            stop-script 0
        }
        if gNetplayActive {
            start-script NetSendSound sound 0 1
        }
        start-script PlaySound sound 0 1
    }
}

local-script EnqueueComment@2054 dialogue arg1 {
    if (in gField [PARKS-DEPARTMENT BIG-CITY-STADIUM SUPER-COLOSSAL-DOME] && not gNoBackgroundSound) {
        start-script PlayCrowdSoundForDialogue dialogue
    }
    if gUserOnOffense {
        if (dialogue >= DIALOGUE-FIELDER-RUNNING-TO-CATCH-FLY && dialogue <= DIALOGUE-CATCH-GENERAL-ERROR) {
            stop-script 0
        }
    } else if (dialogue >= DIALOGUE-HIT-DOUBLE && dialogue <= DIALOGUE-RUNNER-SLIDE-INTO-HOME) {
        stop-script 0
    } else if (in dialogue [DIALOGUE-STOLEN-BASE DIALOGUE-STOLEN-HOME]) {
        dialogue = DIALOGUE-BAD-PLAY
    }
    gCommentaryIsIdle = 0
    if (gCommentaryQueuePointer > 2) {
        gCommentaryQueuePointer = 0
    } else {
        inc gCommentaryQueuePointer
    }
    if (rCommentQueue[gCommentaryQueuePointer][0] > 0) {
        array-assign-list rCommentQueue 0 2 0 1 [0]
    }
    rCommentQueue[gCommentaryQueuePointer][0] = dialogue
    rCommentQueue[gCommentaryQueuePointer][1] = arg1
    if gUserOnOffense {
        if (random 1) {
            if (in dialogue [DIALOGUE-RUNNER-OUT DIALOGUE-RUNNER-TAGGED-OUT] && rCaughtFly == false) {
                start-script EnqueueComment DIALOGUE-OUT-GOOCH arg1
            }
        }
    }
}

local-script CommentaryLoop@2055 {
    var dialogue local1

    gCommentaryQueuePointer = 0
    gCommentaryPlayingPointer = 0
    do {
        break-until (gCurrentSpeechScript == 0)
        if (gCommentaryPlayingPointer > 2) {
            gCommentaryPlayingPointer = 0
        } else {
            inc gCommentaryPlayingPointer
        }
        if (gPlayEndedReason != 0) {
            if (rCommentQueue[gCommentaryPlayingPointer][0] == 114) {
                rCommentQueue[gCommentaryPlayingPointer][0] = 0
            }
        }
        if (rCommentQueue[gCommentaryPlayingPointer][0] > 0) {
            gCommentaryIsIdle = 0
            if (gCommentaryPlayingPointer != gCommentaryQueuePointer) {
                if (rCommentQueue[gCommentaryPlayingPointer][0] == rCommentQueue[gCommentaryQueuePointer][0]) {
                    do {
                        rCommentQueue[gCommentaryPlayingPointer][0] = 0
                        if (gCommentaryPlayingPointer > 2) {
                            gCommentaryPlayingPointer = 0
                        } else {
                            inc gCommentaryPlayingPointer
                        }
                    } until (gCommentaryPlayingPointer == gCommentaryQueuePointer)
                }
            }
            dialogue = rCommentQueue[gCommentaryPlayingPointer][0]
            local1 = rCommentQueue[gCommentaryPlayingPointer][1]
            if gNetplayActive {
                temp = local1 << 8
                gNetStateBuffer[3][4] = temp + dialogue
            }
            start-script CastGameplay dialogue local1
            rCommentQueue[gCommentaryPlayingPointer][0] = 0
            rCommentQueue[gCommentaryPlayingPointer][1] = 0
        } else {
            gCommentaryIsIdle = 1
        }
        break-here
    }
}

local-script CalcActorScale@2056 arg0 {
    var local1 local2 local3

    local1 = line-length.3d gWorld[arg0][X] 0 gWorld[arg0][Z] gCameraTransform[0][overhed] gCameraTransform[1][overhed] gCameraTransform[2][overhed]
    if (local1 > 1315) {
        local1 -= 1315
        local3 = 153 * local1 / 3985
        local2 = 255 - local3
    } else {
        local2 = 255
    }
    if (local2 < 102) {
        local2 = 102
    }
    if (local2 > 255) {
        local2 = 255
    }
    return local2
}

local-script CalcBallActorScale@2057 shadow {
    var local1 local2 local3

    debug-string 0 "no trace"
    if shadow {
        local1 = line-length.3d gWorld[BALL-SHADOW][X] 0 gWorld[BALL-SHADOW][Z] gCameraTransform[0][overhed] gCameraTransform[1][overhed] gCameraTransform[2][overhed]
    } else {
        local1 = line-length.3d gWorld[BALL][X] gWorld[BALL][Y] gWorld[BALL][Z] gCameraTransform[0][overhed] gCameraTransform[1][overhed] gCameraTransform[2][overhed]
    }
    if (local1 > 300) {
        local1 -= 300
        local3 = 175 * local1 / 5000
        local2 = 255 - local3
    } else {
        local2 = 255
    }
    if (local2 < 80) {
        local2 = 80
    }
    if (local2 > 255) {
        local2 = 255
    }
    debug-string 0 "trace on"
    return local2
}

local-script smth_kid_data_3_with_fatigue@2058 kid {
    var local1 local2 result

    local1 = 5 + (100 - gKidData[kid][KD-COORDINATION]) * 10 / 100
    local2 = gKidData[kid][KD-fatigue] / 20
    result = local1 + local2
    if (result > 15) {
        result = 15
    }
    return result
}

local-script GetKidRunningSpeed@2059 kid {
    var local1 local2 local3

    local1 = 6 + gKidData[kid][KD-SPEED] / 20
    local2 = gKidData[kid][KD-fatigue] * local1 / 200
    local3 = local1 - local2
    case gField {
        [PLAYGROUND-COMMONS ECKMAN-ACRES STEELE-STADIUM DIRT-YARDS] {
            local3 -= 1
        }
        [SANDY-FLATS] {
            local3 -= 2
        }
        else {
        }
    }
    if (gKidData[kid][KD-SPEED] > 95) {
        inc local3
    }
    if (local3 < 4) {
        local3 = 4
    }
    return local3
}

local-script smth_about_kid_data_maybe_height@2060 kid {
    var local1

    local1 = 105
    case gKidData[kid][KD-HEIGHT] {
        1 {
            local1 = 70
        }
        2 {
            local1 = 87
        }
        3 {
            local1 = 105
        }
        4 {
            local1 = 122
        }
        5 {
            local1 = 140
        }
        else {
        }
    }
    return local1
}

local-script smth_kid_data_27_maybe_errors_chance@2061 kid {
    var local1

    local1 = 51
    if (not gNoErrors) {
        case gKidData[kid][KD-HEIGHT] {
            1 {
                local1 = 17
            }
            2 {
                local1 = 25
            }
            3 {
                local1 = 34
            }
            4 {
                local1 = 42
            }
            5 {
                local1 = 51
            }
            else {
            }
        }
    }
    return local1
}

local-script smth_kid_data_5_maybe_errors_chance_with_fatigue@2062 kid {
    var local1 local2 local3

    local1 = 90 + gKidData[kid][KD-ARM] / 2
    local2 = gKidData[kid][KD-fatigue] / 2
    local3 = local1 - local2
    if gNoErrors {
        if (local3 < 120) {
            local3 = 120
        }
    } else if (local3 < 90) {
        local3 = 90
    }
    return local3
}

local-script smth_about_kid_data_6_and_errors@2063 kid {
    var local1 local2 result

    if gNoErrors {
        return 100
        stop-script 0
    }
    if (gDifficulty == HARD) {
        if (random 1) {
            return 100
        }
    }
    local1 = gKidData[kid][KD-THROWING]
    local2 = gKidData[kid][KD-fatigue] / 10
    result = local1 - local2
    if (result < 1) {
        result = 1
    }
    return result
}

local-script smth_about_kid_data_2_and_errors@2064 kid {
    if gNoErrors {
        return 100
        stop-script 0
    }
    if (gDifficulty == HARD) {
        if (random 1) {
            return 100
        }
    }
    return gKidData[kid][KD-INTELLIGENCE]
}

local-script FielderBallPredictionCheck@2065 kid {
    var result

    if gNoErrors {
        return 1
        stop-script 0
    }
    if gBallVelPhysY {
        result = gKidData[kid][KD-EYE] * 240000 / gBallVelPhysY
    } else {
        result = gKidData[kid][KD-EYE] * 240000
    }
    if (result > 100) {
        result = 100
    }
    return (101 - result)
}

local-script smth_about_kid_data_12_with_fatigue@2066 kid {
    var local1 local2 local3

    local1 = gKidData[kid][KD-AGGRESSION]
    local2 = gKidData[kid][KD-fatigue] / 2
    local3 = local1 - local2
    if (local3 < 1) {
        local3 = 1
    }
    return local3
}

local-script smth_about_kid_data_10_with_randomness@2067 kid {
    var local1 local2 result

    if gNoErrors {
        result = 100
    } else {
        local1 = gKidData[kid][KD-ATTENTION]
        local2 = gKidData[kid][KD-fatigue] / 3
        result = local1 - local2
        if (gDifficulty == HARD) {
            if (random 3) {
                result = max 100 (25 + result)
            }
        }
        if (result < 1) {
            result = 1
        }
    }
    return result
}

local-script DoesInfieldFlyRuleApply@2068 {
    var i j

    if gRunners {
        if (not gBallHasBounced) {
            if (not gSimFirstBounceFoul) {
                if (g_maybe_last_fielder_to_touch_ball == 0) {
                    if (gNumOuts < 2) {
                        if (line-length.2d gWorld[HOME-PLATE-BACK-CORNER][X] gWorld[HOME-PLATE-BACK-CORNER][Z] gSimFirstBounceX gSimFirstBounceZ < 1200) {
                            for i = 0 to 3 + {
                                if (gRunners[i][R-CUR-BASE] == FIRST) {
                                    for j = 0 to 3 + {
                                        if (j != i) {
                                            if (gRunners[j][R-CUR-BASE] == SECOND) {
                                                return 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    return 0
}

local-script IsBallOffScreen@2069 {
    var local0

    if (g_maybe_last_fielder_to_touch_ball == 0 && not gBallHasBounced) {
        local0 = 0
    } else if (gScreen[BALL-SHADOW][X] > 640 || gScreen[BALL-SHADOW][X] < 0) {
        local0 = 1
    } else if (gScreen[BALL-SHADOW][Y] > 480 || gScreen[BALL-SHADOW][Y] < 0) {
        local0 = 1
    } else {
        local0 = 0
    }
    return local0
}

local-script AngleDifference@2070 arg0 arg1 {
    var result

    result = abs (arg0 - arg1)
    if (result > 180) {
        result = abs (360 - result)
    }
    return result
}

local-script AddStatsForThisAtBat@2071 {
    var local0 pitcher

    if (gPlayEndedReason == PE-BASE-ON-BALLS) {
        stop-script 0
    }
    if gBallIsFoul {
        stop-script 0
    }
    pitcher = rFieldingOrder[POS-PITCHER]
    if (gRunners && gBallWasHit) {
        for local0 = 0 to 3 + {
            if (gRunners[local0][R-KID] == gBatterKid) {
                case gRunners[local0][R-CUR-BASE] {
                    FIRST {
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-AT-BATS 1
                                start-script AddStat gBatterKid STAT-AT-BATS 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-AT-BATS 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-HITS 1
                                start-script AddStat gBatterKid STAT-HITS 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-HITS 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat pitcher STAT-HITS-ALLOWED 1
                                start-script AddStat pitcher STAT-HITS-ALLOWED 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat pitcher STAT-HITS-ALLOWED 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat pitcher STAT-BATTERS-FACED 1
                                start-script AddStat pitcher STAT-BATTERS-FACED 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat pitcher STAT-BATTERS-FACED 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-SINGLES 1
                                start-script AddStat gBatterKid STAT-SINGLES 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-SINGLES 1
                        }
                    }
                    SECOND {
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-AT-BATS 1
                                start-script AddStat gBatterKid STAT-AT-BATS 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-AT-BATS 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-HITS 1
                                start-script AddStat gBatterKid STAT-HITS 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-HITS 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat pitcher STAT-HITS-ALLOWED 1
                                start-script AddStat pitcher STAT-HITS-ALLOWED 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat pitcher STAT-HITS-ALLOWED 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat pitcher STAT-BATTERS-FACED 1
                                start-script AddStat pitcher STAT-BATTERS-FACED 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat pitcher STAT-BATTERS-FACED 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-DOUBLES 1
                                start-script AddStat gBatterKid STAT-DOUBLES 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-DOUBLES 1
                        }
                    }
                    THIRD {
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-AT-BATS 1
                                start-script AddStat gBatterKid STAT-AT-BATS 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-AT-BATS 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-HITS 1
                                start-script AddStat gBatterKid STAT-HITS 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-HITS 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat pitcher STAT-HITS-ALLOWED 1
                                start-script AddStat pitcher STAT-HITS-ALLOWED 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat pitcher STAT-HITS-ALLOWED 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat pitcher STAT-BATTERS-FACED 1
                                start-script AddStat pitcher STAT-BATTERS-FACED 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat pitcher STAT-BATTERS-FACED 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gBatterKid STAT-TRIPLES 1
                                start-script AddStat gBatterKid STAT-TRIPLES 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gBatterKid STAT-TRIPLES 1
                        }
                    }
                    else {
                        debug 0
                    }
                }
                stop-script 0
            }
        }
        if (not room34) {
            if gNetplayActive {
                if (g_net_smth_master == g_net_smth_me) {
                    start-script AddNetStat gBatterKid STAT-AT-BATS 1
                    start-script AddStat gBatterKid STAT-AT-BATS 1
                }
            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                start-script AddStat gBatterKid STAT-AT-BATS 1
            }
            if gNetplayActive {
                if (g_net_smth_master == g_net_smth_me) {
                    start-script AddNetStat pitcher STAT-BATTERS-FACED 1
                    start-script AddStat pitcher STAT-BATTERS-FACED 1
                }
            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                start-script AddStat pitcher STAT-BATTERS-FACED 1
            }
        }
    } else {
    }
}

local-script RunHUDScoreboard@2072 {
    var local0 _ local2 local3 local4 local5

    debug-string 0 "no trace"
    draw-object.image 78 1
    if (gTeamInfo[gVisitorInfoIndex][TI-TEAM-NOUN] >= 122) {
        palette.init room36
        palette.from-image 644 0
        palette.end
        sprite.init 32
        sprite.new
        sprite.image image644
        sprite.state (gTeamInfo[gVisitorInfoIndex][TI-TEAM-NOUN] - 122)
        sprite.at 300 240
        sprite.palette room36
        sprite.animation-type 0
        sprite.update-type 0
        sprite.order 255
    } else {
        palette.init room36
        palette.from-image 1507 0
        palette.end
        start-script scr279 room36 gTeamInfo[gVisitorInfoIndex][TI-PRIMARY-COLOR] gTeamInfo[gVisitorInfoIndex][TI-SECONDARY-COLOR]
        sprite.init 32
        sprite.new
        sprite.image image1507
        sprite.state (gTeamInfo[gVisitorInfoIndex][TI-TEAM-NOUN] - 101)
        sprite.at 300 240
        sprite.palette room36
        sprite.animation-type 0
        sprite.update-type 0
        sprite.order 255
    }
    if (gTeamInfo[gHomeInfoIndex][TI-TEAM-NOUN] >= 122) {
        palette.init room35
        palette.from-image 644 0
        palette.end
        sprite.init 31
        sprite.new
        sprite.image image644
        sprite.state (gTeamInfo[gHomeInfoIndex][TI-TEAM-NOUN] - 122)
        sprite.at 300 274
        sprite.palette room35
        sprite.animation-type 0
        sprite.update-type 0
        sprite.order 255
    } else {
        palette.init room35
        palette.from-image 1507 0
        palette.end
        start-script scr279 room35 gTeamInfo[gHomeInfoIndex][TI-PRIMARY-COLOR] gTeamInfo[gHomeInfoIndex][TI-SECONDARY-COLOR]
        sprite.init 31
        sprite.new
        sprite.image image1507
        sprite.state (gTeamInfo[gHomeInfoIndex][TI-TEAM-NOUN] - 101)
        sprite.at 300 274
        sprite.palette room35
        sprite.animation-type 0
        sprite.update-type 0
        sprite.order 255
    }
    if (gBattingTeamInfoIndex == gHomeInfoIndex) {
        draw-object.image 82 2
    } else {
        draw-object.image 82 1
    }
    local4 = gTeamInfo[gHomeInfoIndex][TI-RUNS]
    local2 = local4 / 10
    local2 %= 10
    local3 = local4 % 10
    if (local2 == 0) {
        local2 = 10
    }
    if (local3 == 0) {
        local3 = 10
    }
    if (local4 < 10) {
        local2 = 11
    }
    draw-object.image 84 local2
    draw-object.image 86 local3
    if (gBattingTeamInfoIndex == gHomeInfoIndex) {
        local5 = local4
    }
    local4 = gTeamInfo[gVisitorInfoIndex][TI-RUNS]
    local2 = local4 / 10
    local2 %= 10
    local3 = local4 % 10
    if (local2 == 0) {
        local2 = 10
    }
    if (local3 == 0) {
        local3 = 10
    }
    if (local4 < 10) {
        local2 = 11
    }
    draw-object.image 83 local2
    draw-object.image 85 local3
    if (gBattingTeamInfoIndex == gVisitorInfoIndex) {
        local5 = local4
    }
    if (gNumOuts < 4 && gNumOuts > -1) {
        draw-object.image 79 (gNumOuts + 1)
    }
    lock-image image502
    break-here
    image.init image502
    image.capture 1 0 400 160 480
    image.flags 8
    image.end
    sprite.init 2
    sprite.new
    sprite.image image502
    sprite.at 0 400
    sprite.order 254
    do {
        break-here.multi 5
        if (local0 != gNumOuts) {
            if (gNumOuts < 4 && gNumOuts > -1) {
                draw-object.image 79 (gNumOuts + 1)
            } else {
                draw-object.image 79 4
            }
            break-here
            image.init image502
            image.capture 1 0 400 160 480
            image.flags 8
            image.end
            sprite.init 2
            sprite.new
            sprite.image image502
            sprite.at 0 400
            sprite.order 254
        }
        if (gTeamInfo[gBattingTeamInfoIndex][TI-RUNS] != local5) {
            if (gBattingTeamInfoIndex == gHomeInfoIndex) {
                local4 = gTeamInfo[gHomeInfoIndex][TI-RUNS]
                local2 = local4 / 10
                local2 %= 10
                local3 = local4 % 10
                if (local2 == 0) {
                    local2 = 10
                }
                if (local3 == 0) {
                    local3 = 10
                }
                if (local4 < 10) {
                    local2 = 11
                }
                draw-object.image 84 local2
                draw-object.image 86 local3
            } else {
                local4 = gTeamInfo[gVisitorInfoIndex][TI-RUNS]
                local2 = local4 / 10
                local2 %= 10
                local3 = local4 % 10
                if (local2 == 0) {
                    local2 = 10
                }
                if (local3 == 0) {
                    local3 = 10
                }
                if (local4 < 10) {
                    local2 = 11
                }
                draw-object.image 83 local2
                draw-object.image 85 local3
            }
            break-here
            image.init image502
            image.capture 1 0 400 160 480
            image.flags 8
            image.end
            sprite.init 2
            sprite.new
            sprite.image image502
            sprite.at 0 400
            sprite.order 254
        }
    }
    debug-string 0 "trace on"
}

local-script smth_wait_for_play_ended@2073 {
    var local0 local1 local2 local3

    debug-string 0 "no trace"
    if (line-length.2d gSimFirstBounceX gSimFirstBounceZ 0 300 > 1600) {
        preload-image image1551
        preload-image image1550
        preload-image image1552
    }
    if gNetplayActive {
        if (g_net_smth_master == g_net_smth_slave) {
            break-until (not (in gPlayEndedReason [0 12]) || gBallIsFoul)
        } else {
            break-until (not (in gPlayEndedReason [0 12]) || g_maybe_smth_play_is_alive == 0)
        }
    } else {
        break-until (not (in gPlayEndedReason [0 12]) || g_maybe_smth_play_is_alive == 0)
    }
    case gPlayEndedReason {
        PE-GROUND-RULE-DOUBLE {
            local0 = 497
            start-script EnqueueComment DIALOGUE-GROUND-RULE-DOUBLE gBatterKid
        }
        PE-OUT-OF-PLAY {
            local0 = 499
            if gNumRunners {
                start-script EnqueueComment DIALOGUE-BALL-OUT-OF-PLAY
            }
        }
        PE-INFIELD-FLY {
            local0 = 500
            start-script EnqueueComment DIALOGUE-INFIELD-FLY
        }
        PE-BASE-ON-BALLS {
            local0 = 501
        }
        PE-HOME-RUN {
            start-script HomeRunStuff
            start-script SetBaseCorners
            stop-script 0
        }
        else {
            if gBallIsFoul {
                local0 = 498
            } else {
                stop-script 0
            }
        }
    }
    sprite.init 1
    sprite.new
    sprite.image local0
    sprite.at 0 480
    sprite.order 300
    break-here
    for local1 = 1 to 10 + {
        local2 = 480 - local1 * 8
        sprite.init 1
        sprite.at 0 local2
        break-here
    }
    sleep-for.seconds 3
    for local1 = 1 to 18 + {
        local3 = 0 - local1 * 8
        sprite.init 1
        sprite.at local3 400
        break-here
    }
    sprite.init 1
    sprite.new
    debug-string 0 "trace on"
}

local-script maybe_record_replay_then_wait_to_cast_end_of_play@2074 {
    var ground_cap_width ground_cap_height cap_fallback_left cap_width cap_fallback_top cap_height cap_left cap_right cap_top cap_bottom focus_y_offset focus_x focus_y local13 local14 local15 local16 focus_entity local18 local19 local20 local21 local22 local23

    if gNetplayActive {
        stop-script 0
    }
    debug-string 0 "no trace"
    if (gEnableHumongousVision == 0 || not (in gField [PARKS-DEPARTMENT BIG-CITY-STADIUM SUPER-COLOSSAL-DOME])) {
        local23 = 0
        break-until (not g_maybe_smth_play_is_alive || in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-INFIELD-FLY PE-OUT-OF-PLAY])
        jump L03d0
    } else {
        local23 = 1
    }
    cap_fallback_left = 1
    ground_cap_width = 50
    cap_fallback_top = 1
    ground_cap_height = 33
    case gField {
        PARKS-DEPARTMENT {
            local13 = 264
            local14 = 0
            local15 = 377
            local16 = 66
            local22 = 454
        }
        BIG-CITY-STADIUM {
            local13 = 273
            local14 = 0
            local15 = 358
            local16 = 53
            local22 = 454 + 1
        }
        else {
            local13 = 270
            local14 = 0
            local15 = 368
            local16 = 54
            local22 = 454 + 2
        }
    }
    local18 = 1
    if (not g_smth_play_may_continue) {
        for local21 = 0 to 3 + {
            if (gRunners[local21][R-DEST-BASE] == FIRST) {
                focus_entity = gRunners[local21][R-ENTITY]
            }
        }
        focus_y_offset = 5 - ground_cap_height
    }
    if gEnableReplays {
        dim-array-2d.i16 local19 24 1
        localize local19
        array-assign-range local19 0 24 0 0 457 481
        object.class 73 [32]
    } else {
        object.class 73 [160]
    }
    set-polygon-local local18 local13 local14 local15 local14 local15 local16 local13 local16
    break-here
    do {
        if gFielderWithBall {
            focus_entity = gFielderWithBall
            focus_y_offset = 5 - ground_cap_height
        } else if g_smth_play_may_continue {
            focus_entity = BALL
            focus_y_offset = -5
        }
        focus_x = gScreen[focus_entity][X]
        focus_y = gScreen[focus_entity][Y] + focus_y_offset
        if (gWorld[focus_entity][Y] > 120) {
            cap_width = ground_cap_width + (gWorld[focus_entity][Y] - 120) / 12
            cap_height = ground_cap_height + (gWorld[focus_entity][Y] - 120) / 18
            if (cap_width > 180) {
                cap_width = 180
            }
            if (cap_height > 120) {
                cap_height = 120
            }
        } else {
            cap_width = ground_cap_width
            cap_height = ground_cap_height
        }
        if (focus_x < 0) {
            cap_left = cap_fallback_left
            cap_right = cap_width
        } else if (focus_x > 637 - cap_width / 2) {
            cap_left = 638 - cap_width
            cap_right = 638
        } else {
            cap_left = focus_x - cap_width / 2
            cap_right = focus_x + (cap_width - cap_width / 2)
        }
        if (focus_y < 0) {
            cap_top = cap_fallback_top
            cap_bottom = cap_height
        } else if (focus_y > 479 - cap_height / 2) {
            cap_top = 478 - cap_height
            cap_bottom = 478
        } else {
            cap_top = focus_y - cap_height / 2
            cap_bottom = focus_y + (cap_height - cap_height / 2)
        }
        break-here
        lock-image image453
        image.init image453
        image.capture 0 cap_left cap_top cap_right cap_bottom
        image.end
        break-here
        image.init image453
        image.polygon local18
        image.draw
        image.end
        image.init local22
        image.draw
        image.at local13 local14
        image.end
        unlock-image image453
        if gBallIsFoul {
            if gEnableReplays {
                for local20 = 0 to 24 + {
                    unlock-image local19[local20][0]
                }
            }
            break-until (not (script-running WatchForFoulBall))
            stop-script 0
        }
        if gEnableReplays {
            if local21 {
                if (rCurrentPlay != FIELDER-PITCHER && rCurrentPlay != MOUND) {
                    lock-image local19[local20][0]
                    image.init local19[local20][0]
                    image.capture 0 local13 local14 local15 local16
                    image.end
                    local19[local20][1] = 1
                    inc local20
                    if (local20 > 24) {
                        local20 = 0
                    }
                    local21 = 0
                }
            } else {
                local21 = 1
            }
        }
    } until (not g_maybe_smth_play_is_alive || in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-INFIELD-FLY PE-OUT-OF-PLAY])
    L03d0:
    if (gNumOuts > room13 + 1) {
        rDefenseSentiment = 2
    } else if (rDefenseSentiment == -1) {
        start-script EnqueueComment DIALOGUE-BAD-PLAY 0
    } else if (rDefenseSentiment == 1) {
        start-script EnqueueComment DIALOGUE-GOOD-PLAY 0
    }
    if (gNumOuts > 2) {
        if (rDefenseSentiment != 2) {
            rDefenseSentiment = 1
        }
        if (gCurrentHalfInning == gGameLength - 1) {
            if (gTeamInfo[gHomeInfoIndex][TI-RUNS] > gTeamInfo[gVisitorInfoIndex][TI-RUNS]) {
            } else {
                start-script EnqueueComment DIALOGUE-THIRD-OUT 0
            }
        } else if (gCurrentHalfInning < gGameLength - 1) {
            start-script EnqueueComment DIALOGUE-THIRD-OUT 0
        }
    }
    if (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE PE-OUT-OF-PLAY]) {
        rDefenseSentiment = -1
    }
    if (gPlayEndedReason == PE-INFIELD-FLY) {
        rDefenseSentiment = 1
    }
    override L0914
    if (local23 == 0 || not (in gField [PARKS-DEPARTMENT BIG-CITY-STADIUM SUPER-COLOSSAL-DOME])) {
        if (gPlayEndedReason == PE-INFIELD-FLY) {
            start-script.rec PlaySound 2010 1
            break-until (not (sound-running sound2010))
            break-until gBallHasBounced
        }
        break-here.multi 20
        break-until (not (script-running smth_wait_for_play_ended))
        break-until (not (script-running HomeRunStuff))
        override-off
        stop-script 0
    }
    if (rDefenseSentiment && gEnableReplays) {
        if (gUserOnOffense && rDefenseSentiment == -1 || (not gUserOnOffense && rDefenseSentiment > 0)) {
            if (not (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE])) {
                start-script EnqueueComment DIALOGUE-INSTANT-REPLAY
            }
        }
        do {
            if (gPlayEndedReason == PE-HOME-RUN) {
                for local21 = 1 to 4 + {
                    if room21 {
                        image.init local22
                        image.draw
                        image.at local13 local14
                        image.state 15
                        image.end
                    } else {
                        image.init local22
                        image.draw
                        image.at local13 local14
                        image.state 13
                        image.end
                    }
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                    if room21 {
                        image.init local22
                        image.draw
                        image.at local13 local14
                        image.state 16
                        image.end
                    } else {
                        image.init local22
                        image.draw
                        image.at local13 local14
                        image.state 14
                        image.end
                    }
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                }
            } else if (gPlayEndedReason == PE-GROUND-RULE-DOUBLE) {
                for local21 = 1 to 4 + {
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 9
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 10
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                }
            } else if (gPlayEndedReason == PE-OUT-OF-PLAY) {
                for local21 = 1 to 4 + {
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 1
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 2
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                }
            } else if (gPlayEndedReason == PE-INFIELD-FLY) {
                start-script.rec PlaySound 2010 1
                do {
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 3
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 4
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 4
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 4
                } until (not (sound-running sound2010))
                break-here.multi 20
            } else if (rDefenseSentiment == 2) {
                for local21 = 1 to 3 + {
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 11
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 12
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                }
            } else if (gPlayEndedReason == PE-BASE-ON-BALLS) {
                for local21 = 1 to 3 + {
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 7
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 8
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                }
            } else {
                for local21 = 1 to 3 + {
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 17
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.state 18
                    image.end
                    image.init local22
                    image.draw
                    image.at local13 local14
                    image.end
                    break-here.multi 5
                }
            }
            if (gPlayEndedReason != PE-INFIELD-FLY) {
                local21 = 0
                do {
                    if local19[local20][1] {
                        break-here.multi 4
                        image.init local19[local20][0]
                        image.draw
                        image.at local13 local14
                        image.end
                    } else {
                        break-here
                    }
                    inc local20
                    if (local20 > 24) {
                        local20 = 0
                    }
                    inc local21
                    if (local21 == 25) {
                        break-here.multi 10
                    }
                    if (local21 == 49) {
                        break-here.multi 10
                    }
                    if (local21 == 73) {
                        break-here.multi 10
                    }
                } until (local21 > 48 && gCurrentSpeechScript == 0)
            }
            break-here
        } until (g_maybe_play_is_ready_to_end || not gNumRunners)
    } else {
        sleep-for.seconds 2
    }
    L0914:
    if g_maybe_skipped_cutscene {
        stop-sound sound2010
        stop-script smth_wait_for_play_ended
        sprite.init 1
        sprite.new
        sprite.image 0
        stop-sound 10000
    } else {
        override-off
        break-until (not (script-running smth_wait_for_play_ended))
        break-until (not (script-running HomeRunStuff))
    }
    if (local23 == 0 || gEnableReplays == 0) {
        stop-script 0
    }
    for local20 = 0 to 24 + {
        unlock-image local19[local20][0]
    }
    debug-string 0 "trace on"
}

local-script DrawNameUnderRunner@2075 _ {
    var local1 local2 local3

    if (gOffenseControlledBy != CB-USER) {
        stop-script 0
    }
    if (gRunnerCursorIndex != NONE) {
        local1 = gRunners[gRunnerCursorIndex][R-ENTITY]
    } else {
        local1 = 999
    }
    if (local1 != room23) {
        room23 = local1
        if (local1 != 999) {
            local3 = gRunners[gRunnerCursorIndex][R-KID]
            local2 = local1 - 30
            start-script.rec DrawNameUnderKid local3 local2 112 room23
        }
    }
}

local-script maybe_handle_basepath_click@2076 arg0 x y arg3 {
    var _ local5 local6 i local8

    if (not arg0) {
        x = gMouseX
        y = gMouseY
    }
    if arg3 {
    } else if (gRunnerCursorIndex != NONE && gRunnerCursorDestinationBase != NONE) {
        if (gRunners[gRunnerCursorIndex][R-CUR-BASE] != NONE) {
            local8 = gRunners[gRunnerCursorIndex][R-KID] == gBatterKid
            temp = gRunnersExtra[gRunnerCursorIndex][RE-SPRINT]
            if temp {
                if (temp == 1) {
                    temp = 6
                } else if (temp < 30) {
                    temp += 3
                }
            } else {
                temp = 1
            }
            gRunnersExtra[gRunnerCursorIndex][RE-SPRINT] = temp
            if (gRunners[gRunnerCursorIndex][R-FORCED] == false && gPlayEndedReason == 0) {
                if gRunners[gRunnerCursorIndex][R-DIRECTION] {
                    if (gRunnerCursorDestinationBase > gRunners[gRunnerCursorIndex][R-CUR-BASE]) {
                        gRunners[gRunnerCursorIndex][R-DIRECTION] = FORWARD
                    } else {
                        gRunners[gRunnerCursorIndex][R-DIRECTION] = BACKWARD
                    }
                }
                gRunners[gRunnerCursorIndex][R-DEST-BASE] = gRunnerCursorDestinationBase
                case gRunnerCursorDestinationBase {
                    FIRST {
                        gRunners[gRunnerCursorIndex][R-DEST-X] = gWorld[FIRST-BASE-CENTER][X]
                        gRunners[gRunnerCursorIndex][R-DEST-Z] = gWorld[FIRST-BASE-CENTER][Z]
                    }
                    SECOND {
                        gRunners[gRunnerCursorIndex][R-DEST-X] = gWorld[SECOND-BASE-CENTER][X]
                        gRunners[gRunnerCursorIndex][R-DEST-Z] = gWorld[SECOND-BASE-CENTER][Z]
                    }
                    THIRD {
                        gRunners[gRunnerCursorIndex][R-DEST-X] = gWorld[THIRD-BASE-CENTER][X]
                        gRunners[gRunnerCursorIndex][R-DEST-Z] = gWorld[THIRD-BASE-CENTER][Z]
                    }
                    [0 R-HOME] {
                        gRunners[gRunnerCursorIndex][R-DEST-X] = gWorld[HOME-PLATE-CENTER][X]
                        gRunners[gRunnerCursorIndex][R-DEST-Z] = gWorld[HOME-PLATE-CENTER][Z]
                    }
                    else {
                    }
                }
                gRunnersExtra[gRunnerCursorIndex][0] = true
            }
        }
        jump L032b
    }
    if (arg3 == 0) {
        start-script TransformUserInputVector x y 2
        local5 = gWorld[LAST-CLICK-RUNNING][X]
        local6 = gWorld[LAST-CLICK-RUNNING][Z]
        if (line-length.2d local5 local6 gWorld[FIRST-BASE-CENTER][X] gWorld[FIRST-BASE-CENTER][Z] < 24) {
            arg3 = 1
        }
        if (line-length.2d local5 local6 gWorld[SECOND-BASE-CENTER][X] gWorld[SECOND-BASE-CENTER][Z] < 24) {
            arg3 = 2
        }
        if (line-length.2d local5 local6 gWorld[THIRD-BASE-CENTER][X] gWorld[THIRD-BASE-CENTER][Z] < 24) {
            arg3 = 3
        }
        if (line-length.2d local5 local6 gWorld[HOME-PLATE-CENTER][X] gWorld[HOME-PLATE-CENTER][Z] < 18) {
            arg3 = 4
        }
    }
    for i = 0 to 3 + {
        if (gRunners[i][R-CUR-BASE] == arg3 - 1 && gRunners[i][R-DIRECTION] == FORWARD) {
            temp = gRunnersExtra[i][RE-SPRINT]
            if temp {
                if (temp == 1) {
                    temp = 6
                } else if (temp < 30) {
                    temp += 3
                }
            } else {
                temp = 1
            }
            gRunnersExtra[i][RE-SPRINT] = temp
        } else if (gRunners[i][R-CUR-BASE] == arg3 && gRunners[i][R-DIRECTION] == BACKWARD) {
            temp = gRunnersExtra[i][RE-SPRINT]
            if temp {
                if (temp == 1) {
                    temp = 6
                } else if (temp < 30) {
                    temp += 3
                }
            } else {
                temp = 1
            }
            gRunnersExtra[i][RE-SPRINT] = temp
        }
    }
    L032b:
    if (not arg0) {
        start-script DrawNameUnderRunner gRunnerCursorIndex
    }
}

local-script BallFreezer_unused@2077 {
    var local0 local1 local2 local3 local4 local5

    local0 = gBallVelPhysX
    local1 = gBallVelPhysY
    local2 = gBallVelPhysZ
    local3 = gBallPosPhysX
    local4 = gBallPosPhysY
    local5 = gBallPosPhysZ
    print-debug.start
    print-debug.string "freezer running"
    do {
        break-here
        gBallVelPhysX = local0
        gBallVelPhysY = local1
        gBallVelPhysZ = local2
        gBallPosPhysX = local3
        gBallPosPhysY = local4
        gBallPosPhysZ = local5
    }
}

local-script maybe_handle_esc_skip_play@2078 {
    var x z _ i local4

    if (not (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-BASE-ON-BALLS 4 PE-OUT-OF-PLAY 6 7] || (r_smth_fly_caught_runners_must_return && gBallIsFoul))) {
        print-debug.start
        print-debug.string "Cut it out!"
        stop-script 0
    }
    if gNetplayActive {
        stop-script 0
    }
    room30 = 1
    if (not gRunnerSpecialDestinations) {
        stop-script 0
    }
    if (gRunnerSpecialDestinations[0] == NONE && gRunnerSpecialDestinations[1] == NONE && gRunnerSpecialDestinations[2] == NONE && gRunnerSpecialDestinations[3] == NONE) {
        stop-script 0
    }
    stop-script smth_watch_runners_near_same_base
    for i = 0 to 3 + {
        if (gRunners[i][R-CUR-BASE] != NONE) {
            if (gRunners[i][R-CUR-BASE] == gRunnerSpecialDestinations[i] && gRunners[i][R-DEST-BASE] == NONE) {
            } else {
                gRunners[i][R-CUR-BASE] = gRunnerSpecialDestinations[i]
                gRunners[i][R-DEST-BASE] = gRunnerSpecialDestinations[i]
                case gRunners[i][R-CUR-BASE] {
                    FIRST {
                        x = gWorld[FIRST-BASE-CENTER][X]
                        z = gWorld[FIRST-BASE-CENTER][Z]
                    }
                    SECOND {
                        x = gWorld[SECOND-BASE-CENTER][X]
                        z = gWorld[SECOND-BASE-CENTER][Z]
                    }
                    THIRD {
                        x = gWorld[THIRD-BASE-CENTER][X]
                        z = gWorld[THIRD-BASE-CENTER][Z]
                    }
                    [0 R-HOME] {
                        x = gWorld[HOME-PLATE-CENTER][X]
                        z = gWorld[HOME-PLATE-CENTER][Z]
                    }
                    else {
                        print-debug.start
                        print-debug.printf "r%d: Aak!" i
                    }
                }
                local4 = gRunners[i][R-ENTITY]
                gWorld[local4][X] = x
                gWorld[local4][Z] = z
            }
        }
    }
}

local-script SetCursorDestinationBase@2079 arg0 direction runner_is_batter {
    var local3

    local3 = 0
    if (not (runner_is_batter && gRunners[gRunnerCursorIndex][R-FORCED]) && not r_smth_fly_caught_runners_must_return && not gRunners[gRunnerCursorIndex][11] && not (gRunners[gRunnerCursorIndex][R-STATE] == R-maybe-returning-after-infield-fly || gPlayEndedReason == PE-INFIELD-FLY && gRunners[gRunnerCursorIndex][R-DEST-BASE] == NONE)) {
        case arg0 {
            74 {
                if (direction == FORWARD) {
                    local3 = 85
                    gRunnerCursorDestinationBase = FIRST
                } else {
                    local3 = 91
                    gRunnerCursorDestinationBase = 0
                }
            }
            75 {
                if (direction == FORWARD) {
                    local3 = 82
                    gRunnerCursorDestinationBase = SECOND
                } else {
                    local3 = 88
                    gRunnerCursorDestinationBase = FIRST
                }
            }
            76 {
                if (direction == FORWARD) {
                    local3 = 91
                    gRunnerCursorDestinationBase = THIRD
                } else {
                    local3 = 85
                    gRunnerCursorDestinationBase = SECOND
                }
            }
            77 {
                if (direction == FORWARD) {
                    local3 = 88
                    gRunnerCursorDestinationBase = R-HOME
                } else {
                    local3 = 82
                    gRunnerCursorDestinationBase = THIRD
                }
            }
            else {
            }
        }
    } else if (gRunners[gRunnerCursorIndex][R-DIRECTION] == FORWARD) {
        if (direction == FORWARD) {
            case arg0 {
                74 {
                    local3 = 85
                    gRunnerCursorDestinationBase = FIRST
                }
                75 {
                    local3 = 82
                    gRunnerCursorDestinationBase = SECOND
                }
                76 {
                    local3 = 91
                    gRunnerCursorDestinationBase = THIRD
                }
                77 {
                    local3 = 88
                    gRunnerCursorDestinationBase = R-HOME
                }
                else {
                }
            }
        }
    } else if (gRunners[gRunnerCursorIndex][R-DIRECTION] == BACKWARD) {
        if (direction == BACKWARD) {
            case arg0 {
                74 {
                    local3 = 91
                    gRunnerCursorDestinationBase = 0
                }
                75 {
                    local3 = 88
                    gRunnerCursorDestinationBase = FIRST
                }
                76 {
                    local3 = 85
                    gRunnerCursorDestinationBase = SECOND
                }
                77 {
                    local3 = 82
                    gRunnerCursorDestinationBase = THIRD
                }
                else {
                }
            }
        }
    }
    return local3
}

local-script HandleInputOffense@2080 type key arg2 x y {
    var _ local6 local7

    if global596 {
        chain-script DefaultHandleInput type key arg2 x y
    }
    if (type == INPUT-TYPE-MOUSE) {
        if gNetplayActive {
            local6 = find-sprite gMouseX gMouseY 0 0 []
            if local6 {
                local7 = sprite-get-variable local6 1
                if (local7 == 344) {
                    start-script maybe_net_send_thumbs_up_or_down local6
                    stop-script 0
                }
            }
            start-script.rec maybe_net_send_message 20 1 NET-RUNNER-CLICK gMouseX gMouseY
        } else {
            start-script maybe_handle_basepath_click
        }
    } else {
        case key {
            27 {
                if (not gNetplayActive) {
                    if (in gPlayEndedReason [PE-BASE-ON-BALLS PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 4 PE-OUT-OF-PLAY 6 7] || (r_smth_fly_caught_runners_must_return && gBallIsFoul)) {
                        start-script maybe_handle_esc_skip_play
                        stop-script 0
                    }
                }
            }
            ['1' '2' '3' '4'] {
                if gNetplayActive {
                    start-script maybe_net_send_thumbs_up_or_down global579[key - 49 + 1]
                    stop-script 0
                }
            }
            else {
            }
        }
        chain-script DefaultHandleInput type key arg2 x y
    }
}

local-script MouseCursorLoopOffense@2081 {
    var x y local2 local3 local4 local5 local6 direction local8 _ _ _ runneridx _ end_base start_base local16 runner_is_batter local18 local19 local20 local21 local22

    dim-array.i32 local20 3
    localize local20
    do {
        if (gCursorVisible > 0) {
            x = gMouseX
            y = gMouseY
            local2 = 0
            local2 = find-object x y
            if local2 {
                if (object-get-class local2 [4]) {
                    local2 = 0
                }
            }
            if local2 {
                local4 = local3
                if (in local2 [74 75 76 77]) {
                    direction = 0
                    array-assign local20 [0 0 0 0] 0
                    local21 = 0
                    end_base = local2 - 74 + 1
                    start_base = end_base - 1
                    runneridx = gBases[start_base][BASE-RUNNERIDX]
                    if (runneridx == NONE) {
                        gRunnerCursorIndex = NONE
                        local8 = 999
                    } else if (gRunners[runneridx][R-DIRECTION] == BACKWARD) {
                        if (gRunners[runneridx][R-DEST-BASE] == start_base) {
                            gRunnerCursorIndex = runneridx
                            local8 = end_base
                        } else {
                            gRunnerCursorIndex = NONE
                            local8 = 999
                        }
                    } else if (gRunners[runneridx][R-DIRECTION] == FORWARD || end_base != 1) {
                        gRunnerCursorIndex = runneridx
                        local8 = end_base
                    } else {
                        gRunnerCursorIndex = NONE
                        local8 = 999
                    }
                    if (gRunnerCursorIndex != NONE && local8 != 999) {
                        case local8 {
                            1 {
                                local8 = 33
                            }
                            2 {
                                local8 = 2
                            }
                            3 {
                                local8 = 34
                            }
                            [4 0] {
                                local8 = 32
                            }
                            else {
                            }
                        }
                        if (gPlayEndedReason == 0) {
                            local20[local2 - 74] = 1
                            local21 = local2 - 74 + 1
                        }
                        local5 = line-length.2d x y gScreen[local8][X] gScreen[local8][Y]
                        temp2 = gRunners[gRunnerCursorIndex][R-ENTITY] - 30
                        local6 = line-length.2d (actor-get-x temp2) (actor-get-y temp2 - actor-get-elevation temp2) gScreen[local8][X] gScreen[local8][Y]
                        if (local5 < local6) {
                            direction = FORWARD
                        } else {
                            direction = BACKWARD
                        }
                    } else {
                        local3 = 1
                    }
                    if direction {
                        if (direction == BACKWARD && gRunners[gRunnerCursorIndex][R-DEST-BASE] == NONE) {
                            direction = FORWARD
                        }
                        runner_is_batter = gRunners[gRunnerCursorIndex][R-KID] == gBatterKid
                        if (gPlayEndedReason == 0 && not gObviousFoul) {
                            local3 = call-script SetCursorDestinationBase local2 direction runner_is_batter
                        }
                    }
                } else {
                    sprite.init 3
                    sprite.new
                    sprite.image 0
                    gRunnerCursorIndex = NONE
                    gRunnerCursorDestinationBase = NONE
                    local3 = 1
                    local22 = object-get-class local2 []
                    case 1 {
                        (band local22 256 > 0) {
                            local3 = 7
                        }
                        (band local22 512 > 0) {
                            local3 = 85
                        }
                        (band local22 1024 > 0) {
                            local3 = 13
                        }
                        (band local22 2048 > 0) {
                            local3 = 88
                        }
                        (band local22 4096 > 0) {
                            local3 = 19
                        }
                        (band local22 8192 > 0) {
                            local3 = 91
                        }
                        (band local22 16384 > 0) {
                            local3 = 25
                        }
                        (band local22 32768 > 0) {
                            local3 = 82
                        }
                        else {
                            if (local2 <= 60) {
                                local3 = 4
                            } else if (valid-verb local2 1) {
                                local3 = 4
                            } else {
                                local3 = 1
                            }
                        }
                    }
                }
                L0367:
                if (gRunnerCursorIndex != NONE && gRunnerCursorDestinationBase != NONE) {
                    local16 = local2 - 74
                    if (r_runners_zeta[local16] == 999) {
                        temp2 = call-script smth_baserunning_check2 gRunnerCursorIndex 0 runner_is_batter
                    }
                    if (r_runners_zeta[local16] == 0) {
                        local20[local16] = 0
                        local21 = 0
                        local3 = 1
                    }
                }
                if (not local21) {
                    sprite.init 3
                    sprite.new
                    local3 = 1
                }
                if (local3 && local4 != local3) {
                    if local21 {
                        sprite.init 3
                        sprite.new
                        sprite.image image521
                        sprite.animation-type 0
                        sprite.update-type 0
                        sprite.order -1
                        sprite.state (local21 - 1)
                        sprite.shadow global424
                        case local21 {
                            1 {
                                sprite.init 3
                                sprite.at 264 272
                            }
                            2 {
                                sprite.init 3
                                sprite.at 264 184
                            }
                            3 {
                                sprite.init 3
                                sprite.at 112 184
                            }
                            4 {
                                sprite.init 3
                                sprite.at 112 272
                            }
                            else {
                            }
                        }
                    }
                    if (g_maybe_operating_system == 2) {
                        cursor-color-image (local3 + 2)
                        gCursorImage = local3 + 2
                    } else if (local3 <= 76 || in local3 [82 85 91 88 79 95]) {
                        cursor-image (local3 + 1)
                        gCursorImage = local3 + 1
                    } else if (gBlackAndWhiteCursors || local3 == 1) {
                        cursor-image (local3 + 1)
                        gCursorImage = local3 + 1
                    } else {
                        cursor-color-image local3
                        gCursorImage = local3
                    }
                }
            } else {
                sprite.init 3
                sprite.new
                gRunnerCursorIndex = NONE
                gRunnerCursorDestinationBase = NONE
                local3 = 1
                local2 = find-sprite x y 0 0 []
                if local2 {
                    if (sprite-get-variable local2 1 == 344) {
                        local3 = 4
                        jump L0367
                    }
                }
                if (local3 && local4 != local3) {
                    if (g_maybe_operating_system == 2) {
                        cursor-color-image (local3 + 2)
                        gCursorImage = local3 + 2
                    } else if (local3 <= 76 || in local3 [82 85 91 88 79 95]) {
                        cursor-image (local3 + 1)
                        gCursorImage = local3 + 1
                    } else if (gBlackAndWhiteCursors || local3 == 1) {
                        cursor-image (local3 + 1)
                        gCursorImage = local3 + 1
                    } else {
                        cursor-color-image local3
                        gCursorImage = local3
                    }
                }
                local4 = local3
            }
        } else {
        }
        if gNetplayActive {
            if (local18 != gRunnerCursorIndex || local19 != gRunnerCursorDestinationBase) {
                local18 = gRunnerCursorIndex
                local19 = gRunnerCursorDestinationBase
                start-script.rec maybe_net_send_message 10 1 NET-SET-RUNNER-VARS gRunnerCursorIndex gRunnerCursorDestinationBase
                start-script DrawNameUnderRunner gRunnerCursorIndex
            }
        }
        break-here
    }
}

local-script RunRunnerToSideline@2082 runneridx facing ghost {
    var _ actor angle vel_x vel_y new_facing runner local10 dist path segment speed done local16

    if gNetplayActive {
    }
    if (ghost[R-CUR-BASE] == NONE) {
    } else {
        dim-array-2d.i32 path 3 1
        localize path
        localize ghost
        runner = ghost[R-ENTITY]
        actor = gRunners[runneridx][R-ENTITY] - 30
        if (actor-get-variable actor 2 == 1) {
            break-until (not (actor-get-variable actor 2 == 1))
        }
        if ghost[11] {
            break-until (actor-get-variable actor 25)
            do-animation actor 12
            actor.init actor
            actor.variable 0 0
            actor.init actor
            actor.variable 25 0
            break-until (actor-get-variable actor 25)
            ghost[11] = 0
        }
        actor.init actor
        actor.condition [1]
        actor.init actor
        actor.condition [2]
        actor.init actor
        actor.condition [3]
        actor.init actor
        actor.condition [4]
        actor.init actor
        actor.condition [5]
        actor.init actor
        actor.condition [6]
        actor.init actor
        actor.condition [7]
        actor.init actor
        actor.condition [8]
        do-animation actor 10
        actor.init actor
        actor.variable 1 1
        temp = gCurrentHalfInning % 2
        if temp {
            case ghost[R-ORDER] {
                0 {
                    array-assign-row path 0 [-188 386]
                }
                1 {
                    array-assign-row path 0 [-264 471]
                }
                2 {
                    array-assign-row path 0 [-347 519]
                }
                3 {
                    array-assign-row path 0 [-430 635]
                }
                else {
                }
            }
            if (gWorld[runner][Z] >= gWorld[MOUND-CENTER][Z]) {
                if (gWorld[runner][X] >= gWorld[MOUND-CENTER][X]) {
                    array-assign-row path 1 [0 225]
                    array-assign-row path 2 [676 842]
                    segment = 2
                } else {
                    array-assign-row path 1 [-646 842]
                    array-assign-row path 2 [0 0]
                    segment = 1
                }
            } else if (gWorld[runner][X] >= gWorld[MOUND-CENTER][X]) {
                array-assign-row path 1 [0 255]
                array-assign-row path 2 [0 0]
                segment = 1
            } else {
                array-assign-row path 1 [0 0]
                array-assign-row path 2 [0 0]
                segment = 0
            }
        } else {
            case ghost[R-ORDER] {
                0 {
                    array-assign-row path 0 [188 386]
                }
                1 {
                    array-assign-row path 0 [264 471]
                }
                2 {
                    array-assign-row path 0 [347 519]
                }
                3 {
                    array-assign-row path 0 [430 635]
                }
                else {
                }
            }
            if (gWorld[runner][Z] >= gWorld[MOUND-CENTER][Z]) {
                if (gWorld[runner][X] >= gWorld[MOUND-CENTER][X]) {
                    array-assign-row path 1 [646 842]
                    array-assign-row path 2 [0 0]
                    segment = 1
                } else {
                    array-assign-row path 1 [0 225]
                    array-assign-row path 2 [-676 842]
                    segment = 2
                }
            } else if (gWorld[runner][X] >= gWorld[MOUND-CENTER][X]) {
                array-assign-row path 1 [0 0]
                array-assign-row path 2 [0 0]
                segment = 0
            } else {
                array-assign-row path 1 [0 255]
                array-assign-row path 2 [0 0]
                segment = 1
            }
        }
        speed = ghost[R-SPEED]
        done = 0
        do {
            ghost[R-SPEED] = speed
            do {
                if (not gNumRunners) {
                    if (segment > 0) {
                        segment = 0
                    }
                }
                ghost[R-DEST-X] = path[segment][X]
                ghost[R-DEST-Z] = path[segment][Y]
                dist = line-length.2d gWorld[runner][X] gWorld[runner][Z] ghost[R-DEST-X] ghost[R-DEST-Z]
                if (dist < ghost[R-SPEED]) {
                    ghost[R-SPEED] = dist
                }
                vel_x = ghost[R-SPEED] * cos angle / 100000
                vel_y = ghost[R-SPEED] * sin angle / 100000
                angle = angle-from-line gWorld[runner][X] gWorld[runner][Z] ghost[R-DEST-X] ghost[R-DEST-Z]
                new_facing = call-script ConvertAngleToFacing angle
                new_facing = call-script TurnFacingStep new_facing facing
                start-script.rec SetActorFacing actor new_facing facing
                facing = new_facing
                gWorld[runner][X] = gWorld[runner][X] + vel_x
                gWorld[runner][Z] = gWorld[runner][Z] + vel_y
                break-here
                local10 = 5000 - gWorld[runner][Z]
                actor.init actor
                actor.elevation local10
                actor.scale (call-script CalcActorScale runner)
                put-actor actor gScreen[runner][X] (gScreen[runner][Y] + local10) gCurrentRoom
                dist = line-length.2d gWorld[runner][X] gWorld[runner][Z] ghost[R-DEST-X] ghost[R-DEST-Z]
            } until (dist <= 12)
            if segment {
                dec segment
            } else {
                done = 1
            }
        } until done
        undim ghost
        undim path
        array-assign-row gWorld runner [0 0 0]
        if (gCurrentHalfInning % 2) {
            angle = 45
        } else {
            angle = 135
        }
        do {
            new_facing = call-script ConvertAngleToFacing angle
            local16 = new_facing
            new_facing = call-script TurnFacingStep new_facing facing
            start-script.rec SetActorFacing actor new_facing facing
            facing = new_facing
            break-here
        } until (facing == local16)
        do-animation actor 6
        actor.init actor
        actor.variable 1 0
    }
}

local-script SendRunnerOffField@2083 runneridx facing {
    var i _ _ _ _ _ _ _ _ _ _ _ _ ghost

    if gNetplayActive {
    }
    if (gRunners[runneridx][R-CUR-BASE] == NONE) {
    } else {
        dim-array.i32 ghost 11
        array-assign-slice ghost gRunners 0 0 0 11 runneridx runneridx 0 11
        if (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-BASE-ON-BALLS 4 PE-OUT-OF-PLAY 6 7]) {
            ghost[R-SPEED] = 6
        } else {
            ghost[R-SPEED] = gRunners[runneridx][R-SPEED]
        }
        array-assign-range gRunners runneridx runneridx 0 20 0 0
        gRunners[runneridx][R-ENTITY] = ghost[R-ENTITY]
        gRunners[runneridx][R-CUR-BASE] = NONE
        gRunners[runneridx][R-DEST-BASE] = NONE
        gRunners[runneridx][R-ORDER] = 999
        if (not gRunners[0][R-DIRECTION] && not gRunners[1][R-DIRECTION] && not gRunners[2][R-DIRECTION] && not gRunners[3][R-DIRECTION]) {
            g_maybe_play_is_ready_to_end = 1
            r_smth_fly_caught_runners_must_return = 0
        }
        gNumRunners = 0
        for i = 0 to 3 + {
            if (gRunners[i][R-CUR-BASE] != NONE) {
                inc gNumRunners
            }
        }
        for i = 0 to 4 + {
            if (gBases[i][BASE-RUNNERIDX] == runneridx) {
                gBases[i][BASE-RUNNERIDX] = NONE
            }
        }
        start-script.rec RunRunnerToSideline runneridx facing ghost
    }
    start-script Nop
}

local-script SetForcedRunners@2084 {
    var i j

    array-assign-range gRunners 0 3 8 8 0 0
    if (gBallWasHit || gPlayEndedReason == PE-BASE-ON-BALLS) {
        for i = 0 to 3 + {
            for j = 0 to 3 + {
                if (gRunners[j][R-CUR-BASE] == i) {
                    if (gRunners[j][R-ORDER] >= i) {
                        gRunners[j][R-FORCED] = true
                        print-debug.start
                        print-debug.printf "Setting runneridx %d (order %d, i = %d) to be FORCED" j gRunners[j][R-ORDER] i
                    }
                }
            }
        }
    }
}

local-script lsc2085@2085 {
    var _ local1 local2 local3

    local2 = gRunners[local1][R-ORDER]
    for local3 = 0 to 3 + {
        if (gRunners[local3][R-ORDER] >= local2) {
            gRunners[local3][R-FORCED] = false
        }
    }
}

local-script UpdateBasesWithRunners@2086 {
    var local0 local1

    array-assign-range gBases 0 4 0 0 999 999
    for local0 = 0 to 3 + {
        local1 = gRunners[local0][R-CUR-BASE]
        if (local1 != 999) {
            gBases[local1][BASE-RUNNERIDX] = local0
        }
    }
}

local-script RetireTheSide@2087 arg0 {
    var _ i

    if (gNumOuts < 3) {
        print-debug.start
        print-debug.string "You can't retire the side with less than 3 outs, lamer."
        stop-script 0
    }
    if (gRunners[arg0][R-FORCED] || rCaughtFly) {
        stop-script RunnerLoop
        for i = 0 to 3 + {
            if (not (gRunners[i][R-CUR-BASE] == NONE)) {
                start-script.rec SendRunnerOffField i 0
            }
        }
        if (not gRunners[0][R-DIRECTION] && not gRunners[1][R-DIRECTION] && not gRunners[2][R-DIRECTION] && not gRunners[3][R-DIRECTION]) {
            g_maybe_play_is_ready_to_end = 1
            r_smth_fly_caught_runners_must_return = 0
        }
    } else {
        for i = 0 to 3 + {
            if (gRunners[i][R-CUR-BASE] != NONE) {
                gRunners[i][R-STATE] = R-LEAVE-FIELD
            }
        }
    }
}

local-script smth_baserunner_skill_check@2088 runneridx arg1 arg2 arg3 {
    var local4 local5 local6 local7 local8

    local4 = 0
    local6 = gKidData[gRunners[runneridx][R-KID]][KD-EYE]
    local6 += call-script smth_about_kid_data_2_and_errors gRunners[runneridx][R-KID]
    local6 /= 2
    local8 = random 100
    if (local6 > local8) {
    } else {
        local7 = local6 - local8
        local7 = 15 * local7 / 100
        temp2 = arg2
        arg2 *= 100 + local7
        arg2 /= 100
    }
    local7 = arg1 - arg2
    if (local7 < 10) {
        local7 = abs local7
        if (local7 < 10) {
            local5 = call-script smth_about_kid_data_12_with_fatigue gRunners[runneridx][R-KID]
            local5 *= 10
            local5 /= 100
        } else {
            local5 = 1000
        }
        if (local7 < local5) {
            local4 = 1
            case arg3 {
                0 {
                }
                1 {
                }
                2 {
                }
                else {
                }
            }
        }
    }
    return local4
}

local-script smth_baserunner_random_skill_check_2@2089 runneridx {
    var local1 local2 local3 local4

    local1 = 1
    if (gRunners[runneridx][17] == 0) {
        local3 = 100 - call-script smth_about_kid_data_2_and_errors gRunners[runneridx][R-KID]
        local3 *= 50
        local4 = random 10000
    } else if (gRunners[runneridx][17] == 2) {
        local4 = 0
        local3 = 1
    } else {
        local4 = 1
        local3 = 0
    }
    if (local4 >= local3) {
        if (gRunners[runneridx][17] == 0) {
            gRunners[runneridx][17] = 1
        }
        for local2 = 0 to 3 + {
            if (local2 != runneridx) {
                if (gRunners[local2][R-CUR-BASE] == gRunners[runneridx][R-CUR-BASE] + 1) {
                    if (not (gRunners[local2][R-DIRECTION] == FORWARD)) {
                        if (not (gRunners[local2][R-CUR-BASE] == R-HOME)) {
                            local1 = 0
                        }
                    }
                }
            }
        }
    } else if (gRunners[runneridx][17] == 0) {
        gRunners[runneridx][17] = 2
    }
    return local1
}

local-script smth_baserunning_check1@2090 runneridx direction runner_is_batter {
    var result smth_x1 smth_z1 local6 fielder local8 local9 local10 local11 smth_x2 smth_z2 f local15 local16 local17 local18 local19

    result = 0
    if gObviousFoul {
        return 0
    }
    if (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 4 PE-OUT-OF-PLAY 6 7] || in gRunners[runneridx][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch]) {
        if gRunnerSpecialDestinations {
            if (gRunnerSpecialDestinations[runneridx] != gRunners[runneridx][R-CUR-BASE]) {
                result = 1
            }
        } else {
            result = 1
        }
        return result
    }
    if (gRunners[runneridx][R-FORCED] && gRunners[runneridx][R-CUR-BASE] == rRunnerStartingBases[runneridx] && not r_smth_fly_caught_runners_must_return && direction == BACKWARD) {
    } else if gRunners[runneridx][R-FORCED] {
        return 1
    }
    if (gRunnersExtra[runneridx][0] == true) {
        return 1
    }
    if (gTeamInfo[gBattingTeamInfoIndex][TI-CONTROLLED-BY] != CB-COMPUTER && gGameMode != MODE-SPECTATE) {
        return 0
    }
    if (gNumOuts == 2 && not gBallHasBounced && gPlayEndedReason == 0) {
        return 1
    }
    if (not (gPlayEndedReason == PE-BASE-ON-BALLS || gBallIsFoul || (rCaughtFly && gRunners[runneridx][R-STATE] != 3))) {
        case (gRunners[runneridx][R-CUR-BASE] + 1) {
            1 {
                smth_x1 = gWorld[HOME-PLATE-CENTER][X]
                smth_z1 = gWorld[HOME-PLATE-CENTER][Z]
            }
            2 {
                smth_x1 = gWorld[SECOND-BASE-CENTER][X]
                smth_z1 = gWorld[SECOND-BASE-CENTER][Z]
            }
            3 {
                smth_x1 = gWorld[THIRD-BASE-CENTER][X]
                smth_z1 = gWorld[THIRD-BASE-CENTER][Z]
            }
            [0 4] {
                smth_x1 = gWorld[HOME-PLATE-CENTER][X]
                smth_z1 = gWorld[HOME-PLATE-CENTER][Z]
            }
            else {
                print-debug.start
                print-debug.string "Oh my dear, dear lord!!!!"
            }
        }
        local9 = call-script smth_about_baserunner_distance runneridx smth_x1 smth_z1 1
        if (in gFielderWithBall [FIELDER-LF FIELDER-CF FIELDER-RF FIELDER-3B FIELDER-2B FIELDER-1B FIELDER-SS FIELDER-CACTHER FIELDER-PITCHER]) {
            local8 = call-script smth_distance_concerning_fielding gFielderWithBall smth_x1 smth_z1
            result = call-script smth_baserunner_skill_check runneridx local9 local8 1
        } else if (in rCurrentPlay [FIELDER-LF FIELDER-CF FIELDER-RF FIELDER-3B FIELDER-2B FIELDER-1B FIELDER-SS FIELDER-CACTHER FIELDER-PITCHER F-HOME FIRST SECOND THIRD MOUND]) {
            if (in rCurrentPlay [FIELDER-LF FIELDER-CF FIELDER-RF FIELDER-3B FIELDER-2B FIELDER-1B FIELDER-SS FIELDER-CACTHER FIELDER-PITCHER]) {
                fielder = rCurrentPlay
            } else {
                f = abs rBaseClaims[rCurrentPlay]
                if (in f [FIELDER-LF FIELDER-CF FIELDER-RF FIELDER-3B FIELDER-2B FIELDER-1B FIELDER-SS FIELDER-CACTHER FIELDER-PITCHER]) {
                    fielder = f
                } else {
                    f = call-script FindClosestFielder gSimFirstBounceX gSimFirstBounceZ
                    if (in f [FIELDER-LF FIELDER-CF FIELDER-RF FIELDER-3B FIELDER-2B FIELDER-1B FIELDER-SS FIELDER-CACTHER FIELDER-PITCHER]) {
                        fielder = f
                    } else {
                        print-debug.start
                        print-debug.string "Hmm. Ah, well.. darn."
                        fielder = NONE
                    }
                }
            }
            if (in fielder [FIELDER-LF FIELDER-CF FIELDER-RF FIELDER-3B FIELDER-2B FIELDER-1B FIELDER-SS FIELDER-CACTHER FIELDER-PITCHER]) {
                if (gBallVelPhysX || gBallVelPhysZ) {
                    local15 = line-length.2d 0 0 (gBallVelPhysX / 1000) (gBallVelPhysZ / 1000) * gVectorScaleNum
                    local16 = line-length.2d gWorld[BALL][X] gWorld[BALL][Z] gWorld[fielder][X] gWorld[fielder][Z] * gVectorScaleDen
                    if (local15 == 0) {
                        local15 = 1
                    }
                    local6 = local16 / local15
                    local8 = call-script smth_distance_concerning_fielding fielder smth_x1 smth_z1
                    local8 += local6
                } else {
                    local8 = 0
                }
                result = call-script smth_baserunner_skill_check runneridx local9 local8 0
            } else {
            }
        } else {
            if (gWorld[BALL][Y] > 1) {
                smth_x2 = gBallPath[100][0]
                smth_z2 = gBallPath[100][1]
            } else {
                smth_x2 = gWorld[BALL-SHADOW][X]
                smth_z2 = gWorld[BALL-SHADOW][Z]
            }
            fielder = call-script FindClosestFielder smth_x2 smth_z2
            if (fielder >= FIELDER-LF && fielder <= FIELDER-PITCHER) {
                local10 = call-script CalcFielderTimeRunToPoint fielder smth_x2 smth_z2 1 0 0 0
                local11 = call-script smth_distance_concerning_fielding fielder smth_x1 smth_z1 smth_x2 smth_z2
                local8 = local10 + local11
                result = call-script smth_baserunner_skill_check runneridx local9 local8 2
                if (not result) {
                }
            } else {
                print-debug.start
                print-debug.string "Aaagggghh!!"
            }
        }
    }
    if (gBallIsFoul && gRunners[runneridx][R-DEST-BASE] == NONE) {
        result = 0
    }
    if result {
        if (not gRunners[runneridx][R-FORCED]) {
            result = call-script smth_baserunner_random_skill_check_2 runneridx
        }
    }
    if gBases[gRunners[runneridx][R-CUR-BASE]][BASE-TAGGED-WITH-BALL] {
        result = 0
    }
    if result {
        if (gWorld[BALL][Y] > 1) {
            smth_x2 = gBallPath[100][0]
            smth_z2 = gBallPath[100][1]
        } else {
            smth_x2 = gWorld[BALL-SHADOW][X]
            smth_z2 = gWorld[BALL-SHADOW][Z]
        }
        local17 = line-length.2d smth_x2 smth_z2 gWorld[gRunners[runneridx][R-ENTITY]][X] gWorld[gRunners[runneridx][R-ENTITY]][Z]
        if (local17 < 180) {
            result = 0
        }
    }
    if rBallWasHitHigh {
        if (not (gBallHasBounced > 0)) {
            if (runner_is_batter == 0 || (runner_is_batter && gRunners[runneridx][R-FORCED] == false)) {
                if (gNumOuts < 2) {
                    if (gRunners[runneridx][16] == 0) {
                        if ((100 - (gKidData[gRunners[runneridx][R-KID]][KD-EYE] + call-script smth_about_kid_data_2_and_errors gRunners[runneridx][R-KID]) / 2) * random 100 < 1000) {
                            gRunners[runneridx][16] = 1
                        } else {
                            gRunners[runneridx][16] = 2
                            gRunners[runneridx][R-STATE] = 2
                        }
                    } else if (gRunners[runneridx][16] == 2) {
                        gRunners[runneridx][R-STATE] = 2
                    }
                }
            }
        }
    }
    if result {
        if (direction == BACKWARD && not gRunnersExtra[runneridx][0]) {
            result = 0
        }
    }
    if (call-script IsFoulTerritory gSimFirstBounceX gSimFirstBounceZ) {
        if (gRunners[runneridx][19] == 0) {
            if (not (gBallHasBounced > 0) && not rCaughtFly) {
                local18 = gKidData[gRunners[runneridx][R-KID]][KD-EYE]
                local18 += call-script smth_about_kid_data_2_and_errors gRunners[runneridx][R-KID]
                local18 /= 5
                local18 += 60
                local19 = gSimFirstBounceX * local18 / 100
                if (call-script IsFoulTerritory local19 gSimFirstBounceZ) {
                    gRunners[runneridx][19] = 2
                    result = 0
                    gRunners[runneridx][R-STATE] = 2
                } else {
                    gRunners[runneridx][19] = 1
                }
            }
        } else if (gRunners[runneridx][19] == 2) {
            result = 0
        }
    }
    if (gRunners[runneridx][R-STATE] == 2) {
        if (gBallHasBounced > 0 || rCaughtFly) {
            gRunners[runneridx][R-STATE] = 0
        } else {
            result = 0
        }
    }
    return result
}

local-script smth_baserunning_check2@2091 runneridx _ runner_is_batter {
    var result i local5

    result = 1
    if (in gPlayEndedReason [PE-BASE-ON-BALLS PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9] || in gRunners[runneridx][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch]) {
        local5 = gRunners[runneridx][R-CUR-BASE]
        if (in local5 [0 1 2 3]) {
            r_runners_zeta[local5] = result
        }
        return result
    }
    if (runner_is_batter && gBallWasHit == false) {
        result = 0
    } else if (in gPlayEndedReason [4 PE-OUT-OF-PLAY 6 7]) {
        local5 = gRunners[runneridx][R-CUR-BASE]
        if (in local5 [0 1 2 3]) {
            r_runners_zeta[local5] = result
        }
        return result
    }
    if result {
        if (gRunners[runneridx][R-STATE] == R-maybe-returning-after-infield-fly || gPlayEndedReason == PE-INFIELD-FLY && gRunners[runneridx][R-DEST-BASE] == NONE) {
            result = 0
        }
    }
    if result {
        if (r_maybe_pitcher_is_standing_on_the_mound && g_maybe_play_is_ready_to_end) {
            result = 0
            print-debug.start
            print-debug.printf "r%d: play is dead ???? <- PAT AND GREG???." runneridx
        }
    }
    if result {
        if (g_maybe_play_is_ready_to_end && rCurrentPlay == MOUND && rBaseClaims[MOUND] == FIELDER-PITCHER) {
            if gFielderWithBall {
                if (line-length.2d gWorld[MOUND-CENTER][X] gWorld[MOUND-CENTER][Z] gWorld[gFielderWithBall][X] gWorld[gFielderWithBall][Z] < 600) {
                    result = 0
                }
            } else if (line-length.2d gWorld[MOUND-CENTER][X] gWorld[MOUND-CENTER][Z] gWorld[BALL][X] gWorld[BALL][Z] < 600) {
                result = 0
            }
        }
    }
    if result {
        for i = 0 to 3 + {
            if (gRunners[i][R-CUR-BASE] != NONE && gRunners[i][R-DEST-BASE] == NONE) {
                if (gRunners[i][R-ORDER] > gRunners[runneridx][R-ORDER] && gRunners[i][R-CUR-BASE] <= gRunners[runneridx][R-CUR-BASE]) {
                    result = 0
                }
            }
        }
    }
    local5 = gRunners[runneridx][R-CUR-BASE]
    if (in local5 [0 1 2 3]) {
        r_runners_zeta[local5] = result
    }
    return result
}

local-script maybe_runner_run_off_to_the_side@2092 runneridx actor {
    var heading distance runner local5

    if gNetplayActive {
    }
    if gPlayEndedReason {
        stop-script 0
    }
    runner = gRunners[runneridx][R-ENTITY]
    do {
        distance = line-length.2d gWorld[runner][X] gWorld[runner][Z] 24 248
        gRunners[runneridx][R-SPEED] = call-script GetKidRunningSpeed gRunners[runneridx][R-KID]
        if (distance < gRunners[runneridx][R-SPEED]) {
            gRunners[runneridx][R-SPEED] = distance
            distance = 0
        }
        heading = angle-from-line gWorld[runner][X] gWorld[runner][Z] 24 248
        gWorld[runner][X] = gWorld[runner][X] + gRunners[runneridx][R-SPEED] * cos heading / 100000
        gWorld[runner][Z] = gWorld[runner][Z] + gRunners[runneridx][R-SPEED] * sin heading / 100000
        break-here
        local5 = 5000 - gWorld[runner][Z]
        actor.init actor
        actor.elevation local5
        actor.scale (call-script CalcActorScale runner)
        put-actor actor gScreen[runner][X] (local5 + gScreen[runner][Y]) 255
    } until (distance <= 12 || gPlayEndedReason || (g_maybe_play_is_ready_to_end || gBallIsFoul || rCaughtFly))
    actor.init actor
    actor.condition [1]
    actor.init actor
    actor.condition [2]
    actor.init actor
    actor.condition [3]
    actor.init actor
    actor.condition [4]
    actor.init actor
    actor.condition [5]
    actor.init actor
    actor.condition [6]
    actor.init actor
    actor.condition [7]
    actor.init actor
    actor.condition [8]
    actor.init actor
    actor.condition [136]
    actor.init actor
    actor.variable 1 0
    do-animation actor 6
    actor.init actor
    actor.variable 1 0
    while (not (g_maybe_play_is_ready_to_end || gPlayEndedReason || gBallIsFoul || rCaughtFly)) {
        break-here
    }
    while (rBallWasHitHigh && not gPlayEndedReason && not (gBallHasBounced > 0)) {
        break-here
    }
}

local-script smth_runner_actor_stuff@2093 actor runneridx {
    var result

    actor.init actor
    actor.new
    actor.costume (call-script maybe_kid_get_costume_fielding2 gRunners[runneridx][R-KID])
    actor.ignore-boxes
    actor.animation-speed 2
    actor.shadow global423
    start-script smth_actor_palette_team_color actor gBattingTeamInfoIndex
    start-script smth_actor_kid_palette actor gRunners[runneridx][R-KID]
    actor.init actor
    actor.condition [1]
    actor.init actor
    actor.condition [2]
    actor.init actor
    actor.condition [3]
    actor.init actor
    actor.condition [4]
    actor.init actor
    actor.condition [5]
    actor.init actor
    actor.condition [6]
    actor.init actor
    actor.condition [7]
    actor.init actor
    actor.condition [8]
    case gRunners[runneridx][R-CUR-BASE] {
        [0 R-HOME] {
            result = 5
            actor.init actor
            actor.condition [129]
        }
        FIRST {
            result = 7
            actor.init actor
            actor.condition [136]
        }
        SECOND {
            result = 11
            actor.init actor
            actor.condition [134]
        }
        THIRD {
            result = 15
            actor.init actor
            actor.condition [132]
        }
        else {
            print-debug.start
            print-debug.printf "r%d: Aak! Aak!" runneridx
        }
    }
    put-actor actor -1000 -1000 3
    do-animation actor 6
    do-animation actor 12
    actor.init actor
    actor.variable 1 0
    return result
}

local-script smth_runner_forced@2094 runneridx {
    var base

    if (gRunners == 0) {
        stop-script 0
    }
    if (gRunnerSpecialDestinations == 0) {
        stop-script 0
    }
    gRunners[runneridx][R-FORCED] = true
    base = gRunners[runneridx][R-CUR-BASE] * 2
    if (gRunners[runneridx][R-DEST-BASE] != NONE) {
        if (gRunners[runneridx][R-DEST-BASE] > gRunners[runneridx][R-CUR-BASE]) {
            inc base
        }
        if (gRunners[runneridx][R-DEST-BASE] < gRunners[runneridx][R-CUR-BASE]) {
            dec base
        }
    }
    if (base >= gRunnerSpecialDestinations[runneridx] * 2) {
        gRunners[runneridx][R-DIRECTION] = BACKWARD
        if (gRunners[runneridx][R-DEST-BASE] == NONE || gRunners[runneridx][R-DEST-BASE] < gRunners[runneridx][R-CUR-BASE]) {
            base = gRunners[runneridx][R-CUR-BASE] - 1
        } else {
            base = gRunners[runneridx][R-CUR-BASE]
        }
    } else {
        gRunners[runneridx][R-DIRECTION] = FORWARD
        if (gRunners[runneridx][R-DEST-BASE] == NONE || gRunners[runneridx][R-DEST-BASE] > gRunners[runneridx][R-CUR-BASE]) {
            base = gRunners[runneridx][R-CUR-BASE] + 1
        } else {
            base = gRunners[runneridx][R-CUR-BASE]
        }
    }
    g_maybe_play_is_ready_to_end = 0
    if (base != NONE) {
        base = max 0 (min 4 base)
    }
    if (gPlayEndedReason == PE-OUT-OF-PLAY) {
        if (gRunners[runneridx][R-DEST-BASE] == gRunners[runneridx][R-CUR-BASE]) {
            base += 1
            gRunners[runneridx][R-DIRECTION] = FORWARD
        }
    }
    gRunners[runneridx][R-DEST-BASE] = base
    case base {
        FIRST {
            gRunners[runneridx][R-DEST-X] = gWorld[FIRST-BASE-CENTER][X]
            gRunners[runneridx][R-DEST-Z] = gWorld[FIRST-BASE-CENTER][Z]
        }
        SECOND {
            gRunners[runneridx][R-DEST-X] = gWorld[SECOND-BASE-CENTER][X]
            gRunners[runneridx][R-DEST-Z] = gWorld[SECOND-BASE-CENTER][Z]
        }
        THIRD {
            gRunners[runneridx][R-DEST-X] = gWorld[THIRD-BASE-CENTER][X]
            gRunners[runneridx][R-DEST-Z] = gWorld[THIRD-BASE-CENTER][Z]
        }
        [0 R-HOME] {
            gRunners[runneridx][R-DEST-X] = gWorld[HOME-PLATE-CENTER][X]
            gRunners[runneridx][R-DEST-Z] = gWorld[HOME-PLATE-CENTER][Z]
        }
        else {
        }
    }
}

local-script UpdateRunnerSpeed@2095 runneridx {
    var local1 local2 local3 local4 speed

    if gNetplayActive {
    }
    speed = call-script GetKidRunningSpeed gRunners[runneridx][R-KID]
    if (gRunners[runneridx][R-KID] != gBatterKid) {
        if rBallWasHitHigh {
            if room37 {
                if (gNumOuts < 2) {
                    if (not gBallHasBounced) {
                        if (not gFielderWithBall) {
                            if (speed > 3) {
                                speed /= 2
                            }
                        }
                    }
                }
            }
        }
    }
    gRunners[runneridx][R-SPEED] = speed
    for local1 = 0 to 3 + {
        if (local1 != runneridx) {
            if (gRunners[local1][R-DIRECTION] == FORWARD) {
                if (gRunners[local1][R-DEST-BASE] == gRunners[runneridx][R-DEST-BASE]) {
                    if (gRunners[local1][R-ORDER] > gRunners[runneridx][R-ORDER]) {
                        local2 = call-script GetKidRunningSpeed gRunners[local1][R-KID]
                        if (local2 < gRunners[runneridx][R-SPEED]) {
                            gRunners[runneridx][R-SPEED] = local2
                            if (gRunnersExtra[runneridx][RE-SPRINT] > 1) {
                                gRunnersExtra[runneridx][RE-SPRINT] = 1
                            }
                        }
                        local3 = gRunners[local1][R-ENTITY] - 30
                        if (actor-get-variable local3 2 == 1) {
                            gRunners[runneridx][R-SPEED] = 0
                            if (gRunnersExtra[runneridx][RE-SPRINT] > 1) {
                                gRunnersExtra[runneridx][RE-SPRINT] = 1
                            }
                        }
                    }
                }
            }
        }
    }
    local3 = gRunners[runneridx][R-ENTITY] - 30
    if (not (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-BASE-ON-BALLS 4 PE-OUT-OF-PLAY 6 7])) {
        if (gTeamInfo[gBattingTeamInfoIndex][TI-CONTROLLED-BY] == CB-COMPUTER) {
            if (rCurrentPlay == gRunners[runneridx][R-DEST-BASE]) {
                if (not (actor-get-variable local3 2 == 1)) {
                    if (gKidData[gRunners[runneridx][R-KID]][KD-fatigue] < 95) {
                        gRunnersExtra[runneridx][RE-SPRINT] = gRunnersExtra[runneridx][RE-SPRINT] + 1
                        if (gRunnersExtra[runneridx][RE-SPRINT] == 6) {
                            start-script AddFatigue gRunners[runneridx][R-KID] 37
                            gRunnersExtra[runneridx][RE-SPRINT] = 0
                        }
                        local4 = 1
                        gRunners[runneridx][R-SPEED] = gRunners[runneridx][R-SPEED] + local4
                    }
                }
            }
        } else if (not (actor-get-variable local3 2 == 1)) {
            if (gRunnersExtra[runneridx][RE-SPRINT] > 1) {
                if (gKidData[gRunners[runneridx][R-KID]][KD-fatigue] < 95) {
                    if (gRunnersExtra[runneridx][RE-SPRINT] == 6) {
                        start-script AddFatigue gRunners[runneridx][R-KID] 37
                    }
                    if (gRunnersExtra[runneridx][RE-SPRINT] >= 9) {
                        local4 = 2
                    } else {
                        local4 = 1
                    }
                    gRunners[runneridx][R-SPEED] = gRunners[runneridx][R-SPEED] + local4
                }
                gRunnersExtra[runneridx][RE-SPRINT] = gRunnersExtra[runneridx][RE-SPRINT] - 1
            }
        }
    } else {
        gRunners[runneridx][R-SPEED] = 6
        if (gRunnersExtra[runneridx][RE-SPRINT] > 1) {
            gRunnersExtra[runneridx][RE-SPRINT] = 1
        }
    }
}

local-script BaserunnerMaybeTrip@2096 kid actor factor {
    var local3 local4

    debug-string 0 "no trace"
    local4 = 0
    if (not (in kid [KENNY-KAWAGUCHI MR-CLANKY])) {
        if (not (actor-get-variable actor 2 == 1)) {
            local3 = (2 * gKidData[kid][KD-COORDINATION] + (100 - gKidData[kid][KD-fatigue])) / 3
            local3 = 100 - local3
            local3 *= factor
            if (random 10000 < local3) {
                do-animation actor 15
                actor.init actor
                actor.variable 0 0
                actor.init actor
                actor.variable 2 1
                start-script EnqueueComment DIALOGUE-TRIP kid
                local4 = 1
            }
        }
    }
    debug-string 0 "trace on"
    return local4
}

local-script RunnerMaybeSlide@2097 runneridx {
    var entity _ actor result smth_x smth_y local7 local8 angle

    if gNetplayActive {
    }
    result = 0
    entity = gRunners[runneridx][R-ENTITY]
    actor = entity - 30
    if (in gRunners[runneridx][R-KID] [KENNY-KAWAGUCHI MARIA-LUNA MR-CLANKY]) {
        return 0
    }
    if (gRunnersExtra[runneridx][RE-SPRINT] > 1 && not (in gField [CEMENT-GARDENS TIN-CAN-ALLEY])) {
        if (rCurrentPlay == gRunners[runneridx][R-DEST-BASE]) {
            if (not (gRunners[runneridx][R-DEST-BASE] == FIRST && gRunners[runneridx][R-CUR-BASE] < FIRST)) {
                smth_x = gRunners[runneridx][R-VELOCITY-X] * gRunners[runneridx][R-VELOCITY-X] / (30 + 30 - 15 - 15) / 100
                smth_y = gRunners[runneridx][R-VELOCITY-Y] * gRunners[runneridx][R-VELOCITY-Y] / (30 + 30 - 15 - 15) / 100
                local7 = line-length.2d 0 0 smth_x smth_y + 5
                local8 = line-length.2d gWorld[entity][X] gWorld[entity][Z] gRunners[runneridx][R-DEST-X] gRunners[runneridx][R-DEST-Z]
                if (local7 * 90 / 100 > local8) {
                    if (gRunners[runneridx][11] <= 8) {
                        if (not gRunners[runneridx][11]) {
                            result = 1
                            case gRunners[runneridx][R-DEST-BASE] {
                                FIRST {
                                    start-script EnqueueComment DIALOGUE-RUNNER-SLIDE-INTO-FIRST gRunners[runneridx][R-KID]
                                }
                                SECOND {
                                    start-script EnqueueComment DIALOGUE-RUNNER-SLIDE-INTO-SECOND gRunners[runneridx][R-KID]
                                }
                                THIRD {
                                    start-script EnqueueComment DIALOGUE-RUNNER-SLIDE-INTO-THIRD gRunners[runneridx][R-KID]
                                }
                                R-HOME {
                                    start-script EnqueueComment DIALOGUE-RUNNER-SLIDE-INTO-HOME gRunners[runneridx][R-KID]
                                }
                                else {
                                }
                            }
                            gRunnersExtra[runneridx][RE-SPRINT] = 12
                            do-animation actor 11
                            actor.init actor
                            actor.variable 0 0
                        }
                        gRunners[runneridx][11] = gRunners[runneridx][11] + 1
                        angle = angle-from-line gWorld[entity][X] gWorld[entity][Z] gRunners[runneridx][R-DEST-X] gRunners[runneridx][R-DEST-Z]
                        gWorld[entity][X] = gWorld[entity][X] + cos angle / 100000 * 12
                        gWorld[entity][Z] = gWorld[entity][Z] + sin angle / 100000 * 12
                    }
                }
            }
        }
    }
    return result
}

local-script UpdateRunnerPosition@2098 runneridx angle arg2 {
    var entity smth_x smth_z local6 the_angle local8

    if gNetplayActive {
    }
    entity = gRunners[runneridx][R-ENTITY]
    if (not arg2) {
        gRunners[runneridx][14] = gRunners[runneridx][R-SPEED] * 100
        if (gRunners[runneridx][14] > gRunners[runneridx][15]) {
            gRunners[runneridx][14] = gRunners[runneridx][15]
        }
        smth_x = gRunners[runneridx][14] * cos angle / 100000
        smth_z = gRunners[runneridx][14] * sin angle / 100000
        smth_x += gRunners[runneridx][R-VELOCITY-X]
        smth_z += gRunners[runneridx][R-VELOCITY-Y]
        local6 = line-length.2d 0 0 smth_x smth_z
        if (local6 > gRunners[runneridx][R-SPEED] * 100) {
            the_angle = angle
            gRunners[runneridx][R-VELOCITY-X] = gRunners[runneridx][R-SPEED] * cos the_angle / (100000 / 100)
            gRunners[runneridx][R-VELOCITY-Y] = gRunners[runneridx][R-SPEED] * sin the_angle / (100000 / 100)
        } else {
            gRunners[runneridx][R-VELOCITY-X] = smth_x
            gRunners[runneridx][R-VELOCITY-Y] = smth_z
        }
    }
    gWorld[entity][X] = gWorld[entity][X] + gRunners[runneridx][R-VELOCITY-X] / 100
    gWorld[entity][Z] = gWorld[entity][Z] + gRunners[runneridx][R-VELOCITY-Y] / 100
    local8 = iif (gRunners[runneridx][R-VELOCITY-X] > 0) (0 - 30) 30
    if (abs gRunners[runneridx][R-VELOCITY-X] >= local8) {
        gRunners[runneridx][R-VELOCITY-X] += local8
    }
    local8 = iif (gRunners[runneridx][R-VELOCITY-Y] > 0) (0 - 30) 30
    if (abs gRunners[runneridx][R-VELOCITY-Y] >= local8) {
        gRunners[runneridx][R-VELOCITY-Y] += local8
    }
}

local-script RunnerLoop@2099 runneridx {
    var local1 actor runner angle4 angle5 new_facing facing local8 local9 runner_is_batter local11 local12 local13 local14 local15 pickle_counter local17 flags flags2 local20

    if gNetplayActive {
    }
    runner = gRunners[runneridx][R-ENTITY]
    if (not runner) {
        print-debug.start
        print-debug.string "Choke!"
        debug 0
        stop-script 0
    }
    actor = runner - 30
    flags2 = bor flags2 8
    flags2 = band flags2 29
    runner_is_batter = gRunners[runneridx][R-KID] == gBatterKid
    facing = call-script smth_runner_actor_stuff actor runneridx
    angle4 = 999
    angle5 = 999
    do {
        if gRunners[runneridx][11] {
            break-until (actor-get-variable actor 25)
            do-animation actor 12
            actor.init actor
            actor.variable 0 0
            actor.init actor
            actor.variable 2 0
            actor.init actor
            actor.variable 25 0
            break-until (actor-get-variable actor 25)
            gRunners[runneridx][11] = 0
        }
        if (call-script smth_baserunning_check1 runneridx local11 runner_is_batter) {
            if (call-script smth_baserunning_check2 runneridx local11 runner_is_batter) {
                local17 = 1
            }
        }
        if (not local17) {
            inc local15
            flags2 = band flags2 29
            if runner_is_batter {
                if (not rCastedHitKind && local15 > 60 / gMinJiffies) {
                    rCastedHitKind = true
                    case (gRunners[runneridx][R-CUR-BASE] - rRunnerStartingBases[runneridx]) {
                        2 {
                            start-script EnqueueComment DIALOGUE-HIT-DOUBLE gRunners[runneridx][R-KID]
                        }
                        3 {
                            start-script EnqueueComment DIALOGUE-HIT-TRIPLE gRunners[runneridx][R-KID]
                        }
                        else {
                        }
                    }
                }
            }
            gRunners[runneridx][R-VELOCITY-X] = 0
            gRunners[runneridx][R-VELOCITY-Y] = 0
            if (rCaughtFly && runner_is_batter) {
                flags = bor flags 7
                if (gNumOuts + 1 > 2) {
                    g_smth_play_may_continue = 0
                }
                print-debug.start
                print-debug.printf "Runner(r%d) OUT: Caught fly" runneridx
            }
            if gRunners[runneridx][R-FORCED] {
                if (gRunners[runneridx][R-CUR-BASE] == rRunnerStartingBases[runneridx] && not r_smth_fly_caught_runners_must_return) {
                    if gBases[rRunnerStartingBases[runneridx] + 1][BASE-TAGGED-WITH-BALL] {
                        flags = bor flags 7
                        if (gNumOuts + 1 > 2) {
                            g_smth_play_may_continue = 0
                        }
                        print-debug.start
                        print-debug.printf "r%d: forced out at base %d, while lollygagging at base %d" runneridx (rRunnerStartingBases[runneridx] + 1) gRunners[runneridx][R-CUR-BASE]
                    }
                }
            }
            actor.init actor
            actor.condition [1]
            actor.init actor
            actor.condition [2]
            actor.init actor
            actor.condition [3]
            actor.init actor
            actor.condition [4]
            actor.init actor
            actor.condition [5]
            actor.init actor
            actor.condition [6]
            actor.init actor
            actor.condition [7]
            actor.init actor
            actor.condition [8]
            case gRunners[runneridx][R-CUR-BASE] {
                [0 R-HOME] {
                    actor.init actor
                    actor.condition [129]
                }
                FIRST {
                    actor.init actor
                    actor.condition [136]
                }
                SECOND {
                    actor.init actor
                    actor.condition [134]
                }
                THIRD {
                    actor.init actor
                    actor.condition [132]
                }
                else {
                    print-debug.start
                    print-debug.printf "r%d: Aak! Aak!" runneridx
                }
            }
            gRunners[runneridx][R-DIRECTION] = 0
            if (not gRunners[0][R-DIRECTION] && not gRunners[1][R-DIRECTION] && not gRunners[2][R-DIRECTION] && not gRunners[3][R-DIRECTION]) {
                g_maybe_play_is_ready_to_end = 1
                r_smth_fly_caught_runners_must_return = 0
            }
            local9 = 5000 - gWorld[runner][Z]
            actor.init actor
            actor.elevation local9
            actor.scale (call-script CalcActorScale runner)
            put-actor actor gScreen[runner][X] (local9 + gScreen[runner][Y]) 3
            actor.init actor
            actor.variable 1 0
            do-animation actor 6
            actor.init actor
            actor.variable 2 0
            actor.init actor
            actor.variable 1 0
            break-here
        } else {
            local17 = 0
            local15 = 0
            if (band flags2 2) {
                flags2 = band flags2 29
                start-script EnqueueComment DIALOGUE-GO-FOR-ANOTHER gRunners[runneridx][R-KID]
            }
            do-animation actor 10
            actor.init actor
            actor.variable 2 0
            actor.init actor
            actor.variable 1 1
            if (not (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9] || in gRunners[runneridx][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch])) {
                gRunners[runneridx][R-DEST-BASE] = iif (gRunners[runneridx][R-CUR-BASE] == R-HOME) 4 (gRunners[runneridx][R-CUR-BASE] + 1)
                case gRunners[runneridx][R-DEST-BASE] {
                    FIRST {
                        gRunners[runneridx][R-DEST-X] = gWorld[FIRST-BASE-CENTER][X]
                        gRunners[runneridx][R-DEST-Z] = gWorld[FIRST-BASE-CENTER][Z]
                    }
                    SECOND {
                        gRunners[runneridx][R-DEST-X] = gWorld[SECOND-BASE-CENTER][X]
                        gRunners[runneridx][R-DEST-Z] = gWorld[SECOND-BASE-CENTER][Z]
                    }
                    THIRD {
                        gRunners[runneridx][R-DEST-X] = gWorld[THIRD-BASE-CENTER][X]
                        gRunners[runneridx][R-DEST-Z] = gWorld[THIRD-BASE-CENTER][Z]
                    }
                    [0 R-HOME] {
                        gRunners[runneridx][R-DEST-X] = gWorld[HOME-PLATE-CENTER][X]
                        gRunners[runneridx][R-DEST-Z] = gWorld[HOME-PLATE-CENTER][Z]
                    }
                    else {
                    }
                }
                gRunners[runneridx][R-DIRECTION] = FORWARD
                g_maybe_play_is_ready_to_end = 0
            }
            do {
                if gRunners[runneridx][11] {
                    if (line-length.2d 0 0 gRunners[runneridx][R-VELOCITY-X] gRunners[runneridx][R-VELOCITY-Y] < 100) {
                        break-until (actor-get-variable actor 25)
                        do-animation actor 12
                        actor.init actor
                        actor.variable 0 0
                        actor.init actor
                        actor.variable 25 0
                        break-until (actor-get-variable actor 25)
                        gRunners[runneridx][11] = 0
                        do-animation actor 10
                        actor.init actor
                        actor.variable 1 1
                    }
                }
                if (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 4 PE-OUT-OF-PLAY 6 7] || in gRunners[runneridx][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch]) {
                    g_smth_play_may_continue = iif (gRunners[runneridx][R-STATE] == R-maybe-returning-after-catch) 1 0
                    start-script smth_runner_forced runneridx
                }
                start-script UpdateRunnerSpeed runneridx
                angle5 = angle4
                angle4 = angle-from-line gWorld[runner][X] gWorld[runner][Z] gRunners[runneridx][R-DEST-X] gRunners[runneridx][R-DEST-Z]
                if (angle4 != 999 && angle5 != 999) {
                    temp = abs (angle5 - angle4)
                    if (temp > 180) {
                        temp = 360 - temp
                    }
                    if (temp >= 170) {
                        start-script AddFatigue gRunners[runneridx][R-KID] 36
                        if (gRunners[runneridx][R-CUR-BASE] < R-HOME) {
                            if (gBases[gRunners[runneridx][R-CUR-BASE]][BASE-TAGGED-WITH-BALL] == true || gBases[gRunners[runneridx][R-CUR-BASE] + 1][BASE-TAGGED-WITH-BALL] == true || rCurrentPlay == gRunners[runneridx][R-CUR-BASE] || rCurrentPlay == gRunners[runneridx][R-CUR-BASE] + 1) {
                                if (pickle_counter <= 3) {
                                    inc pickle_counter
                                }
                                if (pickle_counter == 2) {
                                    start-script EnqueueComment DIALOGUE-PICKLE gRunners[runneridx][R-KID]
                                }
                            } else if (pickle_counter == 0) {
                                inc pickle_counter
                            }
                        }
                        gRunnersExtra[runneridx][RE-SPRINT] = 1
                        if (call-script BaserunnerMaybeTrip gRunners[runneridx][R-KID] actor 25) {
                            angle4 = angle5
                        }
                    } else if (temp >= 80) {
                        start-script AddFatigue gRunners[runneridx][R-KID] 35
                        gRunnersExtra[runneridx][RE-SPRINT] = 1
                        if (not (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-BASE-ON-BALLS 4 PE-OUT-OF-PLAY 6 7])) {
                            if (call-script BaserunnerMaybeTrip gRunners[runneridx][R-KID] actor 10) {
                                angle4 = angle5
                            }
                        }
                    }
                }
                if (not (gRunners[runneridx][11] || actor-get-variable actor 2 == 1)) {
                    new_facing = call-script ConvertAngleToFacing angle4
                    new_facing = call-script TurnFacingStep new_facing facing
                    start-script.rec SetActorFacing actor new_facing facing
                    facing = new_facing
                }
                if (not (band flags2 4)) {
                    if (call-script RunnerMaybeSlide runneridx) {
                        flags2 = bor flags2 4
                    } else {
                        flags2 = band flags2 27
                    }
                }
                start-script UpdateRunnerPosition runneridx angle4 (actor-get-variable actor 2 == 1)
                local9 = 5000 - gWorld[runner][Z]
                actor.init actor
                actor.elevation local9
                actor.scale (call-script CalcActorScale runner)
                put-actor actor gScreen[runner][X] (local9 + gScreen[runner][Y]) 255
                break-here
                local9 = 5000 - gWorld[runner][Z]
                actor.init actor
                actor.elevation local9
                actor.scale (call-script CalcActorScale runner)
                put-actor actor gScreen[runner][X] (local9 + gScreen[runner][Y]) 255
                local8 = line-length.2d gWorld[runner][X] gWorld[runner][Z] gRunners[runneridx][R-DEST-X] gRunners[runneridx][R-DEST-Z]
                if (local8 < gRunners[runneridx][R-SPEED]) {
                    gRunners[runneridx][R-SPEED] = local8
                }
                if (local8 <= 12) {
                    flags = bor flags 1
                    flags2 = bor flags2 1
                } else {
                    flags = band flags 14
                }
                local20 = gRunners[runneridx][R-DEST-BASE]
                if (rCaughtFly && runner_is_batter) {
                    flags = bor flags 7
                    if (gNumOuts + 1 > 2) {
                        g_smth_play_may_continue = 0
                    }
                    print-debug.start
                    print-debug.printf "r%d out: Caught fly" runneridx
                }
                if (not rCaughtFly || not runner_is_batter) {
                    if (gBases[gRunners[runneridx][R-CUR-BASE]][BASE-TAGGED-WITH-BALL] == 3) {
                        print-debug.start
                        print-debug.printf "r%d: Eegah! I've been tagged whilst off base!" runneridx
                        flags = bor flags 5
                        if (gNumOuts + 1 > 2) {
                            g_smth_play_may_continue = 0
                        }
                        if runner_is_batter {
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat gRunners[runneridx][R-KID] STAT-THROWN-OUT 1
                                    start-script AddStat gRunners[runneridx][R-KID] STAT-THROWN-OUT 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat gRunners[runneridx][R-KID] STAT-THROWN-OUT 1
                            }
                        }
                    }
                    if (not gRunnersExtra[runneridx][0] && not (runner_is_batter && gRunners[runneridx][R-FORCED] == true)) {
                        if (not gRunners[runneridx][17]) {
                            local13 = 100 - call-script smth_about_kid_data_2_and_errors gRunners[runneridx][R-KID]
                            local13 *= 50
                            local14 = random-between 0 10000
                        } else if (gRunners[runneridx][17] == 2) {
                            local14 = 0
                            local13 = 1
                        } else {
                            local14 = 1
                            local13 = 0
                        }
                        if (local14 >= local13) {
                            if (not gRunners[runneridx][17]) {
                                gRunners[runneridx][17] = 1
                            }
                            for local1 = 0 to 3 + {
                                if (local1 != runneridx) {
                                    if (gRunners[runneridx][R-CUR-BASE] < THIRD && gRunners[runneridx][R-FORCED] == false) {
                                        if (gRunners[local1][R-CUR-BASE] == gRunners[runneridx][R-DEST-BASE] && gRunners[local1][R-DEST-BASE] == NONE) {
                                            if (local12 < 2) {
                                                inc local12
                                            } else {
                                                if (gRunners[runneridx][R-DIRECTION] == FORWARD) {
                                                    gRunners[runneridx][R-DEST-BASE] = gRunners[runneridx][R-CUR-BASE]
                                                    gRunners[runneridx][R-DIRECTION] = BACKWARD
                                                } else if (gRunners[runneridx][R-DIRECTION] == BACKWARD) {
                                                    gRunners[runneridx][R-DEST-BASE] = gRunners[runneridx][R-CUR-BASE] + 1
                                                    gRunners[runneridx][R-DIRECTION] = FORWARD
                                                } else {
                                                }
                                                local20 = gRunners[runneridx][R-DEST-BASE]
                                                jump L0f61
                                            }
                                        }
                                    }
                                }
                            }
                        } else if (not gRunners[runneridx][17]) {
                            gRunners[runneridx][17] = 2
                        }
                        if (not gRunners[runneridx][18]) {
                            local13 = 100 - call-script smth_about_kid_data_2_and_errors gRunners[runneridx][R-KID]
                            local13 *= 25
                            local14 = random 10000
                        } else if (gRunners[runneridx][18] == 2) {
                            local14 = 0
                            local13 = 1
                        } else {
                            local14 = 1
                            local13 = 0
                        }
                        if (local14 >= local13) {
                            if (not gRunners[runneridx][18]) {
                                gRunners[runneridx][18] = 1
                            }
                            if (gRunners[runneridx][R-CUR-BASE] < R-HOME) {
                                if (not (gBallIsFoul || rCaughtFly)) {
                                    for local1 = 0 to 3 + {
                                        if (local1 != runneridx) {
                                            if (gRunners[local1][R-ORDER] > gRunners[runneridx][R-ORDER] && gRunners[local1][R-DIRECTION] == BACKWARD && gRunners[local1][R-DEST-BASE] == gRunners[runneridx][R-DEST-BASE]) {
                                                if (gRunners[runneridx][R-DIRECTION] == FORWARD) {
                                                    gRunners[runneridx][R-DEST-BASE] = gRunners[runneridx][R-CUR-BASE]
                                                    gRunners[runneridx][R-DIRECTION] = BACKWARD
                                                } else if (gRunners[runneridx][R-DIRECTION] == BACKWARD) {
                                                    gRunners[runneridx][R-DEST-BASE] = gRunners[runneridx][R-CUR-BASE] + 1
                                                    gRunners[runneridx][R-DIRECTION] = FORWARD
                                                } else {
                                                }
                                                local20 = gRunners[runneridx][R-DEST-BASE]
                                                jump L0f61
                                            }
                                        }
                                    }
                                }
                            }
                        } else if (not gRunners[runneridx][18]) {
                            gRunners[runneridx][18] = 2
                        }
                    } else {
                        flags2 = band flags2 23
                    }
                    local20 = gRunners[runneridx][R-DEST-BASE]
                    if (not (in local20 [0 1 2 3 4])) {
                        local20 = 0
                    }
                    if (gBases[local20][BASE-TAGGED-WITH-BALL] == true) {
                        if gRunners[runneridx][R-FORCED] {
                            flags = bor flags 7
                            if (gNumOuts + 1 > 2) {
                                g_smth_play_may_continue = 0
                            }
                            if runner_is_batter {
                                if gNetplayActive {
                                    if (g_net_smth_master == g_net_smth_me) {
                                        start-script AddNetStat gBatterKid STAT-FORCED-OUT 1
                                        start-script AddStat gBatterKid STAT-FORCED-OUT 1
                                    }
                                } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                    start-script AddStat gBatterKid STAT-FORCED-OUT 1
                                }
                            }
                        } else {
                            if (band flags2 8) {
                                local8 = line-length.2d gWorld[runner][X] gWorld[runner][Z] gRunners[runneridx][R-DEST-X] gRunners[runneridx][R-DEST-Z]
                                if (local8 < 180) {
                                    flags2 = band flags2 23
                                }
                            }
                            if (band flags2 8) {
                                if gRunners[runneridx][11] {
                                    flags2 = band flags2 23
                                }
                            }
                            if (band flags2 8) {
                                if (not gRunners[runneridx][20]) {
                                    local13 = 100 - call-script smth_about_kid_data_2_and_errors gRunners[runneridx][R-KID]
                                    local13 *= 10
                                    local14 = random 10000
                                    if (local14 >= local13) {
                                        gRunners[runneridx][20] = 1
                                    } else {
                                        flags2 = band flags2 23
                                        gRunners[runneridx][20] = 2
                                    }
                                } else if (gRunners[runneridx][20] == 2) {
                                    flags2 = band flags2 23
                                }
                            }
                            if (band flags2 8) {
                                global207 = 0
                                if (gRunners[runneridx][R-DEST-BASE] != gRunners[runneridx][R-CUR-BASE]) {
                                    local20 = gRunners[runneridx][R-CUR-BASE]
                                    for local1 = 0 to 3 + {
                                        if (local1 != runneridx) {
                                            if (gRunners[local1][R-CUR-BASE] == local20 && gRunners[local1][R-DEST-BASE] <= gRunners[local1][R-CUR-BASE]) {
                                                global207 = 1
                                            }
                                        }
                                    }
                                } else {
                                    local20 = gRunners[runneridx][R-CUR-BASE] + 1
                                    if (local20 > 4) {
                                        local20 = 4
                                    }
                                    for local1 = 0 to 3 + {
                                        if (local1 != runneridx) {
                                            if (gRunners[local1][R-CUR-BASE] == local20 && gRunners[local1][R-DEST-BASE] >= gRunners[local1][R-CUR-BASE]) {
                                                global207 = 1
                                            }
                                        }
                                    }
                                }
                                if (not global207) {
                                    gRunners[runneridx][R-DEST-BASE] = local20
                                    if (local20 == gRunners[runneridx][R-CUR-BASE]) {
                                        gRunners[runneridx][R-DIRECTION] = BACKWARD
                                    } else {
                                        gRunners[runneridx][R-DIRECTION] = FORWARD
                                    }
                                    L0f61:
                                    case local20 {
                                        1 {
                                            gRunners[runneridx][R-DEST-X] = gWorld[FIRST-BASE-CENTER][X]
                                            gRunners[runneridx][R-DEST-Z] = gWorld[FIRST-BASE-CENTER][Z]
                                        }
                                        2 {
                                            gRunners[runneridx][R-DEST-X] = gWorld[SECOND-BASE-CENTER][X]
                                            gRunners[runneridx][R-DEST-Z] = gWorld[SECOND-BASE-CENTER][Z]
                                        }
                                        3 {
                                            gRunners[runneridx][R-DEST-X] = gWorld[THIRD-BASE-CENTER][X]
                                            gRunners[runneridx][R-DEST-Z] = gWorld[THIRD-BASE-CENTER][Z]
                                        }
                                        [0 4] {
                                            gRunners[runneridx][R-DEST-X] = gWorld[HOME-PLATE-CENTER][X]
                                            gRunners[runneridx][R-DEST-Z] = gWorld[HOME-PLATE-CENTER][Z]
                                        }
                                        else {
                                        }
                                    }
                                } else {
                                    flags2 = band flags2 23
                                }
                            }
                        }
                    }
                }
                local11 = gRunners[runneridx][R-DIRECTION]
                if (gRunners[runneridx][R-STATE] == R-LEAVE-FIELD-WITH-OUT) {
                    print-debug.start
                    print-debug.printf "r%d: * I've been signaled to kill myself with an out. Do so at once." runneridx
                    flags = bor flags 7
                }
                if (gRunners[runneridx][R-STATE] == R-LEAVE-FIELD) {
                    print-debug.start
                    print-debug.printf "r%d: ** I've been signaled to kill myself. Do so at once." runneridx
                    flags = bor flags 3
                }
            } until (band flags 1)
            gRunners[runneridx][R-DIRECTION] = 0
            if (not gRunners[0][R-DIRECTION] && not gRunners[1][R-DIRECTION] && not gRunners[2][R-DIRECTION] && not gRunners[3][R-DIRECTION]) {
                g_maybe_play_is_ready_to_end = 1
                r_smth_fly_caught_runners_must_return = 0
            }
            flags2 = bor flags2 8
            pickle_counter = 0
            if (band flags2 1 && (g_smth_play_may_continue || in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-BASE-ON-BALLS 4 PE-OUT-OF-PLAY 6 7] || in gRunners[runneridx][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch])) {
                array-assign-range gRunners runneridx runneridx 16 20 0 0
                gRunnersExtra[runneridx][0] = false
                gRunnersExtra[runneridx][RE-SPRINT] = 0
                gBases[gRunners[runneridx][R-CUR-BASE]][BASE-RUNNERIDX] = NONE
                if (gRunners[runneridx][R-DEST-BASE] == NONE) {
                    print-debug.start
                    print-debug.printf "r%d: If I have no destination, how did I arrive?" runneridx
                } else if (gRunners[runneridx][R-DEST-BASE] > gRunners[runneridx][R-CUR-BASE]) {
                    global207 = gBases[gRunners[runneridx][R-DEST-BASE]][BASE-RUNNERIDX]
                    if (global207 != 999) {
                        if (gRunnersExtra[global207][0] && gRunners[global207][R-DIRECTION] != FORWARD) {
                            gRunnersExtra[global207][0] = false
                            gRunnersExtra[global207][RE-SPRINT] = 0
                        }
                    }
                }
                if gStealing {
                    if (gRunners[runneridx][R-STATE] == R-STEALING) {
                        if (gRunners[runneridx][R-DEST-BASE] == gRunners[runneridx][R-CUR-BASE] + 1) {
                            if (not (band flags 4) && not (band flags 2) && gBases[gRunners[runneridx][R-DEST-BASE]][BASE-TAGGED-WITH-BALL] == false) {
                                flags2 = bor flags2 2
                                if (gRunners[runneridx][R-DEST-BASE] == R-HOME) {
                                    start-script EnqueueComment DIALOGUE-STOLEN-HOME gRunners[runneridx][R-KID]
                                    if gNetplayActive {
                                        if (g_net_smth_master == g_net_smth_me) {
                                            start-script AddNetStat gRunners[runneridx][R-KID] STAT-STEALS 1
                                            start-script AddStat gRunners[runneridx][R-KID] STAT-STEALS 1
                                        }
                                    } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                        start-script AddStat gRunners[runneridx][R-KID] STAT-STEALS 1
                                    }
                                } else {
                                    start-script EnqueueComment DIALOGUE-STOLEN-BASE gRunners[runneridx][R-KID]
                                    if gNetplayActive {
                                        if (g_net_smth_master == g_net_smth_me) {
                                            start-script AddNetStat gRunners[runneridx][R-KID] STAT-STEALS 1
                                            start-script AddStat gRunners[runneridx][R-KID] STAT-STEALS 1
                                        }
                                    } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                        start-script AddStat gRunners[runneridx][R-KID] STAT-STEALS 1
                                    }
                                }
                            }
                        }
                    }
                }
                if (gRunners[runneridx][R-CUR-BASE] < R-HOME) {
                    r_runners_zeta[gRunners[runneridx][R-CUR-BASE]] = 999
                }
                if (gRunners[runneridx][R-DEST-BASE] < R-HOME) {
                    r_runners_zeta[gRunners[runneridx][R-DEST-BASE]] = 999
                }
                gRunners[runneridx][R-CUR-BASE] = gRunners[runneridx][R-DEST-BASE]
                gRunners[runneridx][R-DEST-BASE] = NONE
                if (gRunnerSpecialDestinations[runneridx] != NONE && not (band flags 4) && not (band flags 2)) {
                    if (gRunnerSpecialDestinations[runneridx] == gRunners[runneridx][R-CUR-BASE]) {
                        print-debug.start
                        print-debug.printf "r%d: I've arrived at my special destination (FORCE OFF)." runneridx
                        gRunners[runneridx][R-DIRECTION] = 0
                        gRunners[runneridx][R-FORCED] = false
                        if (gRunners[runneridx][R-STATE] == R-maybe-returning-after-catch) {
                            case gRunners[runneridx][R-CUR-BASE] {
                                FIRST {
                                    start-script EnqueueComment DIALOGUE-RUNNER-TAGS-FIRST gRunners[runneridx][R-KID]
                                }
                                SECOND {
                                    start-script EnqueueComment DIALOGUE-RUNNER-TAGS-SECOND gRunners[runneridx][R-KID]
                                }
                                THIRD {
                                    start-script EnqueueComment DIALOGUE-RUNNER-TAGS-THIRD gRunners[runneridx][R-KID]
                                }
                                else {
                                }
                            }
                        }
                        if (gRunners[runneridx][R-STATE] == R-maybe-returning-after-catch) {
                            gRunners[runneridx][R-STATE] = 3
                        }
                        if (gRunners[runneridx][R-STATE] == 2) {
                            gRunners[runneridx][R-STATE] = 3
                        }
                        if (not (in gRunners[0][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[1][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[2][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[3][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch])) {
                            r_smth_fly_caught_runners_must_return = 0
                        }
                    }
                }
                if (gRunners[runneridx][R-FORCED] && gRunners[runneridx][R-CUR-BASE] == rRunnerStartingBases[runneridx] && not r_smth_fly_caught_runners_must_return) {
                } else if (not (gBallIsFoul || rCaughtFly)) {
                    gRunners[runneridx][R-FORCED] = false
                }
                if (gRunners[runneridx][R-CUR-BASE] == R-HOME && not gBases[R-HOME][BASE-TAGGED-WITH-BALL] && not (band flags 4) && not (band flags 2)) {
                    if (gPlayEndedReason != PE-BASE-ON-BALLS) {
                        if (gNumRunners + gNumOuts > 2 && gRunners[0][R-FORCED] + gRunners[1][R-FORCED] + gRunners[2][R-FORCED] + gRunners[3][R-FORCED] + gNumOuts > 2 || gBallHasBounced == 0) {
                            start-script.rec maybe_runner_run_off_to_the_side runneridx actor angle4
                            break-until (not (script-running maybe_runner_run_off_to_the_side))
                        }
                    }
                    if (gBallIsFoul || (rCaughtFly && gRunners[runneridx][R-STATE] != 3)) {
                    } else {
                        gTeamInfo[gBattingTeamInfoIndex][TI-RUNS] = gTeamInfo[gBattingTeamInfoIndex][TI-RUNS] + 1
                        if gNetplayActive {
                            start-script.rec maybe_net_send_message 30 1 NET-RUNNER-SCORED actor gRunners[runneridx][R-KID]
                            if gNetplayActive {
                                start-script smth_net_stats_kludge 0
                            }
                        }
                        room29[runneridx] = 1
                        start-script.rec DrawNameUnderKid gRunners[runneridx][R-KID] (gRunners[runneridx][R-ENTITY] - 30) 113 0
                        if (gPlayEndedReason != PE-HOME-RUN) {
                            start-script EnqueueComment DIALOGUE-SCORED-RUN gRunners[runneridx][R-KID]
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat gRunners[runneridx][R-KID] STAT-RUNS-SCORED 1
                                start-script AddStat gRunners[runneridx][R-KID] STAT-RUNS-SCORED 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat gRunners[runneridx][R-KID] STAT-RUNS-SCORED 1
                        }
                        if gNetplayActive {
                            if (g_net_smth_master == g_net_smth_me) {
                                start-script AddNetStat rFieldingOrder[POS-PITCHER] STAT-RUNS-AGAINST 1
                                start-script AddStat rFieldingOrder[POS-PITCHER] STAT-RUNS-AGAINST 1
                            }
                        } else if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script AddStat rFieldingOrder[POS-PITCHER] STAT-RUNS-AGAINST 1
                        }
                        if (gBallWasHit || gNumBalls == 4) {
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat gBatterKid STAT-RBIS 1
                                    start-script AddStat gBatterKid STAT-RBIS 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat gBatterKid STAT-RBIS 1
                            }
                        }
                        if runner_is_batter {
                            room34 = 1
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat gBatterKid STAT-HOME-RUNS 1
                                    start-script AddStat gBatterKid STAT-HOME-RUNS 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat gBatterKid STAT-HOME-RUNS 1
                            }
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat gBatterKid STAT-HITS 1
                                    start-script AddStat gBatterKid STAT-HITS 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat gBatterKid STAT-HITS 1
                            }
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat gBatterKid STAT-AT-BATS 1
                                    start-script AddStat gBatterKid STAT-AT-BATS 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat gBatterKid STAT-AT-BATS 1
                            }
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat rFieldingOrder[POS-PITCHER] STAT-HITS-ALLOWED 1
                                    start-script AddStat rFieldingOrder[POS-PITCHER] STAT-HITS-ALLOWED 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat rFieldingOrder[POS-PITCHER] STAT-HITS-ALLOWED 1
                            }
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat rFieldingOrder[POS-PITCHER] STAT-BATTERS-FACED 1
                                    start-script AddStat rFieldingOrder[POS-PITCHER] STAT-BATTERS-FACED 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat rFieldingOrder[POS-PITCHER] STAT-BATTERS-FACED 1
                            }
                        }
                        flags = bor flags 2
                        start-script UpdateBasesWithRunners
                        start-script.rec lsc2085 gRunners[runneridx][R-CUR-BASE] runneridx
                    }
                } else {
                    start-script UpdateBasesWithRunners
                    if (gBases[gRunners[runneridx][R-CUR-BASE]][BASE-TAGGED-WITH-BALL] == true) {
                        flags = bor flags 6
                        if runner_is_batter {
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat gRunners[runneridx][R-KID] STAT-THROWN-OUT 1
                                    start-script AddStat gRunners[runneridx][R-KID] STAT-THROWN-OUT 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat gRunners[runneridx][R-KID] STAT-THROWN-OUT 1
                            }
                        }
                    } else if (rCurrentPlay == gRunners[runneridx][R-CUR-BASE]) {
                        if (random 1) {
                            start-script EnqueueComment DIALOGUE-RUNNER-SAFE gRunners[runneridx][R-KID]
                        } else {
                            case gRunners[runneridx][R-CUR-BASE] {
                                FIRST {
                                    start-script EnqueueComment DIALOGUE-RUNNER-SAFE-AT-FIRST gRunners[runneridx][R-KID]
                                }
                                SECOND {
                                    start-script EnqueueComment DIALOGUE-RUNNER-SAFE-AT-SECOND gRunners[runneridx][R-KID]
                                }
                                THIRD {
                                    start-script EnqueueComment DIALOGUE-RUNNER-SAFE-AT-THIRD gRunners[runneridx][R-KID]
                                }
                                else {
                                }
                            }
                        }
                    }
                }
            }
        }
        if (band flags 4) {
            flags = band flags 11
            flags = bor flags 2
            room28[runneridx] = 1
            start-script.rec DrawNameUnderKid gRunners[runneridx][R-KID] (gRunners[runneridx][R-ENTITY] - 30) 114 0
            if runner_is_batter {
                room34 = 1
                flags2 = bor flags2 16
                if gNetplayActive {
                    if (g_net_smth_master == g_net_smth_me) {
                        start-script AddNetStat gBatterKid STAT-AT-BATS 1
                        start-script AddStat gBatterKid STAT-AT-BATS 1
                    }
                } else if (MODE-BATTING-PRACTICE != gGameMode) {
                    start-script AddStat gBatterKid STAT-AT-BATS 1
                }
                if gNetplayActive {
                    if (g_net_smth_master == g_net_smth_me) {
                        start-script AddNetStat rFieldingOrder[POS-PITCHER] STAT-BATTERS-FACED 1
                        start-script AddStat rFieldingOrder[POS-PITCHER] STAT-BATTERS-FACED 1
                    }
                } else if (MODE-BATTING-PRACTICE != gGameMode) {
                    start-script AddStat rFieldingOrder[POS-PITCHER] STAT-BATTERS-FACED 1
                }
                if rCaughtFly {
                    if gNetplayActive {
                        if (g_net_smth_master == g_net_smth_me) {
                            start-script AddNetStat gRunners[runneridx][R-KID] STAT-POPPED-OUT 1
                            start-script AddStat gRunners[runneridx][R-KID] STAT-POPPED-OUT 1
                        }
                    } else if (MODE-BATTING-PRACTICE != gGameMode) {
                        start-script AddStat gRunners[runneridx][R-KID] STAT-POPPED-OUT 1
                    }
                }
            } else {
                flags2 = band flags2 15
            }
            if (rCurrentPlay == runneridx + 46) {
                if gFielderWithBall {
                    start-script SetSensibleNextPlay gFielderWithBall 100
                } else {
                    rCurrentPlay = NONE
                }
            }
            start-script EnqueueComment DIALOGUE-RUNNER-OUT gRunners[runneridx][R-KID]
            if (gNumOuts == room13 + 1) {
                start-script EnqueueComment DIALOGUE-DOUBLE-PLAY gRunners[runneridx][R-KID]
                if (not r_maybe_disable_powerups) {
                    start-script PlaySound 2098 0 1
                    gGivePowerup = bor gGivePowerup 64
                }
            } else if (gNumOuts == room13 + 2) {
                start-script EnqueueComment DIALOGUE-TRIPLE-PLAY gRunners[runneridx][R-KID]
                if (not r_maybe_disable_powerups) {
                    start-script PlaySound 2098 0 1
                    gGivePowerup = bor gGivePowerup 64
                }
            }
            inc gNumOuts
            if (gNumOuts >= 3) {
                start-script RetireTheSide runneridx runner_is_batter
            }
            start-script.rec lsc2085 gRunners[runneridx][R-CUR-BASE] runneridx
        }
        if (band flags 2) {
            flags = band flags 13
            start-script.rec SendRunnerOffField runneridx facing
            start-script UpdateBasesWithRunners
            stop-script 0
        }
    } until (gPlayEndedReason == PE-BASE-ON-BALLS)
    if gRunners[runneridx][11] {
        break-until (actor-get-variable actor 25)
        do-animation actor 12
        actor.init actor
        actor.variable 0 0
        actor.init actor
        actor.variable 25 0
        break-until (actor-get-variable actor 25)
        gRunners[runneridx][11] = 0
    }
    actor.init actor
    actor.condition [1]
    actor.init actor
    actor.condition [2]
    actor.init actor
    actor.condition [3]
    actor.init actor
    actor.condition [4]
    actor.init actor
    actor.condition [5]
    actor.init actor
    actor.condition [6]
    actor.init actor
    actor.condition [7]
    actor.init actor
    actor.condition [8]
    case gRunners[runneridx][R-CUR-BASE] {
        [0 R-HOME] {
            actor.init actor
            actor.condition [129]
        }
        FIRST {
            actor.init actor
            actor.condition [136]
        }
        SECOND {
            actor.init actor
            actor.condition [134]
        }
        THIRD {
            actor.init actor
            actor.condition [132]
        }
        else {
            print-debug.start
            print-debug.printf "r%d: Oh, you know." runneridx
        }
    }
    do-animation actor 6
    actor.init actor
    actor.variable 1 0
    actor.init actor
    actor.variable 2 0
}

local-script smth_watch_runners_near_same_base@2100 {
    var i j local2 local3 base local5 second first dist_second dist_first

    if gNetplayActive {
    }
    break-here.multi 2
    dim-array.u8 local2 3
    localize local2
    do {
        for i = 0 to 3 + {
            if (gRunners[i][R-CUR-BASE] != NONE) {
                if local2[i] {
                    if gRunnersExtra[i][0] {
                        if (gRunnersExtra[i][RE-SPRINT] == 0) {
                            gRunnersExtra[i][0] = false
                            local2[i] = 0
                        }
                    }
                }
            }
        }
        for i = 0 to 3 + {
            base = gRunners[i][R-CUR-BASE]
            for j = (i + 1) to 3 + {
                local5 = gRunners[j][R-CUR-BASE]
                if (base == local5) {
                    if (base < 4) {
                        if (line-length.2d gWorld[gRunners[i][R-ENTITY]][X] gWorld[gRunners[i][R-ENTITY]][Z] gWorld[gRunners[j][R-ENTITY]][X] gWorld[gRunners[j][R-ENTITY]][Z] < 72) {
                            gRunnersExtra[i][0] = false
                            gRunnersExtra[i][RE-SPRINT] = 0
                            gRunnersExtra[j][0] = false
                            gRunnersExtra[j][RE-SPRINT] = 0
                            gRunners[i][17] = 1
                            gRunners[i][17] = 1
                            gRunners[j][18] = 1
                            gRunners[j][18] = 1
                        }
                        if (gRunners[i][R-DEST-BASE] == NONE && gRunners[j][R-DEST-BASE] == NONE) {
                            if (gRunners[i][R-ORDER] > gRunners[j][R-ORDER]) {
                                second = i
                            } else {
                                second = j
                            }
                            gRunners[second][R-DEST-BASE] = gRunners[second][R-CUR-BASE] + 1
                            gRunnersExtra[second][0] = true
                            gRunnersExtra[second][RE-SPRINT] = 1
                            g_maybe_play_is_ready_to_end = 0
                        } else {
                            case (base + 1) {
                                [0 4] {
                                    local3 = HOME-PLATE-CENTER
                                }
                                1 {
                                    local3 = FIRST-BASE-CENTER
                                }
                                2 {
                                    local3 = SECOND-BASE-CENTER
                                }
                                3 {
                                    local3 = THIRD-BASE-CENTER
                                }
                                else {
                                }
                            }
                            if (gRunners[i][R-ORDER] < gRunners[j][R-ORDER]) {
                                second = j
                                first = i
                            } else {
                                second = i
                                first = j
                            }
                            dist_second = line-length.2d gWorld[local3][X] gWorld[local3][Z] gWorld[gRunners[second][R-ENTITY]][X] gWorld[gRunners[second][R-ENTITY]][Z]
                            dist_first = line-length.2d gWorld[local3][X] gWorld[local3][Z] gWorld[gRunners[first][R-ENTITY]][X] gWorld[gRunners[first][R-ENTITY]][Z]
                            if (dist_first < dist_second) {
                                gRunners[first][R-STATE] = R-LEAVE-FIELD-WITH-OUT
                            } else {
                                gRunners[second][R-DEST-BASE] = gRunners[second][R-CUR-BASE] + 1
                                gRunners[second][R-DIRECTION] = FORWARD
                                gRunnersExtra[second][0] = true
                                gRunnersExtra[second][RE-SPRINT] = 0
                                local2[second] = 1
                                g_maybe_play_is_ready_to_end = 0
                                case gRunners[second][R-DEST-BASE] {
                                    FIRST {
                                        gRunners[second][R-DEST-X] = gWorld[FIRST-BASE-CENTER][X]
                                        gRunners[second][R-DEST-Z] = gWorld[FIRST-BASE-CENTER][Z]
                                    }
                                    SECOND {
                                        gRunners[second][R-DEST-X] = gWorld[SECOND-BASE-CENTER][X]
                                        gRunners[second][R-DEST-Z] = gWorld[SECOND-BASE-CENTER][Z]
                                    }
                                    THIRD {
                                        gRunners[second][R-DEST-X] = gWorld[THIRD-BASE-CENTER][X]
                                        gRunners[second][R-DEST-Z] = gWorld[THIRD-BASE-CENTER][Z]
                                    }
                                    [0 R-HOME] {
                                        gRunners[second][R-DEST-X] = gWorld[HOME-PLATE-CENTER][X]
                                        gRunners[second][R-DEST-Z] = gWorld[HOME-PLATE-CENTER][Z]
                                    }
                                    else {
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
        break-here
    }
}

local-script WatchPlayEndAdvanceRunners@2101 {
    var i _ i2 i4 i3 runneridx advance runners base local9

    dim-array.i32 rRunnerStartingBases 3
    for i = 0 to 3 + {
        rRunnerStartingBases[i] = gRunners[i][R-CUR-BASE]
    }
    array-assign gRunnerSpecialDestinations [999 999 999 999] 0
    dim-array-2d.i32 runners 3 11
    localize runners
    break-until (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 4 PE-OUT-OF-PLAY 6 7 PE-BASE-ON-BALLS])
    stop-script smth_watch_runners_near_same_base
    stop-script WatchForceRunnersReturn
    stop-script maybe_runner_run_off_to_the_side
    if (gPlayEndedReason == PE-OUT-OF-PLAY) {
        for i = 0 to 3 + {
            if (gRunners[i][R-CUR-BASE] != NONE && rRunnersWhenBallLastThrown) {
                array-assign-slice runners rRunnersWhenBallLastThrown i i 0 11 i i 0 11
            } else {
                array-assign-slice runners gRunners i i 0 11 i i 0 11
            }
        }
    } else {
        array-assign-slice runners gRunners 0 3 0 11 0 3 0 11
    }
    if r_smth_fly_caught_runners_must_return {
        r_smth_fly_caught_runners_must_return = 0
        for i = 0 to 3 + {
            runners[i][R-DEST-BASE] = NONE
            if (runners[i][R-CUR-BASE] != NONE) {
                runners[i][R-CUR-BASE] = gRunnerSpecialDestinations[i]
            }
        }
    }
    array-assign-range gRunnersExtra 0 3 0 0 0 0
    case gPlayEndedReason {
        PE-HOME-RUN {
            for i = 0 to 3 + {
                if (runners[i][R-CUR-BASE] != NONE) {
                    if (not (gBallWasHit == false && gRunners[i][R-ORDER] == 0)) {
                        gRunnerSpecialDestinations[i] = R-HOME
                    }
                }
            }
        }
        PE-GROUND-RULE-DOUBLE {
            for i = 0 to 3 + {
                if (runners[i][R-CUR-BASE] != NONE) {
                    if (not (gBallWasHit == false && gRunners[i][R-ORDER] == 0)) {
                        base = rRunnerStartingBases[i] + 2
                        if (base > 4) {
                            base = 4
                        }
                        gRunnerSpecialDestinations[i] = base
                    }
                }
            }
        }
        9 {
            for i = 0 to 3 + {
                if (runners[i][R-CUR-BASE] != NONE) {
                    if (not (gBallWasHit == false && gRunners[i][R-ORDER] == 0)) {
                        base = rRunnerStartingBases[i] + 3
                        if (base > 4) {
                            base = 4
                        }
                        gRunnerSpecialDestinations[i] = base
                    }
                }
            }
        }
        PE-OUT-OF-PLAY {
            for i = 3 to 0 - {
                for i2 = 0 to 3 + {
                    if (runners[i2][R-CUR-BASE] != NONE) {
                        if (runners[i2][R-CUR-BASE] == i) {
                            runneridx = i2
                            if (runners[runneridx][R-DEST-BASE] == NONE) {
                                advance = 1
                            } else {
                                advance = 2
                            }
                            for i3 = 3 to runners[runneridx][R-CUR-BASE] - {
                                for i4 = 0 to 3 + {
                                    if (runners[i4][R-CUR-BASE] != NONE && i4 != runneridx) {
                                        if (runners[i4][R-CUR-BASE] == i3) {
                                            if (gRunnerSpecialDestinations[i4] == runners[runneridx][R-CUR-BASE] + advance && gRunnerSpecialDestinations[i4] < R-HOME) {
                                                advance = 1
                                            }
                                        }
                                    }
                                }
                            }
                            print-debug.start
                            print-debug.printf "runner %d at %d advance %d" runneridx runners[runneridx][R-CUR-BASE] advance
                            base = runners[runneridx][R-CUR-BASE] + advance
                            if (base > 4) {
                                base = 4
                            }
                            gRunnerSpecialDestinations[runneridx] = base
                        }
                    }
                }
            }
            for i2 = 0 to 3 + {
                if (gBallWasHit == false && gRunners[i2][R-ORDER] == 0) {
                    gRunnerSpecialDestinations[i2] = NONE
                }
            }
        }
        [4 6 7] {
            case gPlayEndedReason {
                [4 PE-BASE-ON-BALLS] {
                    local9 = 1
                }
                6 {
                    local9 = 3
                }
                7 {
                    local9 = 4
                }
                else {
                }
            }
            for i = 0 to 3 + {
                if (runners[i][R-CUR-BASE] != NONE) {
                    if (not (gBallWasHit == false && gRunners[i][R-ORDER] == 0)) {
                        base = runners[i][R-CUR-BASE] + local9
                        if (base > 4) {
                            base = 4
                        }
                        gRunnerSpecialDestinations[i] = base
                    }
                }
            }
        }
        PE-BASE-ON-BALLS {
            break-here
            for i = 0 to 3 + {
                if (runners[i][R-CUR-BASE] != NONE) {
                    if (not (gBallWasHit == false && gRunners[i][R-ORDER] == 0)) {
                        if gRunners[i][R-FORCED] {
                            base = runners[i][R-CUR-BASE] + 1
                        } else {
                            base = runners[i][R-CUR-BASE]
                        }
                        if (base > 4) {
                            base = 4
                        }
                        gRunnerSpecialDestinations[i] = base
                    } else if (gRunners[i][R-ORDER] == 0) {
                        gRunnerSpecialDestinations[i] = FIRST
                    }
                    print-debug.start
                    print-debug.printf "special-destination-array[%d] = %d (runner-bat-order = %d, forced = %d)" i gRunnerSpecialDestinations[i] gRunners[i][R-ORDER] gRunners[i][R-FORCED]
                }
            }
        }
        else {
        }
    }
    g_smth_play_may_continue = 0
    for i = 0 to 3 + {
        if (runners[i][R-CUR-BASE] != NONE) {
            gRunners[i][R-FORCED] = true
            if (in gRunners[i][R-STATE] [R-maybe-returning-after-catch 2]) {
                gRunners[i][R-STATE] = 3
            }
            if (not (in gRunners[0][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[1][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[2][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[3][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch])) {
                r_smth_fly_caught_runners_must_return = 0
            }
            if (runners[i][R-DEST-BASE] != NONE || runners[i][R-CUR-BASE] != gRunnerSpecialDestinations[i]) {
                gRunners[i][R-DIRECTION] = FORWARD
                base = runners[i][R-CUR-BASE] + 1
                if (base != 999) {
                    if (base > 4) {
                        base = 4
                    }
                    if (base < 0) {
                        base = 0
                    }
                }
                gRunners[i][R-DEST-BASE] = base
                case base {
                    1 {
                        gRunners[i][R-DEST-X] = gWorld[FIRST-BASE-CENTER][X]
                        gRunners[i][R-DEST-Z] = gWorld[FIRST-BASE-CENTER][Z]
                    }
                    2 {
                        gRunners[i][R-DEST-X] = gWorld[SECOND-BASE-CENTER][X]
                        gRunners[i][R-DEST-Z] = gWorld[SECOND-BASE-CENTER][Z]
                    }
                    3 {
                        gRunners[i][R-DEST-X] = gWorld[THIRD-BASE-CENTER][X]
                        gRunners[i][R-DEST-Z] = gWorld[THIRD-BASE-CENTER][Z]
                    }
                    [0 4] {
                        gRunners[i][R-DEST-X] = gWorld[HOME-PLATE-CENTER][X]
                        gRunners[i][R-DEST-Z] = gWorld[HOME-PLATE-CENTER][Z]
                    }
                    else {
                    }
                }
            }
        }
    }
    if (not gRunners[0][R-DIRECTION] && not gRunners[1][R-DIRECTION] && not gRunners[2][R-DIRECTION] && not gRunners[3][R-DIRECTION]) {
        g_maybe_play_is_ready_to_end = 1
        r_smth_fly_caught_runners_must_return = 0
    }
    undim runners
}

local-script WatchForceRunnersReturn@2102 {
    var i

    break-until (gBallIsFoul || rCaughtFly)
    array-assign gRunnerSpecialDestinations [999 999 999 999] 0
    r_smth_fly_caught_runners_must_return = 1
    stop-script maybe_runner_run_off_to_the_side
    for i = 0 to 3 + {
        gRunnerSpecialDestinations[i] = rRunnerStartingBases[i]
        gRunners[i][R-FORCED] = true
        if gBallIsFoul {
            gRunners[i][R-STATE] = R-maybe-returning-after-foul
        } else if rCaughtFly {
            if (gRunners[i][R-CUR-BASE] != rRunnerStartingBases[i] || gRunners[i][R-DEST-BASE] != NONE) {
                if (gPlayEndedReason == PE-INFIELD-FLY) {
                    gRunners[i][R-STATE] = R-maybe-returning-after-infield-fly
                } else {
                    gRunners[i][R-STATE] = R-maybe-returning-after-catch
                }
            } else {
                gRunners[i][R-STATE] = 3
                gRunners[i][R-FORCED] = false
                if (not (in gRunners[0][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[1][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[2][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch] || in gRunners[3][R-STATE] [R-maybe-returning-after-foul R-maybe-returning-after-infield-fly R-maybe-returning-after-catch])) {
                    r_smth_fly_caught_runners_must_return = 0
                }
            }
        } else {
            print-debug.start
            print-debug.string "You shouldn't be here"
        }
    }
}

local-script StealBaseCommentary@2103 arg0 arg1 {
    break-here.multi 3
    if (arg0 == 3) {
        start-script EnqueueComment DIALOGUE-STEALING-HOME gRunners[arg1][R-KID]
    } else {
        start-script EnqueueComment DIALOGUE-STEALING-BASE gRunners[arg1][R-KID]
    }
}

local-script ResuscitateRunners@2104 {
    var i j local2 order _ _ _ dist next_base

    array-assign-range gBases 0 4 1 1 0 0
    for j = 0 to 3 + {
        if (gRunners[j][R-CUR-BASE] != NONE) {
            gRunners[j][R-DEST-BASE] = NONE
        }
        gRunners[j][R-ORDER] = 999
        gRunners[j][R-STATE] = 0
    }
    array-assign-range gRunners 0 3 16 20 0 0
    start-script WatchPlayEndAdvanceRunners
    start-script WatchForceRunnersReturn
    start-script smth_watch_runners_near_same_base
    order = 0
    for i = 0 to 3 + {
        for j = 0 to 3 + {
            if (gRunners[j][R-CUR-BASE] == i) {
                if (not gPlayEndedReason) {
                    if (in i [1 2 3]) {
                        if gStealArray[i - 1] {
                            if gStealing {
                                start-script StealBaseCommentary i j
                            }
                            dist = 84
                            dist += 84 * gStealStartingPosAdjust / 100
                            case i {
                                1 {
                                    gWorld[gRunners[j][R-ENTITY]][X] = gWorld[FIRST-BASE-CENTER][X] - dist
                                    gWorld[gRunners[j][R-ENTITY]][Z] = gWorld[FIRST-BASE-CENTER][Z] + dist
                                }
                                2 {
                                    gWorld[gRunners[j][R-ENTITY]][X] = gWorld[SECOND-BASE-CENTER][X] - dist
                                    gWorld[gRunners[j][R-ENTITY]][Z] = gWorld[SECOND-BASE-CENTER][Z] - dist
                                }
                                3 {
                                    gWorld[gRunners[j][R-ENTITY]][X] = gWorld[THIRD-BASE-CENTER][X] + dist
                                    gWorld[gRunners[j][R-ENTITY]][Z] = gWorld[THIRD-BASE-CENTER][Z] - dist
                                }
                                else {
                                    print-system.start
                                    print-system.string "Error in resuscitate-players"
                                    debug 0
                                }
                            }
                            gRunners[j][R-STATE] = R-STEALING
                            gRunnersExtra[j][0] = true
                            gRunners[j][R-DIRECTION] = FORWARD
                            gRunners[j][R-DEST-BASE] = i + 1
                            next_base = i + 1
                            case next_base {
                                1 {
                                    gRunners[j][R-DEST-X] = gWorld[FIRST-BASE-CENTER][X]
                                    gRunners[j][R-DEST-Z] = gWorld[FIRST-BASE-CENTER][Z]
                                }
                                2 {
                                    gRunners[j][R-DEST-X] = gWorld[SECOND-BASE-CENTER][X]
                                    gRunners[j][R-DEST-Z] = gWorld[SECOND-BASE-CENTER][Z]
                                }
                                3 {
                                    gRunners[j][R-DEST-X] = gWorld[THIRD-BASE-CENTER][X]
                                    gRunners[j][R-DEST-Z] = gWorld[THIRD-BASE-CENTER][Z]
                                }
                                [0 4] {
                                    gRunners[j][R-DEST-X] = gWorld[HOME-PLATE-CENTER][X]
                                    gRunners[j][R-DEST-Z] = gWorld[HOME-PLATE-CENTER][Z]
                                }
                                else {
                                }
                            }
                        }
                    }
                }
                gRunners[j][R-ORDER] = order
                print-debug.start
                print-debug.printf "Setting batter %d at base %d to order %d" j gRunners[j][R-CUR-BASE] order
                inc order
            }
        }
    }
    if (gStealArray[0] + gStealArray[1] + gStealArray[2]) {
        start-script TransformWorldToView
        start-script TransformViewToScreen
    }
    start-script SetForcedRunners
    for j = 0 to 3 + {
        local2 = gRunners[j][R-CUR-BASE]
        if (local2 != 999) {
            gBases[local2][BASE-RUNNERIDX] = j
            gRunners[j][R-DIRECTION] = FORWARD
            start-script.rec RunnerLoop j
        }
    }
}

local-script AddRunnerForBatter@2105 {
    var local0 local1

    if gNetplayActive {
    }
    if (gNumRunners > 3 + 1) {
        print-debug.start
        print-debug.string "Too many runners!"
        stop-script 0
    }
    for local1 = 0 to 3 + {
        if (gRunners[local1][R-CUR-BASE] == 0) {
            gRunners[local1][R-CUR-BASE] = NONE
            gRunners[local1][R-DEST-BASE] = NONE
            gRunners[local1][R-ORDER] = 999
            gRunners[local1][R-SPEED] = 0
            gRunners[local1][R-DEST-X] = 0
            gRunners[local1][R-DEST-Z] = 0
            gRunners[local1][R-KID] = 0
            gRunners[local1][R-STATE] = 0
            gRunners[local1][R-VELOCITY-X] = 0
            gRunners[local1][R-VELOCITY-Y] = 0
            gRunners[local1][16] = 0
            gRunners[local1][17] = 0
            gRunners[local1][19] = 0
            gRunners[local1][18] = 0
            gRunners[local1][20] = 0
            gRunners[local1][R-DIRECTION] = 0
            gRunners[local1][11] = 0
            gRunners[local1][R-FORCED] = false
            gBases[0][BASE-RUNNERIDX] = NONE
        }
    }
    gNumRunners = 0
    for local1 = 0 to 3 + {
        if (gRunners[local1][R-CUR-BASE] != NONE) {
            inc gNumRunners
        }
    }
    inc gNumRunners
    while (gRunners[local0][R-CUR-BASE] != NONE) {
        inc local0
        if (local0 > 3) {
            print-debug.start
            print-debug.string "Programmer failure!"
            stop-script 0
        }
    }
    gRunners[local0][R-CUR-BASE] = 0
    array-assign-row gWorld gRunners[local0][R-ENTITY] [0 0 300]
    gRunners[local0][R-KID] = gBatterKid
    gRunners[local0][R-DIRECTION] = FORWARD
    gRunners[local0][15] = 400
    if (gOffenseControlledBy == CB-USER) {
        gRunnerCursorIndex = local0
        start-script DrawNameUnderRunner gRunnerCursorIndex
    }
    start-script UpdateBasesWithRunners
}

local-script InitSomeVars@2106 {
    g_maybe_play_is_ready_to_end = 0
    rCaughtFly = false
    if (gBases == 0) {
        dim-array-2d.i16 gBases 4 2
        array-assign-range gBases 0 4 0 0 999 999
    }
    if (gRunners == 0) {
        dim-array-2d.i16 gRunners 3 20
        array-assign-range gRunners 0 3 0 0 999 999
        array-assign-range gRunners 0 3 7 7 999 999
        array-assign-range gRunners 0 3 1 1 46 (46 + 3)
    }
    dim-array.u8 room28 3
    dim-array.u8 room29 3
}

local-script StartOffense@2107 {
    dim-array-2d.i32 gRunnersExtra 3 1
    array-assign r_runners_zeta [999 999 999 999] 0
    start-script InitSomeVars
    if (gNetplayActive && g_net_smth_master == g_net_smth_slave) {
    } else {
        start-script AddRunnerForBatter
        start-script ResuscitateRunners
    }
    if (gTeamInfo[gBattingTeamInfoIndex][TI-CONTROLLED-BY] == CB-USER && gGameMode != MODE-SPECTATE) {
        gInputHandlerScript = HandleInputOffense
        stop-script CursorLoop
        if (gGameInputDevice == INPUT-DEVICE-GAME-PAD) {
            start-script GampadCursorLoopOffense
            gCursorLoopScript = GampadCursorLoopOffense
        } else {
            start-script MouseCursorLoopOffense
            gCursorLoopScript = MouseCursorLoopOffense
        }
    }
}

local-script BattingPracticeOverheadLoop@2108 {
    var _ _ _ local3 local4 local5 local6

    start-script FlightEngine
    break-until (not (script-running FlightEngine))
    start-script DrawBallDistanceDecal
    break-here
    local3 = actor-get-x 6
    local4 = actor-get-y 6
    local5 = actor-get-x 7
    local6 = actor-get-y 7
    put-actor 6 600 600 255
    put-actor 7 600 600 255
    nuke-image image551
    kludge 714 19 551 1
    lock-image image551
    image.init image551
    image.capture 1 0 0 639 479
    image.end
    put-actor 6 local3 local4 255
    put-actor 7 local5 local6 255
    sleep-for.seconds 1
    gMinJiffies = 6
    current-room batview
}

local-script RunOverheadView@2109 {
    actor.init 3
    actor.new
    actor.costume costume565
    actor.ignore-boxes
    actor.always-zclip 1
    actor.init 4
    actor.new
    actor.costume costume565
    actor.ignore-boxes
    actor.always-zclip 1
    actor.animation-speed 3
    actor.elevation -100
    actor.shadow global423
    put-actor 4 -100 -100 gCurrentRoom
    put-actor 3 -100 -100 gCurrentRoom
    do-animation 4 20
    actor.init 4
    actor.color 231 (rgb 0 0 0)
    temp = call-script SetBallAnimation 3 -1 -1 -1
    if (MODE-BATTING-PRACTICE == gGameMode) {
        chain-script BattingPracticeOverheadLoop
    }
    if (in gPlayEndedReason [PE-BASE-ON-BALLS PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 4 PE-OUT-OF-PLAY 6 7]) {
        g_smth_play_may_continue = 0
        g_maybe_play_is_ready_to_end = 0
        start-script StartOffense
        start-script StartDefense
        if gNetplayActive {
            start-script NetBeginSendLoop
        }
        if (gNetplayActive && g_net_smth_master != g_net_smth_me) {
            start-script NetApplyRemoteState
            break-here
            jump L0171
        }
        break-until g_maybe_play_is_ready_to_end
        break-until (not gCurrentSpeechScript && not (script-running maybe_record_replay_then_wait_to_cast_end_of_play) && gCommentaryIsIdle)
        break-here.multi (30 / gMinJiffies)
        gPlayEndedReason = 0
    } else if gNetplayActive {
        if (g_net_smth_master == g_net_smth_me) {
            start-script FlightEngine
            break-until (not (script-running FlightEngine))
        } else {
            start-script StartDefense
            start-script StartOffense
            start-script NetApplyRemoteState
            jump L0171
        }
    } else {
        start-script FlightEngine
        break-until (not (script-running FlightEngine))
    }
    if gNetplayActive {
        start-script.rec maybe_net_send_message 30 1 NET-OV-PLAY-OVER
        gNetOvPlayOver = 1
    }
    L0171:
    if gNetplayActive {
        gNetWaitFlag = 0
        if (g_net_smth_master == g_net_smth_slave) {
            do {
                start-script NetApplyRemoteState
                break-here
            } until gNetOvPlayOver
        } else {
            break-until gNetOvPlayOver
        }
        gNetOvPlayOver = 0
        start-script AddStatsForThisAtBat
        if (g_net_smth_master == g_net_smth_me) {
            start-script maybe_net_send_fatigue
        } else {
            break-until global698
            start-script NetApplyRemoteState
        }
        global698 = 0
    } else {
        start-script AddStatsForThisAtBat
    }
    break-until (not gCurrentSpeechScript)
    if (gGivePowerup == 1) {
        if (gBatterKidHitsBeforeNow < gGameStats[gBatterKid][STAT-HITS]) {
            start-script PlaySound 2098 0 1
            gGivePowerup += 32
            if gNetplayActive {
                start-script.rec maybe_net_send_message 30 1 NET-smth-powerup gGivePowerup
            }
            break-until (not (sound-running sound2098))
        }
    }
    global248 = 0
    if gNetplayActive {
        global248 = 98
        start-script.rec maybe_net_send_message 30 1 NET-WAITFLAG global510 global248
        do {
            break-here
        } until gNetWaitFlag
        dec gNetWaitFlag
    }
    if (script-running HomeRunStuff) {
        g_maybe_skipped_cutscene = 1
        break-until (not (script-running HomeRunStuff))
        g_maybe_skipped_cutscene = 0
    }
    current-room batview
}

local-script SimulateBallStopPosition@2110 set_fielding_target {
    var local1 _ _ prev_vel_y pos_x pos_y pos_z vel_x vel_y vel_z

    pos_x = gBallPosPhysX
    pos_y = gBallPosPhysY
    pos_z = gBallPosPhysZ
    vel_x = gBallVelPhysX
    vel_y = gBallVelPhysY
    vel_z = gBallVelPhysZ
    local1 = gCameraTransform[1][gCurrentRoom]
    do {
        prev_vel_y = vel_y
        if (pos_y != 0) {
            vel_y -= 384000 * gGravity / 60 * gVectorScaleNum / gVectorScaleDen
        }
        pos_x += vel_x * gVectorScaleNum / gVectorScaleDen
        pos_y += vel_y * gVectorScaleNum / gVectorScaleDen
        pos_z += vel_z * gVectorScaleNum / gVectorScaleDen
        if (pos_y <= 0) {
            pos_y = 0
            vel_x = vel_x * gFieldHorizontalBounciness / 100
            if vel_y {
                vel_y = abs (vel_y * gFieldVerticalBounciness / 100)
                if (abs vel_y > abs prev_vel_y) {
                    vel_y = 0
                }
            }
            vel_z = vel_z * gFieldHorizontalBounciness / 100
        }
        if (vel_x == 0 && vel_y == 0 && vel_z == 0) {
            if set_fielding_target {
                gFieldingTargetX = pos_x / 1000
                gFieldingTargetZ = pos_z / 1000
            }
            gBallPath[100][0] = pos_x / 1000
            gBallPath[100][1] = pos_z / 1000
            stop-script 0
        }
    }
}

local-script DoUndergrounder@2111 {
    var local0 local1 local2 local3 local4

    gFielderWithBall = 1
    local1 = call-script FindFreeActor
    actor.init local1
    actor.new
    actor.costume costume363
    actor.elevation -5000
    actor.animation-speed 2
    actor.ignore-boxes
    actor.scale (call-script CalcBallActorScale)
    put-actor local1 gScreen[BALL][X] (gScreen[BALL][Y] - 5000) gCurrentRoom
    case gField {
        [TIN-CAN-ALLEY CEMENT-GARDENS] {
            do-animation local1 7
        }
        [SANDY-FLATS] {
            do-animation local1 8
        }
        else {
            do-animation local1 6
        }
    }
    if gNetplayActive {
        start-script NetSendSound 2012
    }
    start-script PlaySound 2012
    put-actor 3 -100 -100 gCurrentRoom
    put-actor 4 -100 -100 gCurrentRoom
    local0 = random-between 1300 1600
    local3 = random-between 120 200
    local4 = random-between 46 134
    gBallVelPhysZ = sin local4 * local3 / 100
    gBallVelPhysX = cos local4 * local3 / 100
    do {
        gBallPosPhysX += gBallVelPhysX * gVectorScaleNum / gVectorScaleDen
        gBallPosX = gBallPosPhysX / 1000
        gBallPosPhysY = 0
        gBallPosY = 0
        gBallPosPhysZ += gBallVelPhysZ * gVectorScaleNum / gVectorScaleDen
        gBallPosZ = gBallPosPhysZ / 1000
        break-here
    } until (line-length.2d gBallPosX gBallPosZ 0 300 > local0)
    gWorld[BALL][X] = gBallPosX
    gWorld[BALL][Y] = gBallPosY
    gWorld[BALL][Z] = gBallPosZ
    break-here.multi (random-between 10 40)
    local2 = call-script FindFreeActor
    actor.init local2
    actor.new
    actor.costume costume363
    actor.elevation -5000
    actor.animation-speed 2
    actor.ignore-boxes
    actor.scale (call-script CalcBallActorScale)
    put-actor local2 gScreen[BALL][X] (gScreen[BALL][Y] - 5000) gCurrentRoom
    case gField {
        [TIN-CAN-ALLEY CEMENT-GARDENS] {
            do-animation local2 7
        }
        [SANDY-FLATS] {
            do-animation local2 8
        }
        else {
            do-animation local2 6
        }
    }
    if gNetplayActive {
        start-script NetSendSound 2013
    }
    start-script PlaySound 2013
    gFielderWithBall = 0
    gGivePowerup = 0
    gBallVelPhysY = random-between 60000 100000
    gBallHasBounced = 1
    start-script SimulateBallStopPosition true
    start-script SendClosestFielderToTarget true
}

local-script RunFunnyBunt@2112 {
    var fielder fielder_dist local2 local3 local4 local5 local6 local7 sound prev_fielder_idx local10

    local5 = random-between 100 300
    if (gDebug == 69) {
        print-debug.start
        print-debug.string "funny bunt"
    }
    sound = pick-random local10 [2015 2016 2017 2018 2019]
    do {
        fielder = call-script FindClosestFielder gBallPosX gBallPosZ
        fielder_dist = line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gBallPosX gBallPosZ
        if (line-length.2d gBallPosX gBallPosZ gBallPosX (abs gBallPosX + 300) < fielder_dist) {
            local2 = random-between 70 110
            fielder = 0
            fielder_dist = line-length.2d gBallPosX gBallPosZ gBallPosX (abs gBallPosX + 300)
        } else {
            local2 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gBallPosX gBallPosZ
            local2 += random-between -30 30
            if (local2 > 360) {
                local2 -= 360
            }
            if (local2 < 0) {
                local2 += 360
            }
        }
        if (fielder != prev_fielder_idx && not (sound-running sound)) {
            prev_fielder_idx = fielder
            sound = pick-random local10 [2015 2016 2017 2018 2019]
            if gNetplayActive {
                start-script NetSendSound sound
            }
            start-script PlaySound sound
            if (fielder != 0) {
                gFieldingTargetX = gBallPosX
                gFieldingTargetZ = gBallPosZ
                start-script SendClosestFielderToTarget
            }
        }
        if (fielder_dist < 48) {
            local3 = 80
        } else {
            local3 = random-between 5 10 * 500 / fielder_dist
        }
        if (local3 > 80) {
            local3 = 100
        }
        if (not (random 10)) {
            if (gBallPosPhysY < 12000) {
                gBallVelPhysY += local3 * 1000
            }
        }
        local6 = cos local2 * local3 / 100
        local7 = sin local2 * local3 / 100
        if (call-script IsFoulTerritory ((gBallPosPhysX + gBallVelPhysX + local6) / 1000) ((gBallPosPhysZ + gBallVelPhysZ + local7 + 12000) / 1000)) {
            local2 = angle-from-line ((gBallPosPhysX + gBallVelPhysX + local6) / 1000) ((gBallPosPhysZ + gBallVelPhysZ + local7) / 1000) 0 (random-between 360 2000)
            if (gDebug == 69) {
                print-debug.start
                print-debug.string "bunt going foul"
            }
            do {
                local6 += cos local2 * local3 / 100
                local7 += sin local2 * local3 / 100
            } until (not (call-script IsFoulTerritory ((gBallPosPhysX + gBallVelPhysX + local6) / 1000) ((gBallPosPhysZ + gBallVelPhysZ + local7 + 12000) / 1000)))
        }
        gBallVelPhysX += local6
        gBallVelPhysZ += local7
        if (gBallVelPhysX > 200000) {
            gBallVelPhysX = 200000
        }
        if (gBallVelPhysX < -200000) {
            gBallVelPhysX = -200000
        }
        if (gBallVelPhysZ > 200000) {
            gBallVelPhysZ = 200000
        }
        if (gBallVelPhysZ < -200000) {
            gBallVelPhysZ = -200000
        }
        if (gBallVelPhysY > 120000) {
            gBallVelPhysY = 120000
        }
        break-here
        inc local4
        if (gCollideIntersectValid || gBallIsFoul) {
            local4 = local5 + 1
        }
    } until (local4 > local5 || gFielderWithBall)
    undim local10
}

local-script FlightEngine@2113 {
    var local0 local1 local2 preflight_simulation local4 _ maybe_play_dying_counter _ local8 local9 local10 local11

    if (not gHitVelPhysX && not gHitVelPhysY && not gHitVelPhysZ) {
        print-debug.start
        print-debug.string "No vector!"
        stop-script 0
    }
    if (not gBallPath) {
        dim-array-2d.i32 gBallPath 100 2
    }
    if (not gHitPosPhysX && not gHitPosPhysY && not gHitPosPhysZ) {
        gHitPosPhysX = 0
        gHitPosPhysY = 40000
        gHitPosPhysZ = 300000 + 17000
    }
    gBallPosPhysX = gHitPosPhysX
    gBallPosX = gBallPosPhysX / 1000
    gBallPosPhysY = gHitPosPhysY
    gBallPosY = gBallPosPhysY / 1000
    gBallPosPhysZ = gHitPosPhysZ
    gBallPosZ = gBallPosPhysZ / 1000
    gBallHasBounced = 0
    gBallIsFoul = false
    gSimFirstBounceFoul = false
    gBallIsFair = false
    gPlayEndedReason = 0
    gBallVelPhysX = gHitVelPhysX
    gBallVelPhysY = gHitVelPhysY
    gBallVelPhysZ = gHitVelPhysZ
    gFieldingTargetX = 0
    gFieldingTargetZ = -10000
    g_maybe_smth_play_is_alive = 1
    gFielderWithBall = 0
    room10 = gVectorScaleDen
    if (MODE-BATTING-PRACTICE == gGameMode) {
        gVectorScaleDen += 1
        preflight_simulation = 0
    } else {
        if (gBallVelPhysY > 80000) {
            rBallWasHitHigh = true
            gVectorScaleDen += 2
        } else {
            gVectorScaleDen += 1
            rBallWasHitHigh = false
        }
        preflight_simulation = 1
    }
    do {
        local0 = gBallVelPhysY
        if (gBallPosPhysY != 0) {
            gBallVelPhysY -= 384000 * gGravity / 60 * gVectorScaleNum / gVectorScaleDen
        }
        gBallPosPhysX += gBallVelPhysX * gVectorScaleNum / gVectorScaleDen
        gBallPosX = gBallPosPhysX / 1000
        gBallPosPhysY += gBallVelPhysY * gVectorScaleNum / gVectorScaleDen
        gBallPosY = gBallPosPhysY / 1000
        gBallPosPhysZ += gBallVelPhysZ * gVectorScaleNum / gVectorScaleDen
        gBallPosZ = gBallPosPhysZ / 1000
        rBallCatchDistance = line-length.2d 0 0 (gBallVelPhysX / 1000) (gBallVelPhysZ / 1000) * 4 * gVectorScaleNum / gVectorScaleDen + 60
        if (gBallPosPhysY <= 0 || gCollideIntersectValid) {
            if (not preflight_simulation) {
                if (gBallVelPhysX || gBallVelPhysZ) {
                    local10 = angle-from-line 0 0 gBallVelPhysX gBallVelPhysZ
                }
                if g_maybe_he9_play_could_end_soon {
                    local9 = 0
                } else {
                    local9 = line-length.2d 0 0 gBallVelPhysX gBallVelPhysZ
                }
                local11 = call-script SetBallAnimation 3 local10 local9 local11
                if (gBallPosPhysY <= 0) {
                    case 1 {
                        (abs gBallVelPhysX + abs gBallVelPhysY + abs gBallVelPhysZ > 160000) {
                            if (not (sound-running sound2001)) {
                                if gNetplayActive {
                                    gNetStateBuffer[1][4] = gBounceSoundLoud
                                    gNetStateBuffer[1][5] = band gNetStateBuffer[1][5] 15
                                }
                                sound.start gBounceSoundLoud
                                sound.end
                            }
                        }
                        (abs gBallVelPhysX + abs gBallVelPhysY + abs gBallVelPhysZ > 90000) {
                            if gNetplayActive {
                                gNetStateBuffer[1][4] = gBounceSoundMed
                                gNetStateBuffer[1][5] = gNetStateBuffer[1][5] + 8
                            }
                            sound.start gBounceSoundMed
                            sound.soft
                            sound.end
                        }
                        (abs gBallVelPhysX + abs gBallVelPhysY + abs gBallVelPhysZ > 40000) {
                            if gNetplayActive {
                                gNetStateBuffer[1][4] = gBounceSoundSoft
                                gNetStateBuffer[1][5] = gNetStateBuffer[1][5] + 8
                            }
                            sound.start gBounceSoundSoft
                            sound.soft
                            sound.end
                        }
                        else {
                        }
                    }
                }
            }
        }
        if (gBallPosPhysY <= 0) {
            if (gBallHasBounced != 1) {
                gBallHasBounced = 1
                if preflight_simulation {
                    if gObviousFoul {
                        gSimFirstBounceFoul = true
                    } else if (call-script IsFoulTerritory gBallPosX gBallPosZ) {
                        gSimFirstBounceFoul = true
                    }
                    gSimFirstBounceX = gBallPosX
                    gSimFirstBounceZ = gBallPosZ
                    if (in gCurrentSwing [SWING-UNDERGROUNDER SWING-CRAZY-BUNT]) {
                        if gBallWasHit {
                            jump L06cf
                        }
                    }
                } else {
                    if (not gBallIsFair) {
                        if (call-script IsFoulTerritory gBallPosX gBallPosZ) {
                            gBallIsFoul = true
                        } else if (line-length.2d 0 300 gBallPosX gBallPosZ > 780) {
                            gBallIsFair = true
                        }
                    }
                    if (not gBallIsFoul) {
                        if (gCurrentSwing == SWING-UNDERGROUNDER) {
                            if gBallWasHit {
                                start-script DoUndergrounder
                                break-until (not (script-running DoUndergrounder))
                                jump L06cf
                            }
                        }
                        if (gPlayEndedReason == 0) {
                            if (call-script IsBallOffScreen) {
                                if g_maybe_last_fielder_to_touch_ball {
                                    gPlayEndedReason = PE-OUT-OF-PLAY
                                    g_maybe_smth_play_is_alive = 0
                                } else {
                                    gPlayEndedReason = PE-HOME-RUN
                                }
                            }
                        }
                    }
                }
            } else if (not preflight_simulation) {
                if (not gBallIsFair) {
                    if (call-script IsFoulTerritory gBallPosX gBallPosZ) {
                        gBallIsFoul = true
                    } else if (line-length.2d 0 300 gBallPosX gBallPosZ > 780) {
                        gBallIsFair = true
                    }
                }
                if (not gBallIsFoul) {
                    if (gPlayEndedReason == 0) {
                        if (call-script IsBallOffScreen) {
                            if g_maybe_last_fielder_to_touch_ball {
                                gPlayEndedReason = PE-OUT-OF-PLAY
                                g_maybe_smth_play_is_alive = 0
                            } else {
                                gPlayEndedReason = PE-GROUND-RULE-DOUBLE
                            }
                        }
                    }
                }
            }
            gBallPosPhysY = 0
            gBallPosY = 0
            gBallVelPhysX = gBallVelPhysX * gFieldHorizontalBounciness / 100
            if gBallVelPhysY {
                gBallVelPhysY = abs (gBallVelPhysY * gFieldVerticalBounciness / 100)
                if (abs gBallVelPhysY > abs local0) {
                    gBallVelPhysY = 0
                }
            }
            gBallVelPhysZ = gBallVelPhysZ * gFieldHorizontalBounciness / 100
            if (not preflight_simulation) {
                start-script AddBounceRandomness
            }
        }
        if preflight_simulation {
            if (local1 > 14) {
                if (gBallPosPhysY < 60000 || gBallPosPhysY + gBallVelPhysY * gVectorScaleNum / gVectorScaleDen < 60000) {
                    gBallPath[local2][0] = gBallPosX
                    gBallPath[local2][1] = gBallPosZ
                    gBallPath[local2][2] = local1
                    inc local2
                    if (local2 > 100) {
                        local2 = 100
                    }
                }
            }
            inc local1
        } else {
            if (not g_maybe_smth_play_is_alive) {
                if (MODE-BATTING-PRACTICE == gGameMode) {
                    jump L054c
                }
                if g_maybe_play_is_ready_to_end {
                    break-here
                    if (not gCurrentSpeechScript && not (script-running maybe_record_replay_then_wait_to_cast_end_of_play) && gCommentaryIsIdle) {
                        L054c:
                        if (gObviousFoul && not gBallIsFoul) {
                            print-debug.start
                            print-debug.string "gObvious fould but !ov-ball-is-foul!!!!!"
                            debug 0
                        }
                        gVectorScaleDen = room10
                        gFielderWithBall = 0
                        stop-script 0
                    }
                }
            }
            if (not gFielderWithBall) {
                start-script RunCollision
            }
            gWorld[BALL][X] = gBallPosX
            gWorld[BALL][Y] = gBallPosY
            gWorld[BALL][Z] = gBallPosZ
            gWorld[BALL-SHADOW][X] = gBallPosX
            gWorld[BALL-SHADOW][Y] = 0
            gWorld[BALL-SHADOW][Z] = gBallPosZ
            break-here
            local4 = 5002 - gWorld[BALL][Z]
            actor.init 3
            actor.elevation local4
            actor.scale (call-script CalcBallActorScale)
            put-actor 3 gScreen[BALL][X] (local4 + gScreen[BALL][Y]) gCurrentRoom
            actor.init 4
            actor.scale (call-script CalcBallActorScale 1)
            put-actor 4 gScreen[BALL-SHADOW][X] (gScreen[BALL-SHADOW][Y] - 100) gCurrentRoom
        }
        if gFielderWithBall {
            if rBallWasHitHigh {
                if (not local8) {
                    local8 = 1
                    dec gVectorScaleDen
                }
            }
            gBallVelPhysX = 0
            gBallVelPhysY = 0
            gBallVelPhysZ = 0
            gBallPosPhysX = -1000000
            gBallPosX = gBallPosPhysX / 1000
            gBallPosPhysY = 1000000
            gBallPosY = gBallPosPhysY / 1000
            gBallPosPhysZ = -1000000
            gBallPosZ = gBallPosPhysZ / 1000
            put-actor 3 -100 -100 gCurrentRoom
            put-actor 4 -100 -100 gCurrentRoom
            do {
                break-here
            } until (not gFielderWithBall || not g_maybe_smth_play_is_alive)
            local2 = 0
            maybe_play_dying_counter = 0
            local0 = gBallVelPhysY
        }
        L06cf:
        if (MODE-BATTING-PRACTICE == gGameMode) {
            if (not preflight_simulation) {
                if (abs gBallVelPhysX < 2000) {
                    if (abs gBallVelPhysY == 0) {
                        if (abs gBallVelPhysZ < 2000) {
                            jump L0885
                        }
                    }
                }
                if g_he9_play_ended {
                    jump L0885
                }
            }
        }
        if (not gBallVelPhysX) {
            if (not gBallVelPhysY) {
                if (not gBallVelPhysZ) {
                    if preflight_simulation {
                        gBallPath[100][0] = gBallPosX
                        gBallPath[100][1] = gBallPosZ
                        if (not local2) {
                            local2 = 1
                        }
                        gBallPath[local2 - 1][2] = DEAD-BALL
                        preflight_simulation = 0
                        gBallHasBounced = 0
                        gBallPosPhysX = gHitPosPhysX
                        gBallPosX = gBallPosPhysX / 1000
                        gBallPosPhysY = gHitPosPhysY
                        gBallPosY = gBallPosPhysY / 1000
                        gBallPosPhysZ = gHitPosPhysZ
                        gBallPosZ = gBallPosPhysZ / 1000
                        gBallVelPhysX = gHitVelPhysX
                        gBallVelPhysY = gHitVelPhysY
                        gBallVelPhysZ = gHitVelPhysZ
                        if gBallWasHit {
                            if (gCurrentSwing == SWING-ALUMINUM-POWER) {
                                if gNetplayActive {
                                    start-script NetSendSound 2020
                                }
                                start-script PlaySound 2020
                            } else if (gCurrentSwing == SWING-SCREAMING-LINE-DRIVE) {
                                if gNetplayActive {
                                    start-script NetSendSound 2021
                                }
                                start-script PlaySound 2021
                            } else if (gCurrentSwing == SWING-CRAZY-BUNT) {
                                start-script RunFunnyBunt
                            }
                        }
                        if (MODE-BATTING-PRACTICE != gGameMode) {
                            start-script StartDefense
                            start-script StartOffense
                            if gNetplayActive {
                                start-script NetBeginSendLoop
                            }
                        }
                        local2 = 0
                        gScreen[BALL][X] = 320
                        gScreen[BALL][Y] = 436
                        gScreen[BALL-SHADOW][X] = 320
                        gScreen[BALL-SHADOW][Y] = 436
                    } else {
                        if (gPlayEndedReason == PE-HOME-RUN && not rDrawnBallDistanceDecal) {
                            rDrawnBallDistanceDecal = 1
                            start-script DrawBallDistanceDecal
                        }
                        if (g_maybe_play_is_ready_to_end || not gNumRunners) {
                            inc maybe_play_dying_counter
                            if (maybe_play_dying_counter > 80) {
                                L0885:
                                g_maybe_smth_play_is_alive = 0
                            }
                        } else {
                            maybe_play_dying_counter = 0
                        }
                        if g_maybe_smth_play_is_alive {
                            inc local2
                            if (local2 > 10 && not gBallIsFoul) {
                                gFieldingTargetX = gBallPosX
                                gFieldingTargetZ = gBallPosZ
                                if (MODE-BATTING-PRACTICE != gGameMode) {
                                    start-script SendClosestFielderToTarget
                                }
                                local2 = 0
                            }
                        }
                    }
                }
            }
        }
    }
}

local-script PlaySoundSynced@2114 arg0 arg1 arg2 {
    if gNetplayActive {
        start-script NetSendSound arg0 arg1 arg2
    }
    start-script.rec PlaySound arg0 arg1 arg2
}

local-script FielderTicksUntilCatch@2115 fielder {
    var pos_x pos_y pos_z vel_x vel_y vel_z local7 local8 gravity local10 local11

    if (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-OUT-OF-PLAY]) {
        return 0
        stop-script 0
    }
    if gBallIsFoul {
        return 0
        stop-script 0
    }
    gravity = 384000 * gGravity / 60
    local8 = call-script smth_kid_data_27_maybe_errors_chance rFieldingOrder[fielder - 37]
    local10 = call-script smth_about_kid_data_maybe_height rFieldingOrder[fielder - 37]
    pos_x = gBallPosPhysX
    pos_y = gBallPosPhysY
    pos_z = gBallPosPhysZ
    vel_x = gBallVelPhysX
    vel_y = gBallVelPhysY
    vel_z = gBallVelPhysZ
    if (line-length.2d (pos_x / 1000) (pos_z / 1000) gWorld[fielder][X] gWorld[fielder][Z] < local8) {
        if (pos_y / 1000 < local10 || (pos_y + vel_y * gVectorScaleNum / gVectorScaleDen) / 1000 < local10) {
            local11 = pos_y / (local10 * 250) + 1
            return local11
        }
    }
    for local7 = 1 to 4 + {
        vel_y -= gravity * gVectorScaleNum / gVectorScaleDen
        pos_y += vel_y * gVectorScaleNum / gVectorScaleDen
        if (pos_y / 1000 < local10) {
            pos_x += vel_x * gVectorScaleNum / gVectorScaleDen
            pos_z += vel_z * gVectorScaleNum / gVectorScaleDen
            if (pos_y <= 0) {
                pos_y = 0
                vel_x = vel_x * gFieldHorizontalBounciness / 100
                vel_z = vel_z * gFieldHorizontalBounciness / 100
                if vel_y {
                    vel_y = abs (vel_y * gFieldVerticalBounciness / 100)
                }
            }
            if (line-length.2d (pos_x / 1000) (pos_z / 1000) gWorld[fielder][X] gWorld[fielder][Z] < local8) {
                if (pos_y / 1000 < local10 || (pos_y + vel_y * gVectorScaleNum / gVectorScaleDen) / 1000 < local10) {
                    local11 = pos_y / (local10 * 250) + 1
                    return local11
                }
            }
        }
    }
    return 0
}

local-script smth_animate_fielder_waiting_for_runner@2116 fielder_actor runneridx {
    break-until (gRunners[runneridx][11] || fielder_actor != gFielderWithBall - 30)
    actor.init fielder_actor
    actor.variable 3 0
    do-animation fielder_actor 27
    break-until (gRunners[runneridx][R-STATE] == R-LEAVE-FIELD-WITH-OUT || fielder_actor != gFielderWithBall - 30 || gRunners[runneridx][R-DEST-BASE] != rCurrentPlay)
    actor.init fielder_actor
    actor.variable 3 1
}

local-script SetBaseCorners@2117 use_defaults {
    var smth_x smth_z base i angle actor

    if use_defaults {
        rBaseCorners[F-HOME] = HOME-PLATE-TOP-LEFT-CORNER
        rBaseCorners[FIRST] = FIRST-BASE-LEFT-CORNER
        rBaseCorners[SECOND] = SECOND-BASE-RIGHT-CORNER
        rBaseCorners[THIRD] = THIRD-BASE-RIGHT-CORNER
    } else {
        if gFielderWithBall {
            smth_x = gWorld[gFielderWithBall][X]
            smth_z = gWorld[gFielderWithBall][Z]
        } else {
            smth_x = gFieldingTargetX
            smth_z = gFieldingTargetZ
        }
        if (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE PE-BASE-ON-BALLS PE-OUT-OF-PLAY]) {
            rBaseCorners[F-HOME] = HOME-PLATE-TOP-RIGHT-CORNER
            rBaseCorners[FIRST] = FIRST-BASE-RIGHT-CORNER
            rBaseCorners[SECOND] = SECOND-BASE-TOP-CORNER
            rBaseCorners[THIRD] = THIRD-BASE-LEFT-CORNER
            stop-script 0
        }
        angle = angle-from-line gWorld[HOME-PLATE-BACK-CORNER][X] gWorld[HOME-PLATE-BACK-CORNER][Z] smth_x smth_z
        case 1 {
            (angle < 90) {
                rBaseCorners[F-HOME] = HOME-PLATE-TOP-RIGHT-CORNER
            }
            (angle < 181) {
                rBaseCorners[F-HOME] = HOME-PLATE-TOP-LEFT-CORNER
            }
            (angle < 271) {
                rBaseCorners[F-HOME] = HOME-PLATE-BOTTOM-LEFT-CORNER
            }
            else {
                rBaseCorners[F-HOME] = HOME-PLATE-BOTTOM-RIGHT-CORNER
            }
        }
        angle = angle-from-line gWorld[FIRST-BASE-RIGHT-CORNER][X] gWorld[FIRST-BASE-RIGHT-CORNER][Z] smth_x smth_z
        case 1 {
            (angle < 46) {
                rBaseCorners[FIRST] = FIRST-BASE-RIGHT-CORNER
            }
            (angle < 141) {
                rBaseCorners[FIRST] = FIRST-BASE-TOP-CORNER
            }
            (angle < 226) {
                rBaseCorners[FIRST] = FIRST-BASE-LEFT-CORNER
            }
            (angle < 316) {
                rBaseCorners[FIRST] = FIRST-BASE-BOTTOM-CORNER
            }
            else {
                rBaseCorners[FIRST] = FIRST-BASE-RIGHT-CORNER
            }
        }
        angle = angle-from-line gWorld[SECOND-BASE-CENTER][X] gWorld[SECOND-BASE-CENTER][Z] smth_x smth_z
        case 1 {
            (angle < 51) {
                rBaseCorners[SECOND] = SECOND-BASE-RIGHT-CORNER
            }
            (angle < 130) {
                rBaseCorners[SECOND] = SECOND-BASE-TOP-CORNER
            }
            (angle < 231) {
                rBaseCorners[SECOND] = SECOND-BASE-LEFT-CORNER
            }
            (angle < 311) {
                rBaseCorners[SECOND] = SECOND-BASE-BOTTOM-CORNER
            }
            else {
                rBaseCorners[SECOND] = SECOND-BASE-RIGHT-CORNER
            }
        }
        angle = angle-from-line gWorld[THIRD-BASE-LEFT-CORNER][X] gWorld[THIRD-BASE-LEFT-CORNER][Z] smth_x smth_z
        case 1 {
            (angle < 51) {
                rBaseCorners[THIRD] = THIRD-BASE-RIGHT-CORNER
            }
            (angle < 136) {
                rBaseCorners[THIRD] = THIRD-BASE-TOP-CORNER
            }
            (angle < 226) {
                rBaseCorners[THIRD] = THIRD-BASE-LEFT-CORNER
            }
            (angle < 321) {
                rBaseCorners[THIRD] = THIRD-BASE-BOTTOM-CORNER
            }
            else {
                rBaseCorners[THIRD] = THIRD-BASE-RIGHT-CORNER
            }
        }
        if gFielderWithBall {
            base = gWorld[gFielderWithBall][TARGET]
            if (base < 0 || base >= 4) {
                stop-script 0
            }
            if (rBaseClaims[base] == gFielderWithBall) {
                for i = 0 to 3 + {
                    if (gRunners[i][R-DEST-BASE] == base || (base == 0 && gRunners[i][R-DEST-BASE] == R-HOME)) {
                        actor = gFielderWithBall - 30
                        do-animation actor 9
                        if (gRunners[i][R-DIRECTION] == FORWARD) {
                            case base {
                                0 {
                                    rBaseCorners[F-HOME] = HOME-PLATE-TOP-LEFT-CORNER
                                }
                                1 {
                                }
                                2 {
                                    rBaseCorners[SECOND] = SECOND-BASE-RIGHT-CORNER
                                }
                                3 {
                                    rBaseCorners[THIRD] = THIRD-BASE-RIGHT-CORNER
                                }
                                else {
                                }
                            }
                        } else {
                            case base {
                                0 {
                                    rBaseCorners[F-HOME] = HOME-PLATE-TOP-LEFT-CORNER
                                }
                                1 {
                                    rBaseCorners[FIRST] = FIRST-BASE-TOP-CORNER
                                }
                                2 {
                                    rBaseCorners[SECOND] = SECOND-BASE-LEFT-CORNER
                                }
                                3 {
                                    rBaseCorners[THIRD] = THIRD-BASE-BOTTOM-CORNER
                                }
                                else {
                                }
                            }
                        }
                        start-script smth_animate_fielder_waiting_for_runner actor i
                    }
                }
            }
        }
    }
}

local-script WatchForFoulBall@2118 {
    var local0 local1 local2 local3 local4 local5

    break-until gBallIsFoul
    break-here
    if (gEnableHumongousVision == 0 || not (in gField [PARKS-DEPARTMENT BIG-CITY-STADIUM SUPER-COLOSSAL-DOME])) {
        local5 = 0
    } else {
        local5 = 1
        case gField {
            PARKS-DEPARTMENT {
                local2 = 264
                local3 = 0
                local4 = 454
            }
            BIG-CITY-STADIUM {
                local2 = 273
                local3 = 0
                local4 = 454 + 1
            }
            else {
                local2 = 270
                local3 = 0
                local4 = 454 + 2
            }
        }
    }
    for local1 = 37 to 45 + {
        gWorld[local1][TARGET-X] = gWorld[local1][X]
        gWorld[local1][TARGET-Z] = gWorld[local1][Z]
        gWorld[local1][TARGET] = NONE
    }
    if rBallWasHitHigh {
        case (random-between 1 5) {
            1 {
                start-script PlaySoundSynced 2011
            }
            2 {
                start-script PlaySoundSynced 2025
            }
            3 {
                start-script PlaySoundSynced 2026
            }
            4 {
                start-script PlaySoundSynced 2027
            }
            5 {
                start-script PlaySoundSynced 2028
            }
            else {
            }
        }
    }
    g_maybe_smth_play_is_alive = 0
    if (local5 == 0) {
        break-until g_maybe_play_is_ready_to_end
        stop-script 0
    }
    override L01c4
    do {
        break-here
        if local5 {
            image.init local4
            image.draw
            image.at local2 local3
            image.state 5
            image.end
            image.init local4
            image.draw
            image.at local2 local3
            image.end
            break-here.multi 10
            image.init local4
            image.draw
            image.at local2 local3
            image.state 6
            image.end
            image.init local4
            image.draw
            image.at local2 local3
            image.end
            break-here.multi 9
            inc local0
        } else {
            break-here.multi 10
        }
    } until (local0 > 3 && g_maybe_play_is_ready_to_end)
    L01c4:
    if g_maybe_skipped_cutscene {
        break-until g_maybe_play_is_ready_to_end
        stop-sound sound2011
    } else {
        override-off
    }
}

local-script WatchForInfieldFly@2119 {
    var local0

    if (call-script DoesInfieldFlyRuleApply) {
        do {
            break-here
            inc local0
        } until (gBallVelPhysY < 384000 * gGravity / 60 || local0 > 40)
        gPlayEndedReason = PE-INFIELD-FLY
        rCaughtFly = true
    }
}

local-script CountDownAutoFieldingDelay@2120 {
    do {
        break-here
        if rAutoFieldeingDelay {
            dec rAutoFieldeingDelay
        }
        if gCollideIntersectValid {
            rAutoFieldeingDelay = 0
        }
    } until (rAutoFieldeingDelay < 1 || (in gUserSelectedPlay [BALL-SHADOW] && gBallHasBounced))
    rAutoFieldeingDelay = 0
}

local-script ClearFielderTarget@2121 idx {
    var target

    target = gWorld[idx][TARGET]
    if (in target [NONE BALL-SHADOW]) {
        stop-script 0
    }
    if (target >= F-HOME && target <= MOUND) {
        rBaseClaims[target] = 0
    }
    gWorld[idx][TARGET] = NONE
}

local-script WatchForFielderTaggingRunnerOut@2122 {
    var i _ _ local3 fielder

    if gNetplayActive {
    }
    do {
        break-until gFielderWithBall
        fielder = gFielderWithBall
        if (not g_maybe_play_is_ready_to_end) {
            local3 = gWorld[fielder][TARGET]
            if (in local3 [0 1 2 3]) {
                if (rBaseClaims[local3] == fielder) {
                    jump L00db
                }
            }
            for i = 0 to 3 + {
                if (gRunners[i][R-DIRECTION] != 0 && gRunners[i][R-STATE] != R-LEAVE-FIELD-WITH-OUT) {
                    if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[gRunners[i][R-ENTITY]][X] gWorld[gRunners[i][R-ENTITY]][Z] < 24) {
                        gRunners[i][R-STATE] = R-LEAVE-FIELD-WITH-OUT
                        if (gUserSelectedPlay == gRunners[i][R-ENTITY]) {
                            gUserSelectedPlay = fielder
                        }
                        break-here
                        start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 5
                    }
                }
            }
        }
        L00db:
        break-here
    } until (not g_maybe_smth_play_is_alive || gBallIsFoul)
}

local-script FielderCollisionLoop@2123 {
    var local0 local1 local2 local3 local4 local5 local6 local7

    if (gDifficulty == HARD) {
        local6 = 2
    } else {
        local6 = 1
    }
    do {
        break-here
        if (local3 > 25) {
            local3 = 0
            break-here.multi 80
        }
        if local2 {
            dec local2
        }
        for local0 = 37 to 44 + {
            for local1 = (local0 + 1) to 45 + {
                if (line-length.2d gWorld[local0][X] gWorld[local0][Z] gWorld[local1][X] gWorld[local1][Z] < 36) {
                    if (actor-get-variable (local0 - 30) 2 == 0) {
                        if (actor-get-variable (local1 - 30) 2 == 0) {
                            inc local3
                            for local5 = {local7}[local0 local1] {
                                local4 = 0
                                if (not (random local6)) {
                                    if (random 100 > gKidData[rFieldingOrder[local5 - 37]][KD-COORDINATION]) {
                                        if (rFieldingOrder[local5 - 37] != KENNY-KAWAGUCHI) {
                                            local4 = 1
                                            actor.init (local5 - 30)
                                            actor.variable 2 1
                                            if (local5 == rBallFetcher) {
                                                rBallFetcher = 0
                                            }
                                            if (not local2) {
                                                start-script EnqueueComment DIALOGUE-FIELDER-COLLISION 0
                                            }
                                            local2 = 100
                                            start-script AddFatigue rFieldingOrder[local5 - 37] 29
                                        }
                                    }
                                }
                                if (not local4) {
                                    if (local5 != gFielderWithBall) {
                                        actor.init (local5 - 30)
                                        actor.variable 2 2
                                    } else {
                                        actor.init (local5 - 30)
                                        actor.variable 2 0
                                    }
                                }
                                if (sound-running sound2007 + sound-running sound2008 + sound-running sound2009 == 0) {
                                    temp = random 2
                                    start-script PlaySoundSynced (2007 + temp)
                                }
                            }
                        }
                    }
                }
            }
        }
    } until (not g_maybe_smth_play_is_alive)
}

local-script smth_maybe_fielder_adjust_target@2124 fielder {
    var target_x target_z local3 local4 local5 angle6 angle7 angle8

    if (gWorld[fielder][TARGET] != NONE) {
        stop-script 0
    }
    local5 = 300
    target_x = gWorld[fielder][TARGET-X]
    target_z = gWorld[fielder][TARGET-Z]
    if gFielderWithBall {
        if (rCurrentPlay != NONE && rCurrentPlay != fielder) {
            if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[gFielderWithBall][X] gWorld[gFielderWithBall][Z] < 360) {
                if (target_x == gWorld[fielder][TARGET-X] && target_z == gWorld[fielder][TARGET-Z]) {
                    if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[gFielderWithBall][X] gWorld[gFielderWithBall][Z] < line-length.2d gWorld[gFielderWithBall][X] gWorld[gFielderWithBall][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]) {
                        angle6 = angle-from-line gWorld[gFielderWithBall][X] gWorld[gFielderWithBall][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]
                        angle7 = angle-from-line gWorld[gFielderWithBall][X] gWorld[gFielderWithBall][Z] target_x target_z
                        angle8 = call-script AngleDifference angle6 angle7
                        if (angle8 < 15) {
                            if (random 1) {
                                angle8 = angle6 + 90
                            } else {
                                angle8 = angle6 - 90
                            }
                            gWorld[fielder][TARGET-X] = gWorld[fielder][X] + cos angle8 * 48 / 100000
                            gWorld[fielder][TARGET-Z] = gWorld[fielder][Z] + sin angle8 * 48 / 100000
                        }
                    }
                }
            }
        }
    }
    L0180:
    if (target_x > gWorld[THIRD-BASE-LEFT-CORNER][X]) {
        if (target_x < gWorld[SECOND-BASE-CENTER][X]) {
            if (target_z > gWorld[THIRD-BASE-LEFT-CORNER][Z]) {
                local3 = gWorld[THIRD-BASE-LEFT-CORNER][Z] + (target_x - gWorld[THIRD-BASE-LEFT-CORNER][X])
            } else {
                local3 = gWorld[THIRD-BASE-LEFT-CORNER][Z] - (target_x - gWorld[THIRD-BASE-LEFT-CORNER][X])
            }
        } else if (target_x < gWorld[FIRST-BASE-RIGHT-CORNER][X]) {
            if (target_z > gWorld[FIRST-BASE-RIGHT-CORNER][Z]) {
                local3 = gWorld[FIRST-BASE-RIGHT-CORNER][Z] - (target_x - gWorld[FIRST-BASE-RIGHT-CORNER][X])
            } else {
                local3 = gWorld[FIRST-BASE-RIGHT-CORNER][Z] + (target_x - gWorld[FIRST-BASE-RIGHT-CORNER][X])
            }
        } else {
            stop-script 0
        }
        if (fielder != FIELDER-PITCHER) {
            if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[MOUND-CENTER][X] gWorld[MOUND-CENTER][Z] < 80) {
                if (target_x > 0) {
                    gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] + random-between 12 18
                } else {
                    gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] - random-between 12 18
                }
                if (target_z > 852) {
                    gWorld[fielder][TARGET-Z] = gWorld[fielder][TARGET-Z] + random-between 12 18
                } else {
                    gWorld[fielder][TARGET-Z] = gWorld[fielder][TARGET-Z] - random-between 12 18
                }
            }
        }
    } else {
        stop-script 0
    }
    local4 = abs (target_z - local3)
    if (local4 < local5) {
        if (target_z < local3) {
            gWorld[fielder][TARGET-Z] = gWorld[fielder][TARGET-Z] - random-between 12 18
            if (target_x < gWorld[SECOND-BASE-CENTER][X]) {
                if (target_z < gWorld[THIRD-BASE-LEFT-CORNER][Z]) {
                    gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] - random-between 12 18
                } else {
                    gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] + random-between 12 18
                }
            } else if (target_z < gWorld[FIRST-BASE-RIGHT-CORNER][Z]) {
                gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] + random-between 12 18
            } else {
                gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] - random-between 12 18
            }
        } else {
            gWorld[fielder][TARGET-Z] = gWorld[fielder][TARGET-Z] + 12
            if (target_x < gWorld[SECOND-BASE-CENTER][X]) {
                if (target_z < gWorld[THIRD-BASE-LEFT-CORNER][Z]) {
                    gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] + random-between 12 18
                } else {
                    gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] - random-between 12 18
                }
            } else if (target_z < gWorld[FIRST-BASE-RIGHT-CORNER][Z]) {
                gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] - random-between 12 18
            } else {
                gWorld[fielder][TARGET-X] = gWorld[fielder][TARGET-X] + random-between 12 18
            }
        }
        target_x = gWorld[fielder][TARGET-X]
        target_z = gWorld[fielder][TARGET-Z]
        jump L0180
    }
}

local-script IfBallIsNotCaughtAwardAnError@2125 arg0 {
    var local1

    break-until (gBallHasBounced || g_maybe_last_fielder_to_touch_ball)
    break-here.multi 3
    if (in gPlayEndedReason [164 163]) {
        stop-script 0
    }
    if (g_maybe_last_fielder_to_touch_ball == 0) {
        if gBallIsFoul {
            stop-script 0
        } else {
            start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT-ERROR rFieldingOrder[arg0 - 37]
            local1 = rFieldingOrder[arg0 - 37]
            if gNetplayActive {
                if (g_net_smth_master == g_net_smth_me) {
                    start-script AddNetStat local1 STAT-ERRORS 1
                    start-script AddStat local1 STAT-ERRORS 1
                }
            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                start-script AddStat local1 STAT-ERRORS 1
            }
            start-script PlayKidEmoteSound rFieldingOrder[arg0 - 37] 2
            start-script SetCurrentEmote 4
        }
    }
}

local-script smth_override_other_fielder_at_base@2126 fielder base primary {
    var other other_time self_time i maybe_is_runner_nearby_base

    if (rCurrentPlay == base && gFielderWithBall == 0) {
        maybe_is_runner_nearby_base = 1
    } else if gRunners {
        if (not g_maybe_play_is_ready_to_end) {
            if (in base [1 2 3]) {
                for i = 0 to 3 + {
                    if (in gRunners[i][R-CUR-BASE] [(base - 1) base] && gRunners[i][R-DIRECTION] != 0) {
                        maybe_is_runner_nearby_base = 1
                    }
                }
            } else {
                for i = 0 to 3 + {
                    if (in gRunners[i][R-CUR-BASE] [THIRD R-HOME] && gRunners[i][R-DIRECTION] != 0) {
                        maybe_is_runner_nearby_base = 1
                    }
                }
            }
        }
    }
    other = rBaseClaims[base]
    if (other == 0) {
        start-script ClearFielderTarget fielder
        rBaseClaims[base] = 0 - fielder
        gWorld[fielder][TARGET-X] = gWorld[rBaseCorners[base]][X]
        gWorld[fielder][TARGET-Z] = gWorld[rBaseCorners[base]][Z]
        gWorld[fielder][TARGET] = base
        return 0
    } else if (other < 0) {
        other = abs other
        if maybe_is_runner_nearby_base {
            other_time = call-script CalcFielderTimeRunToPoint other gWorld[rBaseCorners[base]][X] gWorld[rBaseCorners[base]][Z] 1
            self_time = call-script CalcFielderTimeRunToPoint fielder gWorld[rBaseCorners[base]][X] gWorld[rBaseCorners[base]][Z] 1
            if (other_time > 10) {
                self_time = call-script CalcFielderTimeRunToPoint fielder gWorld[rBaseCorners[base]][X] gWorld[rBaseCorners[base]][Z] 1
                if (self_time + 5 < other_time) {
                    start-script ClearFielderTarget fielder
                    rBaseClaims[base] = 0 - fielder
                    gWorld[fielder][TARGET-X] = gWorld[rBaseCorners[base]][X]
                    gWorld[fielder][TARGET-Z] = gWorld[rBaseCorners[base]][Z]
                    gWorld[fielder][TARGET] = base
                    gWorld[other][TARGET] = NONE
                    gWorld[other][TARGET-X] = gWorld[other][X]
                    gWorld[other][TARGET-Z] = gWorld[other][Z]
                    return 0
                    stop-script 0
                }
            }
        } else if primary {
            start-script ClearFielderTarget fielder
            rBaseClaims[base] = 0 - fielder
            gWorld[fielder][TARGET-X] = gWorld[rBaseCorners[base]][X]
            gWorld[fielder][TARGET-Z] = gWorld[rBaseCorners[base]][Z]
            gWorld[fielder][TARGET] = base
            gWorld[other][TARGET] = NONE
            gWorld[other][TARGET-X] = gWorld[other][X]
            gWorld[other][TARGET-Z] = gWorld[other][Z]
            return 0
            stop-script 0
        }
    } else {
        if (other == gFielderWithBall) {
            return 1
            stop-script 0
        }
        if (primary == true && maybe_is_runner_nearby_base == 0) {
            start-script ClearFielderTarget fielder
            rBaseClaims[base] = 0 - fielder
            gWorld[fielder][TARGET-X] = gWorld[rBaseCorners[base]][X]
            gWorld[fielder][TARGET-Z] = gWorld[rBaseCorners[base]][Z]
            gWorld[fielder][TARGET] = base
            gWorld[other][TARGET] = NONE
            gWorld[other][TARGET-X] = gWorld[other][X]
            gWorld[other][TARGET-Z] = gWorld[other][Z]
            gBases[base][BASE-TAGGED-WITH-BALL] = false
            return 0
            stop-script 0
        }
    }
    return 1
}

local-script smth_fielding_outfield@2127 fielder {
    if (fielder == rBallFetcher) {
        if gFielderWithBall {
            rBallFetcher = 0
            gWorld[fielder][TARGET] = NONE
            rAutoFieldeingDelay = 0
        } else {
            if (rAutoFieldeingDelay < 1) {
                start-script SendClosestFielderToTarget
                gWorld[fielder][TARGET-X] = gBallPosX
                gWorld[fielder][TARGET-Z] = gBallPosZ
                gWorld[fielder][TARGET] = BALL-SHADOW
            } else if (gBallHasBounced == 0 && g_maybe_last_fielder_to_touch_ball == 0) {
                if (not (script-running IfBallIsNotCaughtAwardAnError)) {
                    start-script IfBallIsNotCaughtAwardAnError fielder
                }
            }
            stop-script 0
        }
    }
    if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gFieldingTargetX gFieldingTargetZ < 600 && gFielderWithBall == 0) {
        if (gUserSelectedPlay != fielder) {
            gWorld[fielder][TARGET] = BALL-SHADOW
        }
    } else {
        case fielder {
            FIELDER-LF {
                gWorld[fielder][TARGET-X] = gStartPos_LF_X
                gWorld[fielder][TARGET-Z] = gStartPos_LF_Z
            }
            FIELDER-CF {
                gWorld[fielder][TARGET-X] = gStartPos_CF_X
                gWorld[fielder][TARGET-Z] = gStartPos_CF_Z
            }
            FIELDER-RF {
                gWorld[fielder][TARGET-X] = gStartPos_RF_X
                gWorld[fielder][TARGET-Z] = gStartPos_RF_Z
            }
            else {
            }
        }
    }
}

local-script smth_to_do_with_fielding_sometimes_infield@2128 fielder {
    var target

    if (not rBaseClaims) {
        stop-script 0
    }
    if (gBallIsFoul || in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-OUT-OF-PLAY]) {
        stop-script 0
    }
    target = gWorld[fielder][TARGET]
    if (fielder == FIELDER-PITCHER) {
        if (target != NONE) {
            if g_maybe_play_is_ready_to_end {
                if (target == MOUND || rCurrentPlay == target) {
                    stop-script 0
                }
                start-script.rec ClearFielderTarget FIELDER-PITCHER
                gWorld[fielder][TARGET] = MOUND
                rBaseClaims[MOUND] = 0 - fielder
                gWorld[fielder][TARGET-X] = gWorld[MOUND-CENTER][X]
                gWorld[fielder][TARGET-Z] = gWorld[MOUND-CENTER][Z]
            } else if (target != MOUND) {
                stop-script 0
            }
        }
    }
    if (fielder == rBallFetcher) {
        if gFielderWithBall {
            rBallFetcher = 0
            if (target == BALL-SHADOW) {
                gWorld[fielder][TARGET] = NONE
            }
            rAutoFieldeingDelay = 0
        } else {
            if (rAutoFieldeingDelay < 1) {
                start-script SendClosestFielderToTarget
                gWorld[fielder][TARGET-X] = gBallPosX
                gWorld[fielder][TARGET-Z] = gBallPosZ
                gWorld[fielder][TARGET] = BALL-SHADOW
            } else if (gBallHasBounced == 0 && g_maybe_last_fielder_to_touch_ball == 0) {
                if (not (script-running IfBallIsNotCaughtAwardAnError)) {
                    start-script IfBallIsNotCaughtAwardAnError fielder
                }
            }
            stop-script 0
        }
    }
    case fielder {
        FIELDER-1B {
            if (call-script smth_override_other_fielder_at_base fielder 1 true) {
                start-script.rec smth_maybe_fielder_adjust_target fielder
            }
        }
        FIELDER-2B {
            if (call-script smth_override_other_fielder_at_base fielder 2 true) {
                start-script.rec smth_maybe_fielder_adjust_target fielder
            }
        }
        FIELDER-SS {
            if (call-script smth_override_other_fielder_at_base fielder 2) {
                start-script.rec smth_maybe_fielder_adjust_target fielder
            }
        }
        FIELDER-3B {
            if (call-script smth_override_other_fielder_at_base fielder 3 true) {
                if (call-script smth_override_other_fielder_at_base fielder 0) {
                    start-script.rec smth_maybe_fielder_adjust_target fielder
                }
            }
        }
        FIELDER-CACTHER {
            if (call-script smth_override_other_fielder_at_base fielder 0 true) {
                start-script.rec smth_maybe_fielder_adjust_target fielder
            }
        }
        FIELDER-PITCHER {
            if g_maybe_play_is_ready_to_end {
                if (rBaseClaims[MOUND] == 0) {
                    start-script.rec ClearFielderTarget FIELDER-PITCHER
                    rBaseClaims[MOUND] = 0 - 45
                    gWorld[fielder][TARGET-X] = gWorld[MOUND-CENTER][X]
                    gWorld[fielder][TARGET-Z] = gWorld[MOUND-CENTER][Z]
                    gWorld[fielder][TARGET] = MOUND
                }
            } else {
                if (rCurrentPlay == MOUND) {
                    stop-script 0
                }
                if gStealing {
                    stop-script 0
                }
                if (call-script smth_override_other_fielder_at_base fielder 1) {
                    if (call-script smth_override_other_fielder_at_base fielder 3) {
                        if (call-script smth_override_other_fielder_at_base fielder 0) {
                            start-script.rec smth_maybe_fielder_adjust_target fielder
                        }
                    }
                }
            }
        }
        else {
        }
    }
}

local-script smth_about_baserunner_distance@2129 runneridx x z arg3 {
    var local4 local5 local6 local7 speed

    local4 = gRunners[runneridx][R-ENTITY]
    local5 = gWorld[local4][X]
    local6 = gWorld[local4][Z]
    local7 = line-length.2d local5 local6 x z
    if arg3 {
        speed = call-script GetKidRunningSpeed gRunners[runneridx][R-KID]
    } else {
        speed = 10
    }
    return (local7 / speed)
}

local-script CalcFielderTimeRunToPoint@2130 fielder x z arg3 arg4 {
    var speed dist local7

    if arg3 {
        speed = call-script GetKidRunningSpeed rFieldingOrder[fielder - 37]
        dist = line-length.2d x z gWorld[fielder][X] gWorld[fielder][Z]
        if (not arg4) {
            local7 = call-script smth_kid_data_3_with_fatigue rFieldingOrder[fielder - 37]
        }
    } else {
        speed = 9
        dist = line-length.2d x z gWorld[fielder][X] gWorld[fielder][Z]
        if (not arg4) {
            local7 = 10
        }
    }
    if (dist < speed) {
        return 0
    } else {
        return (dist / speed + local7)
    }
}

local-script SendClosestFielderToTarget@2131 immediate {
    var i fielder min_time _ _ time _ previous

    if gFielderWithBall {
        stop-script 0
    }
    min_time = 100000
    for i = FIELDER-LF to FIELDER-PITCHER + {
        if (actor-get-variable (i - 30) 2 == 0) {
            time = call-script CalcFielderTimeRunToPoint i gFieldingTargetX gFieldingTargetZ
            if (time < min_time) {
                fielder = i
                min_time = time
            }
        }
    }
    previous = rBallFetcher
    rBallFetcher = fielder
    if immediate {
        rAutoFieldeingDelay = 0
        gWorld[fielder][TARGET-X] = gBallPosX
        gWorld[fielder][TARGET-Z] = gBallPosZ
    } else {
        if (in gUserSelectedPlay [LAST-CLICK-FIELDING BALL-SHADOW]) {
            rAutoFieldeingDelay = 1000
        } else {
            rAutoFieldeingDelay = min_time
        }
        start-script CountDownAutoFieldingDelay
        gWorld[fielder][TARGET-X] = gFieldingTargetX
        gWorld[fielder][TARGET-Z] = gFieldingTargetZ
    }
    start-script ClearFielderTarget fielder
    gWorld[fielder][TARGET] = BALL-SHADOW
    start-script DrawNameUnderFielder fielder
    if (fielder != previous) {
        if (previous > 0) {
            if (actor-get-variable (previous - 30) 2 == 0) {
                do-animation (previous - 30) 6
            }
            gWorld[previous][TARGET-X] = gWorld[previous][X]
            gWorld[previous][TARGET-Z] = gWorld[previous][Z]
            if (gWorld[previous][TARGET] == BALL-SHADOW) {
                gWorld[previous][TARGET] = NONE
            }
        }
    }
}

local-script FindClosestFielder@2132 x z {
    var i local3 local4 result

    local4 = 60000
    for i = 37 to 45 + {
        if (i != gFielderWithBall) {
            local3 = line-length.2d x z gWorld[i][X] gWorld[i][Z]
            if (local3 < local4) {
                local4 = local3
                result = i
            }
        }
    }
    return result
}

local-script smth_data_for_fielder_with_errors_and_bounciness@2133 fielder {
    var local1 local2 local3 local4

    local1 = call-script smth_kid_data_5_maybe_errors_chance_with_fatigue rFieldingOrder[fielder - 37]
    local2 = sin 45 * local1 / 100
    local3 = 2 * local2 / (384000 * gGravity / 60)
    if (local3 < 1) {
        local3 = 1
    }
    local4 = local2 * local3 / 1000
    local4 += gFieldHorizontalBounciness * local4 / 100
    return local4
}

local-script BestInfieldThrowTarget@2134 fielder {
    var local1 local2 other cost min_cost result dist_fielder_other dist_other_target

    if (rCurrentPlay == MOUND) {
        local1 = 780
    } else {
        local1 = call-script smth_data_for_fielder_with_errors_and_bounciness fielder
    }
    local2 = line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]
    min_cost = 60000
    result = NONE
    if (local2 > local1) {
        if (rCurrentPlay == MOUND) {
            local1 = local2
        }
        for other = FIELDER-3B to FIELDER-PITCHER + {
            if (other != fielder) {
                dist_fielder_other = line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[other][X] gWorld[other][Z]
                if (dist_fielder_other < local1) {
                    dist_other_target = line-length.2d gWorld[other][X] gWorld[other][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]
                    cost = dist_fielder_other + dist_other_target
                    if (cost < min_cost) {
                        result = other
                        min_cost = cost
                    }
                }
            }
        }
    }
    return result
}

local-script DistanceToBall2D@2135 entity {
    return (line-length.2d gWorld[entity][X] gWorld[entity][Z] gBallPosX gBallPosZ)
}

local-script maybe_smth_distance_2d_ahead_ball@2136 entity {
    var local1 local2

    local1 = (gBallPosPhysX + gBallVelPhysX) / 1000
    local2 = (gBallPosPhysZ + gBallVelPhysZ) / 1000
    return (line-length.2d gWorld[entity][X] gWorld[entity][Z] local1 local2)
}

local-script maybe_smth_angle_2d_ahead_ball@2137 entity {
    var local1 local2 local3

    local1 = (gBallPosPhysX + gBallVelPhysX) / 1000
    local2 = (gBallPosPhysZ + gBallVelPhysZ) / 1000
    local3 = angle-from-line gWorld[entity][X] gWorld[entity][Z] local1 local2
    return local3
}

local-script smth_distance_concerning_fielding@2138 fielder x1 z1 x2 z2 {
    var local5 local6 local7 local8 local9 local10 local11 local12 angle13 local14

    local5 = call-script smth_kid_data_5_maybe_errors_chance_with_fatigue rFieldingOrder[fielder - 37]
    local6 = sin 45 * local5 / 100
    local7 = 2 * local6 / (384000 * gGravity / 60)
    if (local7 < 1) {
        local7 = 1
    }
    local10 = local6 * local7 / 1000
    if (x2 != 0 || z2 != 0) {
        local11 = line-length.2d x2 z2 x1 z1
        local8 = x1 - x2
        local9 = z1 - z2
    } else {
        local11 = line-length.2d gWorld[fielder][X] gWorld[fielder][Z] x1 z1
        local8 = x1 - gWorld[fielder][X]
        local9 = z1 - gWorld[fielder][Z]
    }
    if (local10 < local11) {
        local14 = sin 45 * local5 / 100
    } else {
        local12 = local5
        if (x2 != 0 || z2 != 0) {
            angle13 = call-script smth_vector_math_gravity_angle x2 z2 x1 z1 local12
        } else {
            angle13 = call-script smth_vector_math_gravity_angle gWorld[fielder][X] gWorld[fielder][Z] x1 z1 local12
        }
        local14 = sin angle13 * local12 / 100
    }
    local7 = 2 * local14 / (384000 * gGravity / 60)
    if (local7 < 1) {
        local7 = 1
    }
    if (local10 < local11) {
        local7 = local7 * local11 / local10
    }
    local7 = local7 * gVectorScaleDen / gVectorScaleNum
    return local7
}

local-script FielderThrow@2139 fielder to_x to_z smth_facing {
    var smth_kid_data_5 local5 local6 delta_x delta_z local9 adjusted_distance local11 angle_y accuracy local14 local15 exact_distance from_x from_z hand i local21 adjust

    if (rCurrentPlay <= MOUND) {
        rBallThrownToFielder = rBaseClaims[rCurrentPlay]
    } else {
        rBallThrownToFielder = rCurrentPlay
    }
    if (rCurrentPlay == MOUND || (g_maybe_play_is_ready_to_end && rCurrentPlay == FIELDER-PITCHER)) {
        accuracy = 100
    } else {
        accuracy = call-script smth_about_kid_data_6_and_errors rFieldingOrder[fielder - 37]
    }
    smth_kid_data_5 = call-script smth_kid_data_5_maybe_errors_chance_with_fatigue rFieldingOrder[fielder - 37]
    local5 = sin 45 * smth_kid_data_5 / 100
    local6 = 2 * local5 / (384000 * gGravity / 60)
    if (local6 < 1) {
        local6 = 1
    }
    local9 = local5 * local6 / 1000
    from_x = gWorld[fielder][X]
    from_z = gWorld[fielder][Z]
    if (band gKidData[rFieldingOrder[fielder - 37]][KD-HANDEDNESS] 3 == 1) {
        hand = 1
    } else {
        hand = -1
    }
    case smth_facing {
        1 {
            from_z -= 12 * hand
            from_x += 10
        }
        2 {
            from_z -= 10 * hand
            from_x += 4 * hand
            from_x += 10
            from_z += 8
        }
        3 {
            from_z -= 8 * hand
            from_x += 8 * hand
            from_x += 8
            from_z += 8
        }
        4 {
            from_z -= 4 * hand
            from_x += 10 * hand
            from_x += 8
            from_z += 10
        }
        5 {
            from_x += 12 * hand
            from_z += 10
        }
        6 {
            from_x += 10 * hand
            from_z += 4 * hand
            from_x -= 8
            from_z += 10
        }
        7 {
            from_x += 8 * hand
            from_z += 8 * hand
            from_x -= 8
            from_z += 8
        }
        8 {
            from_x += 4 * hand
            from_z += 10 * hand
            from_x -= 10
            from_z += 8
        }
        9 {
            from_z += 12 * hand
            from_x -= 10
        }
        10 {
            from_x -= 4 * hand
            from_z += 10 * hand
            from_x -= 10
            from_z -= 8
        }
        11 {
            from_x -= 8 * hand
            from_z += 8 * hand
            from_x -= 10
            from_z -= 8
        }
        12 {
            from_x -= 10 * hand
            from_z += 4 * hand
            from_x -= 8
            from_z -= 10
        }
        13 {
            from_x -= 12 * hand
            from_z -= 10
        }
        14 {
            from_x -= 10 * hand
            from_z -= 4 * hand
            from_x += 8
            from_z -= 10
        }
        15 {
            from_x -= 8 * hand
            from_z -= 8 * hand
            from_x += 8
            from_z -= 8
        }
        16 {
            from_x -= 4 * hand
            from_z -= 10 * hand
            from_x += 10
            from_z -= 8
        }
        else {
        }
    }
    if (not rRunnersWhenBallLastThrown) {
        dim-array-2d.i16 rRunnersWhenBallLastThrown 3 20
    }
    array-assign-slice rRunnersWhenBallLastThrown gRunners 0 3 0 11 0 3 0 11
    exact_distance = line-length.2d from_x from_z to_x to_z
    local21 = exact_distance / 36
    adjust = random-between (0 - local21) local21 * (100 - accuracy) / 100
    to_x += adjust
    adjust = random-between (0 - local21) local21 * (100 - accuracy) / 100
    to_z += adjust
    adjusted_distance = line-length.2d from_x from_z to_x to_z
    delta_x = to_x - from_x
    delta_z = to_z - from_z
    case 1 {
        (adjusted_distance < 120) {
            local11 = 58
        }
        (adjusted_distance < 240) {
            local11 = 72
        }
        (adjusted_distance < 360) {
            local11 = 84
        }
        (adjusted_distance < 480) {
            local11 = 92
        }
        (adjusted_distance < 600) {
            local11 = 98
        }
        (adjusted_distance < 720) {
            local11 = 113
        }
        (adjusted_distance < 840) {
            local11 = 120
        }
        (adjusted_distance < 960) {
            local11 = 127
        }
        (adjusted_distance < 1080) {
            local11 = 133
        }
        (adjusted_distance < 1200) {
            local11 = 140
        }
        (adjusted_distance < 1320) {
            local11 = 146
        }
        (adjusted_distance < 1440) {
            local11 = 151
        }
        (adjusted_distance < 1560) {
            local11 = 155
        }
        (adjusted_distance < 1680) {
            local11 = 158
        }
        (adjusted_distance < 1800) {
            local11 = 160
        }
        else {
            local11 = 165
        }
    }
    smth_kid_data_5 += 20
    if (smth_kid_data_5 > 150) {
        local11 += local11 * ((gKidData[rFieldingOrder[fielder - 37]][KD-ARM] - 50) / 2) / 100
    }
    if (local11 > smth_kid_data_5) {
        local11 = smth_kid_data_5
    }
    smth_kid_data_5 -= 20
    local11 -= 20
    angle_y = call-script smth_vector_math_gravity_angle gWorld[fielder][X] gWorld[fielder][Z] to_x to_z local11
    temp = call-script SetBallAnimation 3 -1 -1 -1
    gBallVelPhysY = sin angle_y * local11 / 100
    local6 = 2 * gBallVelPhysY / (384000 * gGravity / 60)
    if (gKidData[rFieldingOrder[fielder - 37]][KD-HEIGHT] > 3) {
        inc local6
    }
    if (local6 < 1) {
        local6 = 1
    }
    if (in rCurrentPlay [F-HOME FIRST SECOND THIRD]) {
        if (random-between 5 90 < call-script smth_about_kid_data_12_with_fatigue rFieldingOrder[fielder - 37]) {
            for i = 0 to 3 + {
                if (gRunners[i][R-DEST-BASE] == rCurrentPlay || (gRunners[i][R-DEST-BASE] == R-HOME && rCurrentPlay == F-HOME)) {
                    if (call-script smth_about_baserunner_distance i to_x to_z 1 < local6 * gVectorScaleDen / gVectorScaleNum) {
                        if (local11 < smth_kid_data_5) {
                            angle_y = call-script smth_vector_math_gravity_angle gWorld[fielder][X] gWorld[fielder][Z] to_x to_z smth_kid_data_5
                            gBallVelPhysY = sin angle_y * smth_kid_data_5 / 100
                            local6 = 2 * gBallVelPhysY / (384000 * gGravity / 60)
                            if (local6 < 1) {
                                local6 = 1
                            }
                            if (call-script smth_about_baserunner_distance i to_x to_z 1 < local6 * gVectorScaleDen / gVectorScaleNum) {
                                angle_y = call-script smth_vector_math_gravity_angle gWorld[fielder][X] gWorld[fielder][Z] to_x to_z local11
                                gBallVelPhysY = sin angle_y * local11 / 100
                                local6 = 2 * gBallVelPhysY / (384000 * gGravity / 60)
                                if (local6 < 1) {
                                    local6 = 1
                                }
                            } else {
                                local11 = smth_kid_data_5
                                if (random 90 > accuracy) {
                                    angle_y += random-between 1 5
                                    gBallVelPhysY = sin angle_y * local11 / 100
                                }
                            }
                        }
                    }
                    i = 49
                }
            }
        }
    }
    if (local9 < adjusted_distance) {
        if (not (call-script RandomBasedOnKidData rFieldingOrder[fielder - 37] KD-COORDINATION (gDefenseControlledBy == CB-COMPUTER))) {
            if (random 100 > 85) {
                if (random 1) {
                    gBallVelPhysY = sin (random-between 45 85) * smth_kid_data_5 / 200
                } else {
                    gBallVelPhysY = sin (random-between 290 335) * smth_kid_data_5 / 100
                }
                gBallVelPhysX = random-between 20 500 * (local9 * delta_x / (adjusted_distance * local6))
                gBallVelPhysZ = random-between 20 500 * (local9 * delta_z / (adjusted_distance * local6))
                start-script EnqueueComment DIALOGUE-RUNNER-THROW-ERROR rFieldingOrder[fielder - 37]
                start-script SetCurrentEmote 4
            } else {
                gBallVelPhysX = 1000 * (local9 * delta_x / (adjusted_distance * local6))
                gBallVelPhysZ = 1000 * (local9 * delta_z / (adjusted_distance * local6))
                angle_y += random-between -5 5
                gBallVelPhysY = sin angle_y * local11 / 100
            }
        } else {
            gBallVelPhysX = 1000 * (local9 * delta_x / (adjusted_distance * local6))
            gBallVelPhysZ = 1000 * (local9 * delta_z / (adjusted_distance * local6))
            if (MOUND != rCurrentPlay) {
                if (not (call-script RandomBasedOnKidData rFieldingOrder[fielder - 37] KD-COORDINATION (gDefenseControlledBy == CB-COMPUTER))) {
                    angle_y += random-between -5 5
                    gBallVelPhysY = sin angle_y * local11 / 100
                } else if (in gField [CEMENT-GARDENS TIN-CAN-ALLEY]) {
                    angle_y -= 15
                    if (angle_y < 10) {
                        angle_y = 10
                    }
                }
            }
        }
        start-script AddFatigue rFieldingOrder[fielder - 37] 32
    } else {
        gBallVelPhysX = 1000 * (delta_x / local6)
        gBallVelPhysZ = 1000 * (delta_z / local6)
        if (rCurrentPlay != MOUND) {
            if (call-script RandomBasedOnKidData rFieldingOrder[fielder - 37] KD-COORDINATION (gDefenseControlledBy == CB-COMPUTER)) {
                angle_y += random-between -5 5
                gBallVelPhysY = sin angle_y * local11 / 100
            }
        }
        if (smth_kid_data_5 == local11) {
            start-script AddFatigue rFieldingOrder[fielder - 37] 33
        } else {
            start-script AddFatigue rFieldingOrder[fielder - 37] 34
        }
    }
    case 1 {
        (local11 > 150) {
            start-script PlaySoundSynced 2006
        }
        (local11 > 80) {
            if (random 1) {
                start-script PlaySoundSynced 2004
            } else {
                start-script PlaySoundSynced 2005
            }
        }
        else {
            if (random 1) {
                start-script PlaySoundSynced 2002
            } else {
                start-script PlaySoundSynced 2003
            }
        }
    }
    gBallPosPhysX = from_x * 1000 + 2 * gBallVelPhysX * gVectorScaleNum / gVectorScaleDen
    gBallPosX = gBallPosPhysX / 1000
    gBallPosPhysZ = from_z * 1000 + 2 * gBallVelPhysZ * gVectorScaleNum / gVectorScaleDen
    gBallPosZ = gBallPosPhysZ / 1000
    gBallPosPhysY = (gKidData[rFieldingOrder[fielder - 37]][KD-HEIGHT] - 1) * 15000 + 35000
    gBallPosY = gBallPosPhysY / 1000
    gBallVelPhysY -= 2 * (384000 * gGravity / 60) * gVectorScaleNum / gVectorScaleDen
    start-script SimulateBallStopPosition true
    gFielderWithBall = 0
    break-here
    if (line-length.2d from_x from_z gFieldingTargetX gFieldingTargetZ < exact_distance * 5 / 4) {
        break-until (gBallPosPhysY < 36000)
    } else {
        do {
            break-here
            local15 = line-length.2d gWorld[BALL-SHADOW][X] gWorld[BALL-SHADOW][Z] from_x from_z
            if (local15 > exact_distance || gFielderWithBall) {
                local14 = 1
            }
        } until local14
    }
    rBallThrownToFielder = 0
    break-here
    if (not gFielderWithBall) {
        if local14 {
            start-script.rec WatchAwardErrorAfterThrow fielder
            if (random 3) {
                start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 2
            }
            start-script SetCurrentEmote 4
            rCurrentPlay = NONE
        }
        start-script.rec SendClosestFielderToTarget true
    }
}

local-script SetSensibleNextPlay@2140 fielder _ {
    var local2 local3 i j local6 local7 local8 local9 local10 local11 smth_stat_12

    if (gNumOuts > 2 || not gNumRunners) {
        rCurrentPlay = NONE
        stop-script 0
    }
    if (g_maybe_play_is_ready_to_end || in gPlayEndedReason [PE-INFIELD-FLY]) {
        rCurrentPlay = MOUND
        stop-script 0
    }
    if (gDifficulty == EASY && gDefenseControlledBy == CB-USER || (gDifficulty == HARD && gDefenseControlledBy == CB-COMPUTER)) {
        local7 = 100
    } else {
        local7 = call-script smth_about_kid_data_2_and_errors rFieldingOrder[fielder - 37]
    }
    if (local7 < 40) {
        if (random (local7 * 10) < 1) {
            if (random 100 < 50) {
                rCurrentPlay = NONE
            } else if (random 100 < 70) {
                rCurrentPlay = FIRST
            } else if (random 2) {
                rCurrentPlay = F-HOME
            } else {
                rCurrentPlay = random-between 2 3
            }
            stop-script 0
        }
    }
    smth_stat_12 = call-script smth_about_kid_data_12_with_fatigue rFieldingOrder[fielder - 37]
    dim-array-2d.i16 local3 3 3
    localize local3
    if (rCaughtFly && r_smth_fly_caught_runners_must_return) {
        local3[0][0] = 999
        for i = 1 to 3 + {
            local3[i][0] = 999
            for j = 0 to 3 + {
                if (rRunnerStartingBases[j] == i) {
                    if (gRunners[j][R-DIRECTION] != 0 && gRunners[j][R-STATE] == R-maybe-returning-after-catch) {
                        local3[i][0] = j
                        local3[0][3] = 1
                        inc local9
                    }
                }
            }
        }
    } else {
        local3[0][0] = 999
        for j = 0 to 3 + {
            if (gRunners[j][R-DEST-BASE] == R-HOME) {
                local3[0][0] = j
                if gRunners[j][R-FORCED] {
                    local3[0][3] = 1
                    inc local9
                }
            } else if (rRunnerStartingBases[j] == THIRD && gRunners[j][R-FORCED]) {
                local3[0][0] = j
                local3[0][3] = 1
                inc local9
            }
        }
        for i = 3 to 1 - {
            local3[i][0] = 999
            for j = 0 to 3 + {
                if (gRunners[j][R-DEST-BASE] == i) {
                    if (gRunners[j][R-DIRECTION] == FORWARD) {
                        if gRunners[j][R-FORCED] {
                            local3[i][0] = j
                            local3[i][3] = 1
                            inc local9
                        } else if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[gRunners[j][R-ENTITY]][X] gWorld[gRunners[j][R-ENTITY]][Z] < 144 && line-length.2d gWorld[i][X] gWorld[i][Z] gWorld[gRunners[j][R-ENTITY]][X] gWorld[gRunners[j][R-ENTITY]][Z] > 260) {
                            local11 = gRunners[j][R-ENTITY]
                            local6 = 1
                        } else {
                            local3[i][0] = j
                        }
                    } else if (gRunners[j][R-FORCED] && i < 3) {
                        local3[i + 1][0] = j
                        local3[i + 1][3] = 1
                        inc local9
                    } else if (random-between 0 100 < smth_stat_12) {
                        if (gRunners[j][R-DIRECTION] == BACKWARD) {
                            if (line-length.2d gWorld[gRunners[j][R-ENTITY]][X] gWorld[gRunners[j][R-ENTITY]][Z] gWorld[i][X] gWorld[i][Z] < 260 && line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[gRunners[j][R-ENTITY]][X] gWorld[gRunners[j][R-ENTITY]][Z] > 120) {
                                local3[i][0] = j
                            } else {
                                local11 = gRunners[j][R-ENTITY]
                                local6 = 1
                            }
                        }
                    }
                }
            }
        }
    }
    for i = 0 to 3 + {
        if (local3[i][0] != 999) {
            inc local6
            if (local7 > 80) {
                local3[i][1] = call-script smth_about_baserunner_distance local3[i][0] gWorld[i][X] gWorld[i][Z] 1
            } else {
                local3[i][1] = call-script smth_about_baserunner_distance local3[i][0] gWorld[i][X] gWorld[i][Z] 0
            }
            if (rBaseClaims[i] == 0 - fielder) {
                rCurrentPlay = i
                stop-script 0
            } else if (rBaseClaims[i] == 0) {
                if (local7 > 60) {
                    local3[i][2] = (50 - smth_stat_12) / 10 + call-script CalcFielderTimeRunToPoint fielder gWorld[i][X] gWorld[i][Z] 1
                } else {
                    local3[i][2] = random-between 0 5 - smth_stat_12 / 10 + call-script CalcFielderTimeRunToPoint fielder gWorld[i][X] gWorld[i][Z] 0
                }
            } else if (rBaseClaims[i] == fielder) {
                if (local3[i][1] < 1) {
                    local3[i][2] = local3[i][1] - 1
                } else {
                    local3[i][2] = 0
                }
            } else if (local7 > 60) {
                local3[i][2] = (50 - smth_stat_12) / 10 + call-script smth_distance_concerning_fielding fielder gWorld[i][X] gWorld[i][Z]
            } else {
                local3[i][2] = random-between 0 5 - smth_stat_12 / 10 + call-script smth_distance_concerning_fielding fielder gWorld[i][X] gWorld[i][Z]
            }
        } else {
            local3[i][1] = 999
            local3[i][2] = 999
            local3[i][3] = 0
            if (gBases[i][BASE-RUNNERIDX] != NONE) {
                local10 = i
            }
        }
    }
    if (not local6) {
        rCurrentPlay = NONE
        stop-script 0
    } else {
    }
    if (rCaughtFly && r_smth_fly_caught_runners_must_return) {
        local2 = 999
        local8 = -30
        for i = 1 to 3 + {
            if (local3[i][0] != 999) {
                if (local3[i][1] - local3[i][2] > local8) {
                    local8 = local3[i][1] - local3[i][2]
                    local2 = i
                } else if (local2 == 999) {
                    if (i == 3) {
                        local2 = 0
                    } else {
                        local2 = i + 1
                    }
                }
            }
        }
        if (local2 != 999) {
            rCurrentPlay = local2
            stop-script 0
        } else {
            rCurrentPlay = NONE
            stop-script 0
        }
    } else {
        if (gNumOuts == 2 && random 60 < local7) {
            local2 = 999
            local8 = 0
            if local9 {
                for i = 0 to 3 + {
                    if (local3[i][3] == 1) {
                        if (local3[i][1] - local3[i][2] > local8) {
                            local8 = local3[i][1] - local3[i][2]
                            local2 = i
                        }
                    }
                }
            }
            if (local2 == 999) {
                local8 = 0
                for i = 0 to 3 + {
                    if (local3[i][1] - local3[i][2] > local8) {
                        local8 = local3[i][1] - local3[i][2]
                        local2 = i
                    }
                }
            }
            if (local2 != 999) {
                rCurrentPlay = local2
                stop-script 0
            } else {
            }
        }
        i = 0
        do {
            if (local3[i][2] < local3[i][1]) {
                if (i == 0) {
                    rCurrentPlay = F-HOME
                    stop-script 0
                }
                if (i == 1) {
                    rCurrentPlay = FIRST
                    stop-script 0
                }
                if (i == 2 && local10 == 3 && local3[i][3] == 0 && random 150 > smth_stat_12) {
                    if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[SECOND-BASE-CENTER][X] gWorld[SECOND-BASE-CENTER][Z] > 780) {
                        if (rBaseClaims[MOUND] == FIELDER-PITCHER) {
                            local11 = 4
                        } else {
                            local11 = 3
                        }
                    }
                } else {
                    local2 = 999
                    local8 = local3[i][1] - local3[i][2]
                    if (i > 2) {
                        if (local3[2][1] - local3[2][2] >= local8) {
                            local8 = local3[2][1] - local3[2][2]
                            local2 = 2
                        }
                    }
                    if (local3[1][1] - local3[1][2] >= local8) {
                        local8 = local3[1][1] - local3[1][2]
                        local2 = 1
                    }
                    if (local2 == 999) {
                        rCurrentPlay = i
                        stop-script 0
                    }
                    if (local3[i][2] < local3[local2][2]) {
                        rCurrentPlay = i
                        stop-script 0
                    }
                    if (local3[i][2] + local3[local2][2] + 10 < local3[i][1]) {
                        rCurrentPlay = local2
                        stop-script 0
                    }
                    rCurrentPlay = i
                    stop-script 0
                }
            }
            dec i
            if (i < 0) {
                i = 3
            }
        } until (i == 0)
        if local9 {
            if local3[0][3] {
                rCurrentPlay = F-HOME
                stop-script 0
            }
            for i = 3 to 1 - {
                if (local3[i][3] == 1) {
                    if (i >= local10) {
                        rCurrentPlay = i
                        stop-script 0
                    } else if (random smth_stat_12 > 50 + random local7) {
                        rCurrentPlay = i
                        stop-script 0
                    }
                }
            }
        }
        case local11 {
            [46 47 48 49] {
                if (gDefenseControlledBy == CB-COMPUTER) {
                    if (gUserSelectedPlay == NONE) {
                        gUserSelectedPlay = local11
                    }
                    rCurrentPlay = gUserSelectedPlay
                    stop-script 0
                }
            }
            3 {
                rCurrentPlay = THIRD
                stop-script 0
            }
            4 {
                rCurrentPlay = MOUND
                stop-script 0
            }
            else {
            }
        }
        for i = 4 to 1 - {
            for j = 0 to 3 + {
                if (gRunners[j][R-DEST-BASE] == i) {
                    if (gRunners[j][R-DIRECTION] == BACKWARD) {
                        if (random 100 > smth_stat_12) {
                            inc i
                        } else {
                        }
                    } else if (random 100 > smth_stat_12) {
                        if (i < 4) {
                            inc i
                        } else if local10 {
                            i = local10 + 1
                        }
                    } else {
                    }
                    if (i > 3) {
                        rCurrentPlay = F-HOME
                    } else {
                        rCurrentPlay = i
                    }
                    stop-script 0
                }
            }
            if (local10 == i) {
                rCurrentPlay = i
                stop-script 0
            }
        }
        rCurrentPlay = NONE
        stop-script 0
    }
}

local-script DoFielderHoldingBall@2141 fielder facing actor smth_diving {
    var kid_speed smth_kid_data_3 local6 local7 local8 local9 local10 add_x add_y foo angle14 new_facing dist local17 local18 i local20 target local22

    if gNetplayActive {
    }
    kid_speed = call-script GetKidRunningSpeed rFieldingOrder[fielder - 37]
    smth_kid_data_3 = call-script smth_kid_data_3_with_fatigue rFieldingOrder[fielder - 37]
    if (gUserSelectedPlay == BALL-SHADOW) {
        gUserSelectedPlay = NONE
    } else if (gUserSelectedPlay == fielder) {
        gUserSelectedPlay = NONE
    }
    if (gUserSelectedPlay == LAST-CLICK-FIELDING) {
        gUserSelectedPlay = NONE
    }
    actor.init actor
    actor.animation-speed 2
    if smth_diving {
        actor.init actor
        actor.variable 0 1
        break-here.multi 2
        break-until (actor-get-variable actor 0 == 0)
        do-animation actor 6
        smth_diving = 0
        actor.init actor
        actor.variable 2 0
    }
    start-script SetBaseCorners
    foo = gWorld[fielder][TARGET]
    if (in foo [0 1 2 3]) {
        if (rBaseClaims[foo] == fielder) {
            if (gUserSelectedPlay == foo) {
                gUserSelectedPlay = NONE
            }
            for i = 0 to 3 + {
                if (gRunners[i][R-DEST-BASE] == foo || (foo == 0 && gRunners[i][R-DEST-BASE] == R-HOME)) {
                    if (gRunners[i][R-FORCED] == true) {
                        break-here.multi (random-between 1 2)
                        if (foo == 0) {
                            gBases[R-HOME][BASE-TAGGED-WITH-BALL] = true
                        } else {
                            gBases[foo][BASE-TAGGED-WITH-BALL] = true
                        }
                        if g_maybe_last_fielder_to_touch_ball {
                            start-script PlayKidEmoteSound rFieldingOrder[g_maybe_last_fielder_to_touch_ball - 37] 1
                        }
                    } else {
                        if (gWorld[fielder][X] != gWorld[rBaseCorners[foo]][X] || gWorld[fielder][Z] != gWorld[rBaseCorners[foo]][Z]) {
                            gWorld[fielder][TARGET-X] = gWorld[rBaseCorners[foo]][X]
                            gWorld[fielder][TARGET-Z] = gWorld[rBaseCorners[foo]][Z]
                            actor.init actor
                            actor.variable 1 1
                            do {
                                if (gRunners[i][R-CUR-BASE] == foo || (foo == 0 && gRunners[i][R-CUR-BASE] == R-HOME)) {
                                    jump L0522
                                }
                                angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[rBaseCorners[foo]][X] gWorld[rBaseCorners[foo]][Z]
                                new_facing = call-script ConvertAngleToFacing angle14
                                new_facing = call-script TurnFacingStep new_facing facing
                                start-script.rec SetActorFacing actor new_facing facing
                                facing = new_facing
                                if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[fielder][TARGET-X] gWorld[fielder][TARGET-Z] < kid_speed + 1) {
                                    gWorld[fielder][X] = gWorld[fielder][TARGET-X]
                                    gWorld[fielder][Z] = gWorld[fielder][TARGET-Z]
                                } else {
                                    add_x = cos angle14 * kid_speed / 100000
                                    add_y = sin angle14 * kid_speed / 100000
                                    gWorld[fielder][X] = gWorld[fielder][X] + add_x
                                    gWorld[fielder][Z] = gWorld[fielder][Z] + add_y
                                }
                                break-here
                                actor.init actor
                                actor.scale (call-script CalcActorScale fielder)
                                local18 = 5000 - gWorld[fielder][Z]
                                actor.init actor
                                actor.elevation local18
                                put-actor actor gScreen[fielder][X] (local18 + gScreen[fielder][Y]) 3
                            } until (gWorld[fielder][X] == gWorld[fielder][TARGET-X] && gWorld[fielder][Z] == gWorld[fielder][TARGET-Z])
                        }
                        actor.init actor
                        actor.variable 1 0
                        if (line-length.2d gWorld[gRunners[i][R-ENTITY]][X] gWorld[gRunners[i][R-ENTITY]][Z] gWorld[fielder][X] gWorld[fielder][Z] < 40) {
                            if gRunners[i][11] {
                                do-animation actor 21
                                break-here.multi 3
                            }
                        }
                        if (foo == 0) {
                            gBases[R-HOME][BASE-TAGGED-WITH-BALL] = true
                        } else {
                            gBases[foo][BASE-TAGGED-WITH-BALL] = true
                        }
                        break-here.multi 2
                        if (gRunners[i][R-STATE] != R-LEAVE-FIELD-WITH-OUT) {
                            if (foo == 0) {
                                if (gRunners[i][R-CUR-BASE] == R-HOME) {
                                    start-script EnqueueComment DIALOGUE-RUNNER-TAGGED-SAFE gRunners[i][R-KID]
                                    if (random 3) {
                                        start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 6
                                    }
                                    start-script SetCurrentEmote 11
                                }
                            } else if (gRunners[i][R-CUR-BASE] == foo && gRunners[i][R-DEST-BASE] != foo) {
                                start-script EnqueueComment DIALOGUE-RUNNER-TAGGED-SAFE gRunners[i][R-KID]
                                if (random 3) {
                                    start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 6
                                }
                                start-script SetCurrentEmote 11
                            }
                        } else {
                            if g_maybe_last_fielder_to_touch_ball {
                                start-script PlayKidEmoteSound rFieldingOrder[g_maybe_last_fielder_to_touch_ball - 37] 1
                            }
                            break-here
                            start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 5
                        }
                        do {
                            angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[gRunners[i][R-ENTITY]][X] gWorld[gRunners[i][R-ENTITY]][Z]
                            new_facing = call-script ConvertAngleToFacing angle14
                            new_facing = call-script TurnFacingStep new_facing facing
                            start-script.rec SetActorFacing actor new_facing facing
                            if (facing == new_facing) {
                                jump L0522
                            } else {
                                facing = new_facing
                                break-here
                            }
                        }
                    }
                }
            }
            if (foo == 0) {
                gBases[R-HOME][BASE-TAGGED-WITH-BALL] = true
            } else {
                gBases[foo][BASE-TAGGED-WITH-BALL] = true
            }
            foo = 3
        }
    }
    L0522:
    g_maybe_last_fielder_to_touch_ball = fielder
    if (gBallIsFoul || gNumOuts > 2 || not gNumRunners) {
        actor.init actor
        actor.variable 1 0
        g_maybe_smth_play_is_alive = 0
        start-script.rec DoFielderIdle fielder facing actor
        stop-script 0
    }
    gBallHasBounced = 1
    foo = 0
    start-script SetSensibleNextPlay fielder smth_kid_data_3
    if (rCurrentPlay < 5) {
        if (rBaseClaims[rCurrentPlay] == 0 - fielder) {
            jump L083a
        } else if (rCurrentPlay == MOUND && fielder == FIELDER-PITCHER && g_maybe_play_is_ready_to_end) {
            jump L083a
        }
    }
    if (gDefenseControlledBy != CB-COMPUTER) {
        if (gDifficulty == EASY) {
            foo = gOutfieldDelay - 5
        } else if (gDifficulty == MEDIUM) {
            foo = 0
        } else {
            foo = gOutfieldDelay - 200
        }
    } else if (gDifficulty == EASY) {
        foo = 0
    } else if (gDifficulty == MEDIUM) {
        foo = gOutfieldDelay - 5
    } else {
        foo = gOutfieldDelay
    }
    actor.init actor
    actor.variable 1 0
    do {
        if (gUserSelectedPlay != NONE) {
            foo = gOutfieldDelay
            rCurrentPlay = gUserSelectedPlay
            print-debug.start
            print-debug.printf "USER SELECTED-PLAY %d" gUserSelectedPlay
        } else {
            if (actor-get-variable actor 2 == 1) {
                jump L0d7f
            }
            break-here
        }
        inc foo
    } until (foo > gOutfieldDelay)
    local10 = 0
    if (rCurrentPlay != NONE) {
        angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]
        if (gUserSelectedPlay == NONE) {
            do {
                if (rCurrentPlay < 5) {
                    if (rBaseClaims[rCurrentPlay] != fielder) {
                        new_facing = call-script ConvertAngleToFacing angle14
                        new_facing = call-script TurnFacingStep new_facing facing 0 (band gKidData[rFieldingOrder[fielder - 37]][KD-HANDEDNESS] 3)
                        start-script.rec SetActorFacing actor new_facing facing
                        facing = new_facing
                    }
                } else {
                    new_facing = call-script ConvertAngleToFacing angle14
                    new_facing = call-script TurnFacingStep new_facing facing 0 (band gKidData[rFieldingOrder[fielder - 37]][KD-HANDEDNESS] 3)
                    start-script.rec SetActorFacing actor new_facing facing
                    facing = new_facing
                }
                break-here
                if (actor-get-variable actor 2 == 1) {
                    jump L0d7f
                }
                local18 = 5000 - gWorld[fielder][Z]
                actor.init actor
                actor.elevation local18
                put-actor actor gScreen[fielder][X] (local18 + gScreen[fielder][Y]) 3
                inc local10
                foo = rCurrentPlay
                for i = 0 to 3 + {
                    if (gRunners[i][R-DEST-BASE] == foo || (foo == 0 && gRunners[i][R-DEST-BASE] == R-HOME)) {
                        if (line-length.2d gWorld[gRunners[i][R-ENTITY]][X] gWorld[gRunners[i][R-ENTITY]][Z] gWorld[fielder][X] gWorld[fielder][Z] < 40) {
                            if gRunners[i][11] {
                                do-animation actor 21
                                break-here.multi 2
                                local10 = smth_kid_data_3 - 4
                            }
                        }
                    }
                }
            } until (local10 >= smth_kid_data_3 - 4)
            start-script SetSensibleNextPlay fielder smth_kid_data_3
        }
    }
    L083a:
    if (actor-get-variable actor 2 == 1) {
        jump L0d7f
    }
    temp = actor-get-property actor 0 2
    temp /= 4
    if (rCurrentPlay == NONE) {
        if (gNumOuts > 2 || not gNumRunners) {
            g_maybe_smth_play_is_alive = 0
            start-script.rec DoFielderIdle fielder facing actor
            stop-script 0
        }
        angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[MOUND-CENTER][X] gWorld[MOUND-CENTER][Z]
        new_facing = call-script ConvertAngleToFacing angle14
        new_facing = call-script TurnFacingStep new_facing facing
        start-script.rec SetActorFacing actor new_facing facing
        facing = new_facing
        break-here
        start-script SetSensibleNextPlay fielder smth_kid_data_3
        jump L083a
    } else if (rCurrentPlay > MOUND) {
        if (rCurrentPlay == LAST-CLICK-FIELDING || rCurrentPlay >= RUNNER-0) {
            local7 = 2
        } else {
            local7 = 1
        }
    } else if (rBaseClaims[rCurrentPlay] == fielder) {
        if (gUserSelectedPlay == MOUND) {
            gUserSelectedPlay = NONE
        }
        actor.init actor
        actor.variable 1 0
        if (g_maybe_play_is_ready_to_end && rCurrentPlay == MOUND && fielder == FIELDER-PITCHER) {
            r_maybe_pitcher_is_standing_on_the_mound = 1
            break-here.multi 5
            if (not g_maybe_play_is_ready_to_end) {
                r_maybe_pitcher_is_standing_on_the_mound = 0
                jump L083a
            }
            g_maybe_smth_play_is_alive = 0
            stop-script 0
        }
        angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[MOUND-CENTER][X] gWorld[MOUND-CENTER][Z]
        new_facing = call-script ConvertAngleToFacing angle14
        new_facing = call-script TurnFacingStep new_facing facing
        start-script.rec SetActorFacing actor new_facing facing
        facing = new_facing
        break-here
        foo = rCurrentPlay
        for i = 0 to 3 + {
            if (gRunners[i][R-DEST-BASE] == foo || (foo == 0 && gRunners[i][R-DEST-BASE] == R-HOME)) {
                if (line-length.2d gWorld[gRunners[i][R-ENTITY]][X] gWorld[gRunners[i][R-ENTITY]][Z] gWorld[fielder][X] gWorld[fielder][Z] < 40) {
                    if gRunners[i][11] {
                        do-animation actor 21
                        break-here.multi 2
                    }
                }
            }
        }
        if (gUserSelectedPlay == NONE) {
            start-script SetSensibleNextPlay fielder smth_kid_data_3
        } else {
            rCurrentPlay = gUserSelectedPlay
        }
        jump L083a
    }
    angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]
    if (local7 == 1) {
    } else {
        if (local7 == 2) {
        } else {
            L0aac:
            local6 = rBaseClaims[rCurrentPlay]
            if (local6 > 0) {
                local7 = 1
                do-animation actor 20
                jump L0c21
            }
            if (rCurrentPlay == MOUND) {
                if (fielder == FIELDER-PITCHER) {
                    local7 = 2
                    jump L0bc6
                } else {
                    local7 = 3
                }
                jump L0c21
            }
            if (local6 < 0) {
                if (local6 == 0 - fielder) {
                    local7 = 2
                } else {
                    local8 = call-script CalcFielderTimeRunToPoint (abs local6) gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z] 1
                    local9 = call-script CalcFielderTimeRunToPoint fielder gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z] 1
                    if (local9 <= local8) {
                        local7 = 2
                        target = gWorld[fielder][TARGET]
                        if (in target [F-HOME FIRST SECOND THIRD MOUND]) {
                            if (rBaseClaims[target] == fielder) {
                                if (target == F-HOME) {
                                    gBases[R-HOME][BASE-TAGGED-WITH-BALL] = false
                                } else if (target < MOUND) {
                                    gBases[target][BASE-TAGGED-WITH-BALL] = false
                                }
                            }
                            rBaseClaims[target] = 0
                        }
                    } else {
                        local7 = 3
                    }
                }
                jump L0c21
            }
            local7 = 2
        }
        L0bc6:
        target = gWorld[fielder][TARGET]
        if (in target [F-HOME FIRST SECOND THIRD MOUND]) {
            if (rBaseClaims[target] == fielder) {
                if (target == F-HOME) {
                    gBases[R-HOME][BASE-TAGGED-WITH-BALL] = false
                } else if (target < MOUND) {
                    gBases[target][BASE-TAGGED-WITH-BALL] = false
                }
            }
            rBaseClaims[target] = 0
        }
    }
    L0c21:
    if (local7 == 1) {
        if (in fielder [FIELDER-LF FIELDER-CF FIELDER-RF]) {
            local17 = call-script BestInfieldThrowTarget fielder
            if (local17 != NONE) {
                rCurrentPlay = local17
            }
        }
        actor.init actor
        actor.animation-speed 1
        do-animation actor 20
        actor.init actor
        actor.variable 3 0
        break-here
    }
    angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]
    local10 = 0
    new_facing = facing
    do {
        facing = new_facing
        new_facing = call-script ConvertAngleToFacing angle14
        if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z] > 480) {
            new_facing = call-script TurnFacingStep new_facing facing 1 (band gKidData[rFieldingOrder[fielder - 37]][KD-HANDEDNESS] 3)
        } else {
            new_facing = call-script TurnFacingStep new_facing facing 1
        }
        start-script.rec SetActorFacing actor new_facing facing
        break-here
        if (actor-get-variable actor 2 == 1) {
            facing = new_facing
            jump L0d7f
        }
        local18 = 5000 - gWorld[fielder][Z]
        actor.init actor
        actor.elevation local18
        put-actor actor gScreen[fielder][X] (local18 + gScreen[fielder][Y]) 3
        inc local10
    } until (facing == new_facing)
    if (local7 == 1) {
        L0d7f:
        if (actor-get-variable actor 2 == 1) {
            gBallVelPhysY = random-between 10000 25000
            gBallVelPhysX = random-between -25000 25000
            gBallVelPhysZ = random-between -25000 25000
            gBallPosPhysX = gWorld[fielder][X] * 1000
            gBallPosX = gBallPosPhysX / 1000
            gBallPosPhysY = 50000
            gBallPosY = gBallPosPhysY / 1000
            gBallPosPhysZ = gWorld[fielder][Z] * 1000
            gBallPosZ = gBallPosPhysZ / 1000
            start-script SimulateBallStopPosition true
            start-script EnqueueComment DIALOGUE-DROP rFieldingOrder[fielder - 37]
            start-script.rec SendClosestFielderToTarget
        } else {
            actor.init actor
            actor.variable 3 1
            break-here
            do {
                temp = actor-get-property actor 0 2 / 4
                if (temp != 20) {
                    do-animation actor 20
                }
                break-here
            } until (actor-get-variable actor 3 == 0)
            actor.init actor
            actor.variable 2 0
            if (rCurrentPlay < MOUND) {
                start-script FielderThrow fielder gWorld[rBaseCorners[rCurrentPlay]][X] gWorld[rBaseCorners[rCurrentPlay]][Z] facing
                case rCurrentPlay {
                    FIRST {
                        start-script EnqueueComment DIALOGUE-THROW-TO-FIRST rFieldingOrder[fielder - 37]
                    }
                    SECOND {
                        start-script EnqueueComment DIALOGUE-THROW-TO-SECOND rFieldingOrder[fielder - 37]
                    }
                    THIRD {
                        start-script EnqueueComment DIALOGUE-THROW-TO-THIRD rFieldingOrder[fielder - 37]
                    }
                    else {
                        start-script EnqueueComment DIALOGUE-THROW-TO-HOME rFieldingOrder[fielder - 37]
                    }
                }
            } else {
                start-script FielderThrow fielder gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z] facing
                if (rCurrentPlay == MOUND) {
                } else {
                    start-script EnqueueComment DIALOGUE-THROW rFieldingOrder[fielder - 37]
                }
            }
        }
        if (rBallFetcher == fielder) {
            rBallFetcher = 0
        }
        target = gWorld[fielder][TARGET]
        if (in target [F-HOME FIRST SECOND THIRD]) {
            if (rBaseClaims[target] == 0 - fielder) {
                gWorld[fielder][TARGET-X] = gWorld[rBaseCorners[target]][X]
                gWorld[fielder][TARGET-Z] = gWorld[rBaseCorners[target]][Z]
            } else if (rBaseClaims[target] == fielder) {
                if (target == F-HOME) {
                    gBases[R-HOME][BASE-TAGGED-WITH-BALL] = false
                } else {
                    gBases[target][BASE-TAGGED-WITH-BALL] = false
                }
            }
        } else if (target == MOUND) {
            gWorld[fielder][TARGET-X] = gWorld[MOUND-CENTER][X]
            gWorld[fielder][TARGET-Z] = gWorld[MOUND-CENTER][Z]
        } else {
            gWorld[fielder][TARGET-X] = gWorld[fielder][X]
            gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
        }
        if (actor-get-variable actor 2 == 1) {
            start-script.rec DoFielderLoop fielder facing 2
            gFielderWithBall = 0
        } else {
            actor.init actor
            actor.animation-speed 2
            actor.init actor
            actor.variable 2 0
            start-script.rec DoFielderLoop fielder facing 1
        }
        stop-script 0
    } else if (local7 == 3) {
        if (rCurrentPlay == MOUND) {
            do {
                if (gNumOuts > 2 || not gNumRunners) {
                    actor.init actor
                    actor.variable 1 0
                    g_maybe_smth_play_is_alive = 0
                    start-script.rec DoFielderIdle fielder facing actor
                    stop-script 0
                }
                break-here
                if (actor-get-variable actor 2 == 1) {
                    jump L0d7f
                }
                if (not (in gUserSelectedPlay [MOUND NONE])) {
                    start-script DoFielderHoldingBall fielder facing actor
                    stop-script 0
                } else {
                    gUserSelectedPlay = NONE
                }
                if (gWorld[FIELDER-PITCHER][TARGET] != MOUND) {
                    start-script DoFielderHoldingBall fielder facing actor
                    stop-script 0
                }
            } until (rBaseClaims[MOUND] == FIELDER-PITCHER)
            local7 = 1
            jump L0c21
        }
        local9 = call-script smth_distance_concerning_fielding fielder gWorld[rBaseCorners[rCurrentPlay]][X] gWorld[rBaseCorners[rCurrentPlay]][Z]
        do {
            local6 = rBaseClaims[rCurrentPlay]
            if (local6 == 0 || abs local6 == fielder) {
                jump L0aac
            }
            if (fielder == FIELDER-CACTHER) {
                local8 = call-script CalcFielderTimeRunToPoint (abs local6) gWorld[rBaseCorners[rCurrentPlay]][X] gWorld[rBaseCorners[rCurrentPlay]][Z] 0 0
            } else {
                local8 = call-script CalcFielderTimeRunToPoint (abs local6) gWorld[rBaseCorners[rCurrentPlay]][X] gWorld[rBaseCorners[rCurrentPlay]][Z] 0 1
            }
            break-here
            if (actor-get-variable actor 2 == 1) {
                jump L0d7f
            }
        } until (local8 < local9 || rBaseClaims[rCurrentPlay] > 0)
        local7 = 1
        jump L0c21
    } else {
        gUserSelectedPlay = NONE
        if (rCurrentPlay < MOUND) {
            rBaseClaims[rCurrentPlay] = 0 - fielder
            gWorld[fielder][TARGET-X] = gWorld[rBaseCorners[rCurrentPlay]][X]
            gWorld[fielder][TARGET-Z] = gWorld[rBaseCorners[rCurrentPlay]][Z]
            gWorld[fielder][TARGET] = rCurrentPlay
        } else {
            if (rCurrentPlay == MOUND) {
                rBaseClaims[rCurrentPlay] = 0 - fielder
                gWorld[fielder][TARGET] = MOUND
            } else {
                gWorld[fielder][TARGET] = NONE
            }
            gWorld[fielder][TARGET-X] = gWorld[rCurrentPlay][X]
            gWorld[fielder][TARGET-Z] = gWorld[rCurrentPlay][Z]
        }
        actor.init actor
        actor.variable 1 1
        if (fielder == gFielderWithBall) {
            if (in rCurrentPlay [RUNNER-0 RUNNER-1 RUNNER-2 RUNNER-3]) {
                if (actor-get-variable actor 2 == 0) {
                    if (actor-get-property actor 0 2 / 4 == 10) {
                        if (actor-get-property actor 0 2 / 4 != 26) {
                            if (actor-get-variable actor 1 == 1) {
                                do-animation actor 26
                            }
                        }
                    }
                }
            }
        }
        if (rCurrentPlay < MOUND) {
            if (abs local6 != fielder && local6 != 0) {
                gWorld[abs local6][TARGET-X] = gWorld[abs local6][X]
                gWorld[abs local6][TARGET-Z] = gWorld[abs local6][Z]
                gWorld[abs local6][TARGET] = NONE
            }
        }
        local20 = rCurrentPlay
        if (in rCurrentPlay [RUNNER-0 RUNNER-1 RUNNER-2 RUNNER-3]) {
            start-script AddFatigue rFieldingOrder[fielder - 37] 31
        }
        do {
            if (actor-get-variable actor 2) {
                if (actor-get-variable actor 2 == 1) {
                    jump L0d7f
                } else {
                    actor.init actor
                    actor.variable 2 0
                }
            }
            angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[fielder][TARGET-X] gWorld[fielder][TARGET-Z]
            new_facing = call-script ConvertAngleToFacing angle14
            dist = line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[fielder][TARGET-X] gWorld[fielder][TARGET-Z]
            if (dist < kid_speed + 1) {
                actor.init actor
                actor.variable 1 0
                gWorld[fielder][X] = gWorld[fielder][TARGET-X]
                gWorld[fielder][Z] = gWorld[fielder][TARGET-Z]
                if (rCurrentPlay < MOUND) {
                    rBaseClaims[rCurrentPlay] = fielder
                    if (rCurrentPlay == F-HOME) {
                        gBases[R-HOME][BASE-TAGGED-WITH-BALL] = true
                    } else {
                        gBases[rCurrentPlay][BASE-TAGGED-WITH-BALL] = true
                    }
                } else if (rCurrentPlay == MOUND) {
                    if g_maybe_play_is_ready_to_end {
                        r_maybe_pitcher_is_standing_on_the_mound = 1
                        if (gUserSelectedPlay == MOUND) {
                            gUserSelectedPlay = NONE
                        }
                        break-here.multi 5
                        if g_maybe_play_is_ready_to_end {
                            g_maybe_smth_play_is_alive = 0
                            stop-script 0
                        }
                        r_maybe_pitcher_is_standing_on_the_mound = 0
                    }
                }
                start-script DoFielderHoldingBall fielder facing actor
                stop-script 0
            } else {
                if (in rCurrentPlay [RUNNER-0 RUNNER-1 RUNNER-2 RUNNER-3]) {
                    gWorld[fielder][TARGET-X] = gWorld[rCurrentPlay][X]
                    gWorld[fielder][TARGET-Z] = gWorld[rCurrentPlay][Z]
                }
                add_x = cos angle14 * kid_speed / 100000
                add_y = sin angle14 * kid_speed / 100000
                foo = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                if foo {
                    inc local22
                    if (local22 > 50) {
                        start-script SetSensibleNextPlay fielder smth_kid_data_3
                        local22 = 0
                        jump L083a
                    }
                    if (call-script AngleDifference foo angle14 > 120) {
                        foo += 180
                    }
                    add_x = cos foo * kid_speed / 100000
                    add_y = sin foo * kid_speed / 100000
                    foo = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                    if foo {
                        if (call-script AngleDifference foo angle14 > 120) {
                            foo += 180
                        }
                        add_x = cos foo * kid_speed / 100000
                        add_y = sin foo * kid_speed / 100000
                        foo = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                        if foo {
                            add_x = 0
                            add_y = 0
                            actor.init actor
                            actor.variable 2 1
                            jump L0d7f
                        }
                    }
                } else {
                    local22 = 0
                }
                gWorld[fielder][X] = gWorld[fielder][X] + add_x
                gWorld[fielder][Z] = gWorld[fielder][Z] + add_y
                actor.init actor
                actor.scale (call-script CalcActorScale fielder)
            }
            new_facing = call-script TurnFacingStep new_facing facing
            start-script.rec SetActorFacing actor new_facing facing
            facing = new_facing
            break-here
            local18 = 5000 - gWorld[fielder][Z]
            actor.init actor
            actor.elevation local18
            put-actor actor gScreen[fielder][X] (local18 + gScreen[fielder][Y]) 3
            if (gDefenseControlledBy == CB-COMPUTER) {
                if (in local20 [46 47 48 49]) {
                    start-script SetSensibleNextPlay fielder smth_kid_data_3
                    if (rCurrentPlay == NONE && gRunners[local20 - 46][R-DIRECTION] == BACKWARD) {
                        rCurrentPlay = local20
                    }
                    if (rCurrentPlay != local20) {
                        if (rCurrentPlay == F-HOME) {
                            if (R-HOME == gRunners[local20 - 46][R-DEST-BASE] && gRunners[local20 - 46][R-DIRECTION] == FORWARD) {
                                if (line-length.2d gWorld[local20][X] gWorld[local20][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z] > line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]) {
                                    rCurrentPlay = local20
                                    gUserSelectedPlay = NONE
                                } else {
                                    gUserSelectedPlay = rCurrentPlay
                                    gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                                    gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
                                    start-script DoFielderHoldingBall fielder facing actor
                                }
                            } else {
                                gUserSelectedPlay = rCurrentPlay
                                gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                                gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
                                start-script DoFielderHoldingBall fielder facing actor
                            }
                        } else if (rCurrentPlay == gRunners[local20 - 46][R-DEST-BASE] && gRunners[local20 - 46][R-DIRECTION] == FORWARD) {
                            if (line-length.2d gWorld[local20][X] gWorld[local20][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z] > line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[rCurrentPlay][X] gWorld[rCurrentPlay][Z]) {
                                rCurrentPlay = local20
                                gUserSelectedPlay = NONE
                            } else {
                                gUserSelectedPlay = rCurrentPlay
                                gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                                gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
                                start-script DoFielderHoldingBall fielder facing actor
                            }
                        } else {
                            gUserSelectedPlay = rCurrentPlay
                            gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                            gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
                            start-script DoFielderHoldingBall fielder facing actor
                        }
                    } else {
                        gUserSelectedPlay = NONE
                    }
                } else if (local20 == 4) {
                    start-script SetSensibleNextPlay fielder smth_kid_data_3
                    if (rCurrentPlay != MOUND) {
                        start-script DoFielderHoldingBall fielder facing actor
                    }
                }
            }
            if (gUserSelectedPlay != NONE) {
                if (gUserSelectedPlay == LAST-CLICK-FIELDING) {
                    gWorld[fielder][TARGET-X] = gWorld[LAST-CLICK-FIELDING][X]
                    gWorld[fielder][TARGET-Z] = gWorld[LAST-CLICK-FIELDING][Z]
                    if (rCurrentPlay < 5) {
                        rBaseClaims[rCurrentPlay] = 0
                        gWorld[fielder][TARGET] = NONE
                        local20 = 56
                    }
                    rCurrentPlay = LAST-CLICK-FIELDING
                    gUserSelectedPlay = NONE
                } else {
                    gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                    gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
                    start-script DoFielderHoldingBall fielder facing actor
                }
            }
            if (in local20 [0 1 2 3]) {
                if (abs rBaseClaims[local20] != fielder) {
                    start-script DoFielderHoldingBall fielder facing actor
                }
            }
        }
    }
}

local-script WatchAwardErrorAfterThrow@2142 fielder {
    var i cur_target_base kid local4

    if (not gNumRunners) {
        stop-script 0
    }
    kid = rFieldingOrder[fielder - 37]
    cur_target_base = NONE
    if (in rCurrentPlay [F-HOME FIRST SECOND THIRD]) {
        cur_target_base = rCurrentPlay
    } else if (rCurrentPlay >= FIELDER-LF && rCurrentPlay <= FIELDER-PITCHER) {
        for i = 0 to 3 + {
            if (abs rBaseClaims[i] == rCurrentPlay) {
                cur_target_base = i
                i = 3
            }
        }
    }
    if (cur_target_base == NONE) {
        stop-script 0
    }
    if (g_maybe_last_fielder_to_touch_ball != fielder) {
        stop-script 0
    }
    if (in cur_target_base [F-HOME FIRST SECOND THIRD MOUND]) {
        if rBaseClaims[cur_target_base] {
            local4 = rFieldingOrder[abs rBaseClaims[cur_target_base] - 37]
            start-script EnqueueComment DIALOGUE-CATCH-GENERAL-ERROR local4
        } else if (cur_target_base >= FIELDER-LF && cur_target_base <= FIELDER-PITCHER) {
            local4 = rFieldingOrder[cur_target_base - 37]
            start-script EnqueueComment DIALOGUE-CATCH-GENERAL-ERROR local4
        }
    }
    for i = 0 to 3 + {
        if (gRunners[i][R-DEST-BASE] == cur_target_base && gRunners[i][R-DIRECTION] != 0) {
            break-until (gRunners[i][R-CUR-BASE] >= cur_target_base || gPlayEndedReason == PE-OUT-OF-PLAY)
            if (gRunners[i][R-CUR-BASE] == cur_target_base || gRunners[i][R-CUR-BASE] == cur_target_base + 1 || gPlayEndedReason == PE-OUT-OF-PLAY) {
                if gNetplayActive {
                    if (g_net_smth_master == g_net_smth_me) {
                        start-script AddNetStat kid STAT-ERRORS 1
                        start-script AddStat kid STAT-ERRORS 1
                    }
                } else if (MODE-BATTING-PRACTICE != gGameMode) {
                    start-script AddStat kid STAT-ERRORS 1
                }
                rDefenseSentiment = -1
            } else {
            }
            stop-script 0
        }
    }
    for i = 0 to 3 + {
        if (gRunners[i][R-CUR-BASE] == cur_target_base) {
            break-until (gFielderWithBall || gRunners[i][R-CUR-BASE] > cur_target_base || gPlayEndedReason == PE-OUT-OF-PLAY)
            if (gRunners[i][R-CUR-BASE] > cur_target_base && gRunners[i][R-CUR-BASE] != NONE || gPlayEndedReason == PE-OUT-OF-PLAY) {
                if gNetplayActive {
                    if (g_net_smth_master == g_net_smth_me) {
                        start-script AddNetStat kid STAT-ERRORS 1
                        start-script AddStat kid STAT-ERRORS 1
                    }
                } else if (MODE-BATTING-PRACTICE != gGameMode) {
                    start-script AddStat kid STAT-ERRORS 1
                }
                rDefenseSentiment = -1
                stop-script 0
            } else {
                stop-script 0
            }
        }
    }
}

local-script WatchAwardErrorAfterMissedCatch@2143 fielder {
    var i runneridx local3 kid local5 saved_play local7

    local5 = call-script smth_kid_data_3_with_fatigue rFieldingOrder[fielder - 37]
    kid = rFieldingOrder[fielder - 37]
    if gBallHasBounced {
        if (g_maybe_last_fielder_to_touch_ball != 0 && g_maybe_last_fielder_to_touch_ball != fielder) {
            g_maybe_last_fielder_to_touch_ball = fielder
            i = gWorld[fielder][TARGET]
            if (in i [0 1 2 3]) {
                for runneridx = 0 to 3 + {
                    if (gRunners[runneridx][R-DEST-BASE] == i && gRunners[runneridx][R-DIRECTION] != 0) {
                        break-until (gRunners[runneridx][R-CUR-BASE] >= i)
                        if (gRunners[runneridx][R-CUR-BASE] == i || gRunners[runneridx][R-CUR-BASE] == i + 1) {
                            if gNetplayActive {
                                if (g_net_smth_master == g_net_smth_me) {
                                    start-script AddNetStat kid STAT-ERRORS 1
                                    start-script AddStat kid STAT-ERRORS 1
                                }
                            } else if (MODE-BATTING-PRACTICE != gGameMode) {
                                start-script AddStat kid STAT-ERRORS 1
                            }
                            rDefenseSentiment = -1
                        } else {
                        }
                        stop-script 0
                    }
                }
                stop-script 0
            }
            stop-script 0
        } else {
            if (g_maybe_last_fielder_to_touch_ball == fielder) {
                stop-script 0
            }
            print-debug.start
            print-debug.string "no one had touched ball"
            g_maybe_last_fielder_to_touch_ball = fielder
            saved_play = rCurrentPlay
            start-script SetSensibleNextPlay fielder local5
            local3 = rCurrentPlay
            rCurrentPlay = saved_play
            for i = 0 to 3 + {
                if (gRunners[i][R-DEST-BASE] == local3) {
                    runneridx = i
                }
            }
            if (local3 == 999 || local3 == 4) {
                stop-script 0
            }
            print-debug.start
            print-debug.printf "could've gotten %d at base %d" runneridx local3
            break-until gFielderWithBall
            saved_play = rCurrentPlay
            start-script SetSensibleNextPlay fielder local5
            local7 = rCurrentPlay
            rCurrentPlay = saved_play
            if (local7 == local3 && gRunners[runneridx][R-DEST-BASE] == local3) {
                break-until (g_maybe_smth_play_is_alive == 0)
                break-here.multi 2
                if (gRunners[runneridx][R-CUR-BASE] == NONE) {
                    stop-script 0
                } else {
                    if gNetplayActive {
                        if (g_net_smth_master == g_net_smth_me) {
                            start-script AddNetStat kid STAT-ERRORS 1
                            start-script AddStat kid STAT-ERRORS 1
                        }
                    } else if (MODE-BATTING-PRACTICE != gGameMode) {
                        start-script AddStat kid STAT-ERRORS 1
                    }
                    rDefenseSentiment = -1
                    stop-script 0
                }
            } else {
                if gNetplayActive {
                    if (g_net_smth_master == g_net_smth_me) {
                        start-script AddNetStat kid STAT-ERRORS 1
                        start-script AddStat kid STAT-ERRORS 1
                    }
                } else if (MODE-BATTING-PRACTICE != gGameMode) {
                    start-script AddStat kid STAT-ERRORS 1
                }
                rDefenseSentiment = -1
                stop-script 0
            }
        }
    } else {
        g_maybe_last_fielder_to_touch_ball = fielder
        break-until gFielderWithBall
        break-here
        if rCaughtFly {
            stop-script 0
        } else {
            saved_play = rCurrentPlay
            start-script SetSensibleNextPlay fielder local5
            local7 = rCurrentPlay
            rCurrentPlay = saved_play
            if (gBases[FIRST][BASE-RUNNERIDX] == NONE && local7 == 1) {
                stop-script 0
            } else {
                if gNetplayActive {
                    if (g_net_smth_master == g_net_smth_me) {
                        start-script AddNetStat kid STAT-ERRORS 1
                        start-script AddStat kid STAT-ERRORS 1
                    }
                } else if (MODE-BATTING-PRACTICE != gGameMode) {
                    start-script AddStat kid STAT-ERRORS 1
                }
                rDefenseSentiment = -1
                stop-script 0
            }
        }
    }
}

local-script DoFielderMissedCatch@2144 fielder smth_height smth_diving {
    rBallThrownToFielder = 0
    if (gBallIsFair == false) {
        if (call-script IsFoulTerritory gWorld[fielder][X] gWorld[fielder][Z]) {
            gBallIsFoul = true
        } else {
            gBallIsFair = true
        }
    }
    if (gBallPosPhysY > 48000) {
        if (not (random 5)) {
            if gNetplayActive {
                gNetStateBuffer[1][4] = 1997
            }
            sound.start sound1997
            sound.end
            gBallVelPhysY = random-between 10 25 * (abs gBallVelPhysX + abs gBallVelPhysZ) / 100
        } else {
            if gNetplayActive {
                gNetStateBuffer[1][4] = 1998
            }
            sound.start sound1998
            sound.end
            gBallVelPhysY = random-between -10 10 * (abs gBallVelPhysX + abs gBallVelPhysZ) / 200
        }
        gBallPosPhysY = smth_height * 1000
        gBallPosY = gBallPosPhysY / 1000
    } else {
        if gNetplayActive {
            gNetStateBuffer[1][4] = 1998
        }
        sound.start sound1998
        sound.end
        gBallVelPhysY = random-between -20 20 * (abs gBallVelPhysX + abs gBallVelPhysZ) / 200
    }
    gBallVelPhysX = random-between -45 45 * (0 - gBallVelPhysX) / 100
    gBallVelPhysZ = random-between -45 45 * (0 - gBallVelPhysZ) / 100
    if (g_maybe_last_fielder_to_touch_ball == 0) {
        if gBallHasBounced {
            if smth_diving {
                start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT-ERROR rFieldingOrder[fielder - 37]
            } else {
                start-script EnqueueComment DIALOGUE-CATCH-LOW-HIT-ERROR rFieldingOrder[fielder - 37]
            }
        } else {
            start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT-ERROR rFieldingOrder[fielder - 37]
        }
    } else if gBallHasBounced {
        if (g_maybe_last_fielder_to_touch_ball != fielder) {
            start-script EnqueueComment DIALOGUE-DROP rFieldingOrder[fielder - 37]
        }
    } else if smth_diving {
        start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT-ERROR rFieldingOrder[fielder - 37]
    }
    g_maybe_last_fielder_to_touch_ball = fielder
    start-script SimulateBallStopPosition true
    start-script SetBaseCorners
    start-script.rec WatchAwardErrorAfterMissedCatch fielder
    start-script.rec SendClosestFielderToTarget true
}

local-script DoFielderIdle@2145 fielder facing actor animation {
    var local4 local5 local6 maybe_height handled_ball_nearby local9 local10 local11

    if (rFieldingOrder[fielder - 37] > gMaxUniqueKid) {
        break-here.multi (random-between 3 5)
        start-script.rec DoFielderLoop fielder facing 0
        stop-script 0
    }
    maybe_height = call-script smth_about_kid_data_maybe_height rFieldingOrder[fielder - 37]
    local10 = kludge-call 1969 actor
    local10 = band (kludge-call 1969 actor >> 16) 255
    case local10 {
        128 {
            local10 = 8
        }
        64 {
            local10 = 7
        }
        32 {
            local10 = 6
        }
        16 {
            local10 = 5
        }
        8 {
            local10 = 4
        }
        4 {
            local10 = 3
        }
        2 {
            local10 = 2
        }
        1 {
            local10 = 1
        }
        else {
            local10 = 5
        }
    }
    local10 = min 8 (max 1 local10)
    case local10 {
        [1 2 3] {
            local11 = 4
        }
        [4 5 6] {
            local11 = 5
        }
        [7 8] {
            local11 = 6
        }
        else {
        }
    }
    case local11 {
        4 {
            facing = 15
        }
        5 {
            facing = 13
        }
        6 {
            facing = 11
        }
        else {
        }
    }
    do {
        kludge 1969 actor 0
        actor.init actor
        actor.condition [138]
        case 1 {
            (local10 > 5) {
                dec local10
            }
            (local10 < 5) {
                inc local10
            }
            else {
            }
        }
        actor.init actor
        actor.condition [(128 + local10)]
        break-here
    } until (local10 == local11)
    if (g_maybe_smth_play_is_alive == 0) {
        break-here.multi (random-between 10 (call-script smth_about_kid_data_10_with_randomness rFieldingOrder[fielder - 37] + 50))
        if (rDefenseSentiment == -1) {
            animation = 32
            if (random 5 == 2) {
                start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 11
            }
        } else if (rDefenseSentiment == 1) {
            animation = 31
        } else if (in gPlayEndedReason [0 PE-INFIELD-FLY]) {
            animation = 31
        } else {
            animation = 32
        }
    } else if (animation == 33) {
        animation = 30
        if (not (random 3)) {
            animation = 31
        }
    }
    if (animation == 31) {
        if g_maybe_smth_play_is_alive {
            local9 = 10
        } else {
            local9 = 5
        }
        if (random local9 == 3) {
            start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 10
        } else if (random local9 == 5) {
            start-script PlayKidEmoteSound rFieldingOrder[fielder - 37]
        }
    }
    start-script smth_actor_do_anim fielder actor animation
    local4 = random-between 150 300
    do {
        actor.init actor
        actor.variable 0 0
        do {
            if (not handled_ball_nearby && g_smth_play_may_continue) {
                if (call-script DistanceToBall2D fielder < 480) {
                    if (gBallPosY < maybe_height || (gBallPosPhysY + gBallVelPhysY * gVectorScaleNum / gVectorScaleDen) / 1000 < maybe_height) {
                        if (call-script DistanceToBall2D fielder < 48) {
                            handled_ball_nearby = 1
                            start-script DoFielderMissedCatch fielder maybe_height 0
                        }
                    }
                }
            }
            local5 += 5
            if (fielder == rBallFetcher) {
                local5 += 10
            }
            local5 += 5
            break-here
            if (actor-get-variable actor 2) {
                handled_ball_nearby = 1
            }
        } until (actor-get-variable actor 0)
        if handled_ball_nearby {
            local6 = 301
            start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 8
            start-script SetCurrentEmote 2
        } else {
            local6 = call-script smth_about_kid_data_10_with_randomness rFieldingOrder[fielder - 37] + local5
        }
        if (local6 > local4) {
            if (g_maybe_smth_play_is_alive == 0) {
                start-script.rec DoFielderLoop fielder facing 0
                stop-script 0
            }
            if (rFieldingOrder[fielder - 37] == KENNY-KAWAGUCHI) {
                start-script.rec DoFielderLoop fielder facing 0
                stop-script 0
            }
            if handled_ball_nearby {
                if gNetplayActive {
                    if (g_net_smth_me == g_net_smth_master) {
                        temp2 = actor - 7
                        case temp2 {
                            0 {
                                temp = 510
                            }
                            1 {
                                temp = 509
                            }
                            2 {
                                temp = 507
                            }
                            3 {
                                temp = 503
                            }
                            4 {
                                temp = 495
                            }
                            5 {
                                temp = 479
                            }
                            6 {
                                temp = 447
                            }
                            7 {
                                temp = 383
                            }
                            8 {
                                temp = 255
                            }
                            else {
                            }
                        }
                        g_maybe_net_fielders_dirty_mask = band g_maybe_net_fielders_dirty_mask temp
                    }
                }
                start-script.rec DoFielderLoop fielder facing 2
                stop-script 0
            } else if (call-script smth_kid_data_3_with_fatigue rFieldingOrder[fielder - 37] > random-between -600 90) {
                start-script.rec DoFielderLoop fielder facing 0
                stop-script 0
            } else if (animation == 30) {
                if gNetplayActive {
                    if (g_net_smth_me == g_net_smth_master) {
                        temp2 = actor - 7
                        case temp2 {
                            0 {
                                temp = 510
                            }
                            1 {
                                temp = 509
                            }
                            2 {
                                temp = 507
                            }
                            3 {
                                temp = 503
                            }
                            4 {
                                temp = 495
                            }
                            5 {
                                temp = 479
                            }
                            6 {
                                temp = 447
                            }
                            7 {
                                temp = 383
                            }
                            8 {
                                temp = 255
                            }
                            else {
                            }
                        }
                        g_maybe_net_fielders_dirty_mask = band g_maybe_net_fielders_dirty_mask temp
                    }
                }
                start-script.rec DoFielderLoop fielder facing 2
                stop-script 0
            } else {
                start-script.rec DoFielderLoop fielder facing 0
                stop-script 0
            }
        }
    }
}

local-script smth_turns_loop@2146 {
    do {
        break-here
        if (r_maybe_smth_turn < gMaxTurnCount - 1) {
            inc r_maybe_smth_turn
        } else {
            r_maybe_smth_turn = 0
        }
    }
}

local-script CatchErrorCheck@2147 fielder smth_height smth_stat_3 angle {
    var result angle_diff local6 danger

    if (gNoErrors || (g_maybe_play_is_ready_to_end && rCurrentPlay == MOUND)) {
        return 0
    }
    if (gPlayEndedReason == PE-INFIELD-FLY) {
        return 0
    }
    if (gBallIsFoul || gSimFirstBounceFoul) {
        return 0
    } else {
        if (abs (gBallPosY - smth_height) < 7) {
            danger = 2
        } else if (gBallPosPhysY < 7000) {
            danger = 2
        } else {
            danger = 1
        }
        angle_diff = call-script AngleDifference (angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gBallPosX gBallPosZ) angle
        if (angle_diff > 45) {
            danger += 2
            if (angle_diff > 90) {
                danger += 5
                if (angle_diff > 135 && rFieldingOrder[fielder - 37] != KENNY-KAWAGUCHI) {
                    result = 666
                }
            }
        }
        if (result != 666) {
            local6 = (abs gBallVelPhysX + abs gBallVelPhysY + abs gBallVelPhysZ) / 10000
            temp = danger
            danger *= local6 + smth_stat_3
            if (random-between -30 danger > 45) {
                result = 1
            }
        }
    }
    return result
}

local-script CheckFielderDive@2148 fielder dist_ball_2d smth_stat_27 speed {
    var local4 local5 local6

    if (dist_ball_2d < smth_stat_27 + speed + 12) {
        if (gDifficulty == HARD) {
            local6 = 100
        } else {
            local6 = 200
        }
        if (random local6 < call-script smth_about_kid_data_12_with_fatigue rFieldingOrder[fielder - 37]) {
            local5 = call-script maybe_smth_distance_2d_ahead_ball fielder
            if (local5 > dist_ball_2d + speed + 12) {
                return 1
            }
        }
    }
    return local4
}

local-script DoFielderLoop@2149 fielder facing arg2 {
    var add_x add_y angle actor speed smth_stat_3 next_facing he9_angle smth_stat_27 smth_height delay angle14 local15 smth_diving ticks_until_catch boredom dist_ball_2d smth_turns bottled_up_emotions catch_error local23

    speed = call-script GetKidRunningSpeed rFieldingOrder[fielder - 37]
    smth_stat_3 = call-script smth_kid_data_3_with_fatigue rFieldingOrder[fielder - 37]
    smth_stat_27 = call-script smth_kid_data_27_maybe_errors_chance rFieldingOrder[fielder - 37]
    smth_height = call-script smth_about_kid_data_maybe_height rFieldingOrder[fielder - 37]
    smth_turns = fielder - fielder / gMaxTurnCount * gMaxTurnCount
    actor = fielder - 30
    if (actor && arg2 == 0) {
        local15 = 5000 - gWorld[fielder][Z]
        actor.init actor
        actor.new
        actor.costume (call-script maybe_kid_get_costume_fielding rFieldingOrder[fielder - 37])
        actor.elevation local15
        actor.animation-speed 2
        actor.ignore-boxes
        actor.scale (call-script CalcActorScale fielder)
        actor.shadow global423
        actor.condition [138]
        if gNetplayActive {
            if (g_net_smth_me == g_net_smth_master) {
                temp2 = actor - 7
                case temp2 {
                    0 {
                        temp = 510
                    }
                    1 {
                        temp = 509
                    }
                    2 {
                        temp = 507
                    }
                    3 {
                        temp = 503
                    }
                    4 {
                        temp = 495
                    }
                    5 {
                        temp = 479
                    }
                    6 {
                        temp = 447
                    }
                    7 {
                        temp = 383
                    }
                    8 {
                        temp = 255
                    }
                    else {
                    }
                }
                g_maybe_net_fielders_dirty_mask = band g_maybe_net_fielders_dirty_mask temp
            }
        }
        start-script smth_actor_palette_team_color actor (abs (gBattingTeamInfoIndex - 1))
        start-script smth_actor_kid_palette actor rFieldingOrder[fielder - 37]
        put-actor actor gScreen[fielder][X] (local15 + gScreen[fielder][Y]) 3
        do-animation actor 6
        if (fielder == rBallFetcher) {
            start-script DrawNameUnderFielder rBallFetcher
        }
        bottled_up_emotions = random-between 10 25
        if (rCurrentEmote == 9) {
            bottled_up_emotions += random-between 20 40
        }
    } else {
        angle = facing * 22 - 22
    }
    if gNetplayActive {
        if (gDefenseControlledBy == CB-NETWORK) {
            print-debug.start
            print-debug.string "Remote control fielders???"
            stop-script 0
        }
    }
    if (arg2 == 2) {
        actor.init actor
        actor.variable 2 1
        jump L0d51
    }
    if (arg2 == 1) {
        break-here.multi 3
    }
    if (not facing) {
        if (fielder == FIELDER-CACTHER) {
            facing = 5
            smth_stat_3 += 3
            angle = 90
        } else {
            facing = 13
            angle = 270
        }
    }
    start-script.rec SetActorFacing actor facing
    if (not g_smth_play_may_continue && arg2 == 0) {
        break-here
        put-actor actor gScreen[fielder][X] (local15 + gScreen[fielder][Y]) 3
        if (gPlayEndedReason == PE-BASE-ON-BALLS) {
            break-until g_maybe_play_is_ready_to_end
        }
        g_maybe_smth_play_is_alive = 0
        start-script.rec DoFielderIdle fielder facing actor
        stop-script 0
    }
    if (gDefenseControlledBy != CB-COMPUTER && arg2 == 0) {
        if (rBallWasHitHigh && gWorld[fielder][TARGET] == BALL-SHADOW) {
            delay = smth_stat_3 + gOutfieldDelay
        } else {
            delay = smth_stat_3 + arg2 * 5
        }
    } else if (gDefenseControlledBy == CB-COMPUTER && arg2 == 0) {
        delay = smth_stat_3 + 10
    } else {
        delay = smth_stat_3 + arg2 * 5
    }
    do {
        if (not g_maybe_smth_play_is_alive) {
            actor.init actor
            actor.variable 1 0
            break-here.multi 5
            start-script.rec DoFielderIdle fielder facing actor
            stop-script 0
        }
        do {
            if (actor-get-variable actor 2 && not smth_diving) {
                jump L0d51
            }
            if actor {
                local15 = 5000 - gWorld[fielder][Z]
                actor.init actor
                actor.elevation local15
                put-actor actor gScreen[fielder][X] (local15 + gScreen[fielder][Y]) 3
            }
            if arg2 {
                if (gFielderWithBall != 0 && gFielderWithBall != fielder) {
                    arg2 = 0
                }
            }
            dist_ball_2d = call-script DistanceToBall2D fielder
            if ticks_until_catch {
                dec ticks_until_catch
                if (ticks_until_catch == 0) {
                    actor.init actor
                    actor.animation-speed 2
                }
            } else if (not smth_diving) {
                if (dist_ball_2d < rBallCatchDistance) {
                    if (rBallThrownToFielder && abs rBallThrownToFielder != fielder) {
                    } else {
                        ticks_until_catch = call-script FielderTicksUntilCatch fielder
                    }
                    if ticks_until_catch {
                        rBallThrownToFielder = 0
                        if (ticks_until_catch == 4 && g_maybe_last_fielder_to_touch_ball == 0) {
                            start-script EnqueueComment DIALOGUE-FIELDER-ABOUT-TO-CATCH rFieldingOrder[fielder - 37]
                        }
                        if (ticks_until_catch == 4) {
                            do-animation actor 24
                        } else if (gWorld[fielder][X] == gWorld[fielder][TARGET-X] && gWorld[fielder][Z] == gWorld[fielder][TARGET-Z] && in fielder [FIELDER-1B FIELDER-2B FIELDER-3B FIELDER-CACTHER]) {
                            do-animation actor 25
                        } else {
                            do-animation actor (21 + ticks_until_catch - 1)
                        }
                        ticks_until_catch = 5
                        actor.init actor
                        actor.animation-speed 1
                    }
                }
            }
            if (gFielderWithBall > 0 || arg2 || dist_ball_2d > 80 || in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-OUT-OF-PLAY]) {
            } else if (rBallThrownToFielder && abs rBallThrownToFielder != fielder) {
            } else if (gBallPosY < smth_height || (gBallPosPhysY + gBallVelPhysY * gVectorScaleNum / gVectorScaleDen) / 1000 < smth_height) {
                if (dist_ball_2d < smth_stat_27) {
                    boredom = 0
                    catch_error = call-script CatchErrorCheck fielder smth_height smth_stat_3 angle
                    if (catch_error == 666) {
                        catch_error = 1
                        actor.init actor
                        actor.variable 2 1
                        if (bottled_up_emotions > 15) {
                            start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 8
                            bottled_up_emotions = 0
                        }
                    }
                    rAutoFieldeingDelay = 0
                    if (catch_error || gCurrentSwing * not gBallHasBounced == 6) {
                        if (gCurrentSwing == SWING-SCREAMING-LINE-DRIVE) {
                            gCurrentSwing = SWING-LINE-DRIVE
                        }
                        start-script DoFielderMissedCatch fielder smth_height smth_diving
                        if ticks_until_catch {
                            ticks_until_catch = 0
                            actor.init actor
                            actor.animation-speed 2
                        }
                        if (g_maybe_play_is_ready_to_end == 0) {
                            if (bottled_up_emotions > 15) {
                                start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 2
                                bottled_up_emotions = 0
                            }
                            start-script SetCurrentEmote 4
                        }
                        if (not smth_diving) {
                            break-here.multi (smth_stat_3 + random-between 5 20)
                        }
                    } else if (not gBallIsFoul && not (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE PE-OUT-OF-PLAY])) {
                        case 1 {
                            (abs gBallVelPhysX + abs gBallVelPhysY + abs gBallVelPhysZ > 100000) {
                                if gNetplayActive {
                                    gNetStateBuffer[1][4] = 1996
                                }
                                sound.start sound1996
                                sound.end
                            }
                            (abs gBallVelPhysX + abs gBallVelPhysY + abs gBallVelPhysZ > 50000) {
                                if gNetplayActive {
                                    gNetStateBuffer[1][4] = 1995
                                }
                                sound.start sound1995
                                sound.end
                            }
                            (abs gBallVelPhysX + abs gBallVelPhysY + abs gBallVelPhysZ > 20000) {
                                if gNetplayActive {
                                    gNetStateBuffer[1][4] = 1994
                                }
                                sound.start sound1994
                                sound.end
                            }
                            else {
                            }
                        }
                        gFielderWithBall = fielder
                        start-script DrawNameUnderFielder fielder
                        if smth_diving {
                            if (g_maybe_last_fielder_to_touch_ball == 0 || g_maybe_last_fielder_to_touch_ball == fielder) {
                                if gBallHasBounced {
                                    start-script EnqueueComment DIALOGUE-CATCH-LOW-HIT rFieldingOrder[fielder - 37]
                                } else if (call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] gWorld[fielder][X] (gWorld[fielder][Z] + 80)) {
                                    start-script EnqueueComment DIALOGUE-SNOWCONE-CATCH gBatterKid
                                } else {
                                    start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT rFieldingOrder[fielder - 37]
                                }
                            }
                        } else if (rBallWasHitHigh && gBallHasBounced == 0) {
                            if (call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] gWorld[fielder][X] (gWorld[fielder][Z] + 80)) {
                                start-script EnqueueComment DIALOGUE-SNOWCONE-CATCH gBatterKid
                            } else {
                                start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT rFieldingOrder[fielder - 37]
                            }
                        } else if (g_maybe_last_fielder_to_touch_ball == 0 && gBallWasHit) {
                            if gBallHasBounced {
                                if (fielder == FIELDER-PITCHER && gFieldingTargetZ > gWorld[fielder][Z]) {
                                    start-script EnqueueComment DIALOGUE-HIT-TO-PITCHER rFieldingOrder[fielder - 37]
                                } else if (fielder == FIELDER-SS && gFieldingTargetZ > gWorld[fielder][Z]) {
                                    start-script EnqueueComment DIALOGUE-HIT-TO-SHORTSTOP rFieldingOrder[fielder - 37]
                                } else if (gBallVelPhysZ < -2000) {
                                    start-script EnqueueComment DIALOGUE-BALL-OFF-THE-WALL rFieldingOrder[fielder - 37]
                                } else {
                                    start-script EnqueueComment DIALOGUE-CATCH-GENERAL rFieldingOrder[fielder - 37]
                                }
                            } else {
                                start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT rFieldingOrder[fielder - 37]
                            }
                        } else if gBallHasBounced {
                        } else {
                            start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT rFieldingOrder[fielder - 37]
                        }
                        if (gBallHasBounced == 0) {
                            rCaughtFly = true
                            gBallIsFair = true
                            actor.init actor
                            actor.variable 1 0
                            break-here.multi 2
                            start-script SetCurrentEmote 3
                            if (bottled_up_emotions > 15) {
                                start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 1
                                bottled_up_emotions = 0
                            }
                        } else if (gBallIsFair == false) {
                            if (call-script IsFoulTerritory gWorld[fielder][X] gWorld[fielder][Z]) {
                                gBallIsFoul = true
                            } else {
                                gBallIsFair = true
                            }
                        }
                        if (gWorld[fielder][TARGET] == BALL-SHADOW) {
                            gWorld[fielder][TARGET] = NONE
                        }
                        start-script DoFielderHoldingBall fielder facing actor smth_diving
                        stop-script 0
                    }
                } else if (delay == 0 && gField != CEMENT-GARDENS) {
                    if (smth_diving == 0 && gWorld[fielder][TARGET] == BALL-SHADOW && rFieldingOrder[fielder - 37] != KENNY-KAWAGUCHI && rFieldingOrder[fielder - 37] != MR-CLANKY) {
                        smth_diving = call-script CheckFielderDive fielder dist_ball_2d smth_stat_27 speed
                        if smth_diving {
                            speed += 5
                            angle = call-script maybe_smth_angle_2d_ahead_ball fielder
                            do-animation actor 13
                            actor.init actor
                            actor.variable 2 1
                            start-script EnqueueComment DIALOGUE-FIELDER-DIVE rFieldingOrder[fielder - 37]
                            start-script AddFatigue rFieldingOrder[fielder - 37] 30
                        }
                    }
                }
            }
            if delay {
                if (gUserSelectedPlay != NONE) {
                    delay = 0
                } else {
                    dec delay
                }
                break-here
            } else if ticks_until_catch {
                break-here
            }
        } until (delay * g_maybe_smth_play_is_alive == 0 && ticks_until_catch == 0)
        if arg2 {
            arg2 = 0
        }
        if (smth_diving || ticks_until_catch) {
        } else {
            if (not (smth_turns - r_maybe_smth_turn)) {
                if (gWorld[fielder][TARGET] != NONE) {
                    if (gWorld[fielder][TARGET] == BALL-SHADOW) {
                        if (gFielderWithBall || in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-OUT-OF-PLAY]) {
                            gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                            gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
                            gWorld[fielder][TARGET] = NONE
                        } else if (rAutoFieldeingDelay < 1) {
                            gWorld[fielder][TARGET-X] = gBallPosX
                            gWorld[fielder][TARGET-Z] = gBallPosZ
                            if (fielder == rBallFetcher) {
                                rBallFetcher = 0
                            }
                        }
                    } else {
                        if (fielder == FIELDER-PITCHER) {
                            start-script.rec smth_to_do_with_fielding_sometimes_infield fielder
                        } else if (gWorld[fielder][TARGET] != MOUND) {
                            gWorld[fielder][TARGET-X] = gWorld[rBaseCorners[gWorld[fielder][TARGET]]][X]
                            gWorld[fielder][TARGET-Z] = gWorld[rBaseCorners[gWorld[fielder][TARGET]]][Z]
                        }
                        if (gWorld[fielder][X] == gWorld[fielder][TARGET-X] && gWorld[fielder][Z] == gWorld[fielder][TARGET-Z]) {
                            rBaseClaims[gWorld[fielder][TARGET]] = fielder
                        }
                    }
                } else if (fielder > FIELDER-RF) {
                    start-script.rec smth_to_do_with_fielding_sometimes_infield fielder
                } else {
                    start-script.rec smth_fielding_outfield fielder
                }
            }
            if (gWorld[fielder][X] == gWorld[fielder][TARGET-X] && gWorld[fielder][Z] == gWorld[fielder][TARGET-Z]) {
                if (actor-get-variable actor 2) {
                    jump L0d51
                }
                actor.init actor
                actor.variable 1 0
                if (bottled_up_emotions < 30) {
                    bottled_up_emotions += random-between 0 1
                } else {
                    if (random 2 == 2) {
                        start-script PlayKidEmoteSound rFieldingOrder[fielder - 37]
                    }
                    bottled_up_emotions = 0
                }
                if (not (smth_turns - r_maybe_smth_turn)) {
                    if gFielderWithBall {
                        angle = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[gFielderWithBall][X] gWorld[gFielderWithBall][Z]
                        next_facing = call-script ConvertAngleToFacing angle
                    } else if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[BALL-SHADOW][X] gWorld[BALL-SHADOW][Z] > 120) {
                        angle = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[BALL-SHADOW][X] gWorld[BALL-SHADOW][Z]
                        next_facing = call-script ConvertAngleToFacing angle
                    } else {
                        next_facing = facing
                    }
                }
                if (gWorld[fielder][TARGET] != BALL-SHADOW) {
                    if (dist_ball_2d < 480) {
                        boredom = 0
                    }
                    if (random 100 > call-script smth_about_kid_data_10_with_randomness rFieldingOrder[fielder - 37]) {
                        inc boredom
                    }
                    if (boredom > 80 || gPlayEndedReason) {
                        if gPlayEndedReason {
                            break-here.multi (random 8)
                            if (random 1) {
                                start-script.rec DoFielderIdle fielder facing actor 30
                            } else {
                                start-script.rec DoFielderIdle fielder facing actor 32
                            }
                        } else {
                            start-script.rec DoFielderIdle fielder facing actor 33
                        }
                        stop-script 0
                    }
                }
                jump L130a
            }
            actor.init actor
            actor.variable 1 1
            angle14 = angle-from-line gWorld[fielder][X] gWorld[fielder][Z] gWorld[fielder][TARGET-X] gWorld[fielder][TARGET-Z]
            if (abs (angle14 - angle) > 5) {
                angle = angle14
            }
        }
        L0d51:
        boredom = 0
        if (actor-get-variable actor 2 && not smth_diving) {
            angle = facing * 22 - 22
            if (actor-get-variable actor 2 == 1) {
                if (random 1) {
                    angle -= random-between 90 270
                    speed = 10
                    do-animation actor 11
                    actor.init actor
                    actor.variable 0 0
                } else {
                    angle += random-between -45 45
                    speed += 5
                    do-animation actor 13
                    actor.init actor
                    actor.variable 0 0
                }
                actor.init actor
                actor.variable 1 0
            } else {
                angle -= random-between 30 60
                actor.init actor
                actor.variable 1 1
            }
            if (angle < 0) {
                angle += 360
            }
        }
        next_facing = call-script ConvertAngleToFacing angle
        if smth_diving {
            if (smth_diving >= smth_stat_3) {
                actor.init actor
                actor.variable 0 1
                temp = actor-get-property actor 0 2 / 4
                if (gFielderWithBall == 0 && g_maybe_last_fielder_to_touch_ball == 0) {
                    if rBallWasHitHigh {
                        start-script EnqueueComment DIALOGUE-CATCH-HIGH-HIT-ERROR rFieldingOrder[fielder - 37]
                    } else {
                        start-script EnqueueComment DIALOGUE-CATCH-LOW-HIT-ERROR rFieldingOrder[fielder - 37]
                    }
                }
                break-here.multi 2
                break-until (actor-get-variable actor 0 == 0)
                do-animation actor 6
                actor.init actor
                actor.variable 1 0
                actor.init actor
                actor.variable 2 0
                smth_diving = 0
                speed = call-script GetKidRunningSpeed rFieldingOrder[fielder - 37]
            } else {
                inc smth_diving
                add_x = cos angle * speed / 100000
                add_y = sin angle * speed / 100000
                he9_angle = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                if he9_angle {
                    inc local23
                    if (call-script AngleDifference he9_angle angle > 120) {
                        he9_angle += 180
                    }
                    add_x = cos he9_angle * speed / 100000
                    add_y = sin he9_angle * speed / 100000
                    he9_angle = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                    if he9_angle {
                        if (call-script AngleDifference he9_angle angle > 120) {
                            he9_angle += 180
                        }
                        add_x = cos he9_angle * speed / 100000
                        add_y = sin he9_angle * speed / 100000
                        he9_angle = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                        if he9_angle {
                            add_x = 0
                            add_y = 0
                        }
                    }
                } else {
                    local23 = 0
                }
                gWorld[fielder][X] = gWorld[fielder][X] + add_x
                gWorld[fielder][Z] = gWorld[fielder][Z] + add_y
                gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
            }
            if ticks_until_catch {
                ticks_until_catch = 0
                actor.init actor
                actor.animation-speed 2
            }
        } else if (not ticks_until_catch) {
            if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] gWorld[fielder][TARGET-X] gWorld[fielder][TARGET-Z] < speed + 1 && actor-get-variable actor 2 == 0) {
                if (not (call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] gWorld[fielder][TARGET-X] gWorld[fielder][TARGET-Z])) {
                    gWorld[fielder][X] = gWorld[fielder][TARGET-X]
                    gWorld[fielder][Z] = gWorld[fielder][TARGET-Z]
                } else {
                    gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                    gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
                }
            } else {
                if (not gBallHasBounced) {
                    if (gWorld[fielder][TARGET] == BALL-SHADOW) {
                        if (not smth_diving) {
                            if (actor-get-variable actor 2 == 0) {
                                if (actor-get-property actor 0 2 / 4 == 10) {
                                    if (actor-get-property actor 0 2 / 4 != 26) {
                                        if (actor-get-variable actor 1 == 1) {
                                            do-animation actor 26
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                add_x = cos angle * speed / 100000
                add_y = sin angle * speed / 100000
                he9_angle = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                if he9_angle {
                    inc local23
                    if (call-script AngleDifference he9_angle angle > 120) {
                        he9_angle += 180
                    }
                    add_x = cos he9_angle * speed / 100000
                    add_y = sin he9_angle * speed / 100000
                    he9_angle = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                    if he9_angle {
                        if (call-script AngleDifference he9_angle angle > 120) {
                            he9_angle += 180
                        }
                        add_x = cos he9_angle * speed / 100000
                        add_y = sin he9_angle * speed / 100000
                        he9_angle = call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y)
                        if he9_angle {
                            add_x = 0
                            add_y = 0
                        }
                    }
                } else {
                    local23 = 0
                }
                gWorld[fielder][X] = gWorld[fielder][X] + add_x
                gWorld[fielder][Z] = gWorld[fielder][Z] + add_y
            }
        }
        actor.init actor
        actor.scale (call-script CalcActorScale fielder)
        L130a:
        next_facing = call-script TurnFacingStep next_facing facing
        start-script.rec SetActorFacing actor next_facing facing
        facing = next_facing
        if (actor-get-variable actor 2 && not smth_diving) {
            if (actor-get-variable actor 2 == 1) {
                start-script.rec ClearFielderTarget fielder
                gWorld[fielder][TARGET] = NONE
                if ticks_until_catch {
                    ticks_until_catch = 0
                    actor.init actor
                    actor.animation-speed 2
                }
                delay = smth_stat_3 + random-between 5 20
                if (random 2) {
                    start-script PlayKidEmoteSound rFieldingOrder[fielder - 37] 7
                }
                bottled_up_emotions = 0
            } else {
                delay = 5 + random-between 0 smth_stat_3
            }
            do {
                break-here
                local15 = 5000 - gWorld[fielder][Z]
                actor.init actor
                actor.elevation local15
                put-actor actor gScreen[fielder][X] (local15 + gScreen[fielder][Y]) 3
                dec delay
                if (actor-get-variable actor 2 == 2) {
                    if (speed > 5) {
                        dec speed
                    }
                } else {
                    speed = speed * 9 / 10
                }
                add_x = cos angle * speed / 100000
                add_y = sin angle * speed / 100000
                if (not (call-script smth_angle_from_he9 gWorld[fielder][X] gWorld[fielder][Z] (gWorld[fielder][X] + add_x) (gWorld[fielder][Z] + add_y))) {
                    gWorld[fielder][X] = gWorld[fielder][X] + add_x
                    gWorld[fielder][Z] = gWorld[fielder][Z] + add_y
                }
            } until (delay < 1 || not g_maybe_smth_play_is_alive)
            if (actor-get-variable actor 2 == 1) {
                gWorld[fielder][TARGET-X] = gWorld[fielder][X]
                gWorld[fielder][TARGET-Z] = gWorld[fielder][Z]
                actor.init actor
                actor.variable 0 1
                break-here.multi 2
                break-until (actor-get-variable actor 0 == 0)
                do-animation actor 6
                actor.init actor
                actor.variable 1 0
            } else {
                actor.init actor
                actor.variable 1 1
            }
            actor.init actor
            actor.variable 2 0
            speed = call-script GetKidRunningSpeed rFieldingOrder[fielder - 37]
            if (not rBallFetcher) {
                start-script SimulateBallStopPosition true
                start-script.rec SendClosestFielderToTarget true
            }
        }
        break-here
    }
}

local-script CastHitNotHighFly@2150 {
    if gSimFirstBounceFoul {
        start-script EnqueueComment DIALOGUE-FOUL-OUTFIELD gBatterKid
        stop-script 0
    }
    if (line-length.2d gSimFirstBounceX gSimFirstBounceZ 0 300 > 1500) {
        if (random 1) {
            if (gSimFirstBounceX == 0) {
                start-script EnqueueComment DIALOGUE-HIT-LINE-DRIVE-CENTER-FIELD gBatterKid
                stop-script 0
            }
            if (abs (gSimFirstBounceZ / gSimFirstBounceX) > 6) {
                start-script EnqueueComment DIALOGUE-HIT-LINE-DRIVE-CENTER-FIELD gBatterKid
                stop-script 0
            } else if (gSimFirstBounceX < 0) {
                start-script EnqueueComment DIALOGUE-HIT-LINE-DRIVE-LEFT-FIELD gBatterKid
                stop-script 0
            } else {
                start-script EnqueueComment DIALOGUE-HIT-LINE-DRIVE-RIGHT-FIELD gBatterKid
                stop-script 0
            }
        } else {
            start-script EnqueueComment DIALOGUE-HIT-LINE-DRIVE-GENERAL gBatterKid
            stop-script 0
        }
    }
    if (line-length.2d gSimFirstBounceX gSimFirstBounceZ 0 300 > 1100) {
        start-script EnqueueComment DIALOGUE-HIT-LINE-DRIVE-GENERAL gBatterKid
        stop-script 0
    }
    if (gCurrentSwing == SWING-BUNT) {
        start-script EnqueueComment DIALOGUE-HIT-BUNT gBatterKid
        stop-script 0
    }
    do {
        break-here
        if gBallHasBounced {
            if (line-length.2d gBallPosX gBallPosZ 0 300 < 1500) {
                if (gBallPosPhysX == 0) {
                    start-script EnqueueComment DIALOGUE-GROUNDER-GENERAL gBatterKid
                    stop-script 0
                }
                if (abs (gBallPosPhysZ / gBallPosPhysX) < 6) {
                    if (abs (gBallPosPhysZ / gBallPosPhysX) < 4) {
                        if (gBallPosPhysX < 0) {
                            start-script EnqueueComment DIALOGUE-GROUNDER-LEFT gBatterKid
                            stop-script 0
                        } else {
                            start-script EnqueueComment DIALOGUE-GROUNDER-RIGHT gBatterKid
                            stop-script 0
                        }
                    } else {
                        start-script EnqueueComment DIALOGUE-GROUNDER-GENERAL gBatterKid
                        stop-script 0
                    }
                } else if (line-length.2d gBallPosX gBallPosZ 0 300 > 652) {
                    if (gBallPosPhysX < 0) {
                        start-script EnqueueComment DIALOGUE-GROUNDER-SHORTSTOP gBatterKid
                        stop-script 0
                    } else {
                        start-script EnqueueComment DIALOGUE-GROUNDER-CENTER gBatterKid
                        stop-script 0
                    }
                } else {
                    start-script EnqueueComment DIALOGUE-GROUNDER-GENERAL gBatterKid
                    stop-script 0
                }
            } else {
                start-script EnqueueComment DIALOGUE-LINE-DRIVE-GAP gBatterKid
                stop-script 0
            }
        }
    } until g_maybe_last_fielder_to_touch_ball
}

local-script StartFieldingWithoutHit@2151 {
    var fielder

    gBallHasBounced = 1
    gBallIsFair = true
    gFieldingTargetX = 0
    gFieldingTargetZ = 317
    rBallFetcher = FIELDER-CACTHER
    rAutoFieldeingDelay = 10
    gWorld[FIELDER-CACTHER][TARGET] = BALL-SHADOW
    for fielder = FIELDER-LF to FIELDER-PITCHER + {
        if (fielder != FIELDER-CACTHER) {
            start-script.rec smth_to_do_with_fielding_sometimes_infield fielder
        }
    }
}

local-script CastHit@2152 fielder {
    var dialogue

    if (gCurrentSwing > SWING-BUNT) {
        break-here.multi 10
        start-script EnqueueComment DIALOGUE-HIT-WITH-POWERUP gBatterKid
        if (in gCurrentSwing [SWING-ALUMINUM-POWER SWING-SCREAMING-LINE-DRIVE]) {
            start-script SetCurrentEmote 9
        }
        stop-script 0
    }
    if rBallWasHitHigh {
        if gSimFirstBounceFoul {
            dialogue = DIALOGUE-HIT-FOUL-OUTFIELD
        } else if (line-length.2d gSimFirstBounceX gSimFirstBounceZ 0 300 > 1600) {
            start-script EnqueueComment DIALOGUE-HIT-TO-OUTFIELD gBatterKid
            start-script SetCurrentEmote 9
            dialogue = DIALOGUE-FIELDER-RUNNING-TO-CATCH-FLY
        } else {
            start-script EnqueueComment DIALOGUE-POP-FLY gBatterKid
            if (gBallVelPhysY > 120000) {
                start-script SetCurrentEmote 9
            }
            dialogue = DIALOGUE-FIELDER-UNDER-POP-FLY
        }
        break-here.multi (call-script smth_kid_data_3_with_fatigue rFieldingOrder[fielder - 37])
        break-here.multi 10
        if (gBallHasBounced || g_maybe_last_fielder_to_touch_ball) {
            stop-script 0
        }
        start-script EnqueueComment dialogue rFieldingOrder[fielder - 37]
    } else {
        start-script CastHitNotHighFly
    }
}

local-script StartFieldingAfterHit@2153 {
    var ball_x ball_z ball_time f time i local6 local7 local8 chaser min_cost min_fielder local12 local13

    do {
        ball_time = gBallPath[i][2]
        if (ball_time == DEAD-BALL) {
            i = 100
        }
        ball_x = gBallPath[i][0]
        ball_z = gBallPath[i][1]
        for f = FIELDER-LF to FIELDER-PITCHER + {
            if (gWorld[f][TARGET] == NONE) {
                if (in gDifficulty [EASY TEE-BALL] && gDefenseControlledBy == CB-USER || (gDifficulty == HARD && gDefenseControlledBy == CB-COMPUTER)) {
                    local12 = 100
                } else {
                    local12 = call-script smth_about_kid_data_2_and_errors rFieldingOrder[f - 37]
                }
                if (local12 > random 100) {
                    time = call-script CalcFielderTimeRunToPoint f ball_x ball_z 1
                } else {
                    time = call-script CalcFielderTimeRunToPoint f ball_x ball_z
                }
                if (gDefenseControlledBy == CB-COMPUTER) {
                    time += 10
                }
                if (time < ball_time || ball_time == DEAD-BALL) {
                    if (ball_time == DEAD-BALL) {
                        gWorld[f][Y] = 200
                    } else {
                        gWorld[f][Y] = ball_time
                    }
                    if (time == 36) {
                        inc time
                    }
                    gWorld[f][TARGET] = time
                    gWorld[f][TARGET-X] = ball_x
                    gWorld[f][TARGET-Z] = ball_z
                }
            }
        }
        inc i
    } until (i == 101)
    for local6 = 0 to 4 + {
        if (min_cost == 0) {
            min_cost = 10000
        } else {
            min_cost += 10
        }
        min_fielder = 0
        for f = FIELDER-LF to FIELDER-PITCHER + {
            if (gWorld[f][TARGET] != BALL-SHADOW) {
                if (gWorld[f][TARGET] < min_cost) {
                    local7 = call-script smth_about_kid_data_12_with_fatigue rFieldingOrder[f - 37]
                    if (f == FIELDER-1B) {
                        local7 -= 25
                    }
                    if (random-between (local6 * 30) (local6 * 50 + 1) < local7) {
                        min_cost = gWorld[f][TARGET]
                        min_fielder = f
                    } else {
                        gWorld[f][TARGET] = F-HOME
                        gWorld[f][TARGET-X] = gWorld[f][X]
                        gWorld[f][TARGET-Z] = gWorld[f][Z]
                    }
                }
            }
        }
        if (min_fielder != 0) {
            gWorld[min_fielder][TARGET] = BALL-SHADOW
            if rBallWasHitHigh {
                if (in gDifficulty [EASY TEE-BALL] && gDefenseControlledBy == CB-USER || (gDifficulty == HARD && gDefenseControlledBy == CB-COMPUTER)) {
                    local8 = 1
                } else {
                    local8 = call-script FielderBallPredictionCheck rFieldingOrder[min_fielder - 37]
                }
                gWorld[min_fielder][TARGET-X] = gWorld[min_fielder][TARGET-X] + random-between (-2 * local8) (2 * local8)
                gWorld[min_fielder][TARGET-Z] = gWorld[min_fielder][TARGET-Z] + random-between (-2 * local8) (2 * local8)
            }
            if (rBallFetcher == 0) {
                rBallFetcher = min_fielder
                local13 = min_cost
                rAutoFieldeingDelay = gWorld[min_fielder][Y] + 1
            }
        }
    }
    for f = FIELDER-LF to FIELDER-PITCHER + {
        if (gWorld[f][TARGET] != BALL-SHADOW) {
            gWorld[f][TARGET] = NONE
            gWorld[f][TARGET-X] = gWorld[f][X]
            gWorld[f][TARGET-Z] = gWorld[f][Z]
        }
        gWorld[f][Y] = 0
    }
    gFieldingTargetX = gBallPath[100][0]
    gFieldingTargetZ = gBallPath[100][1]
    chaser = call-script FindClosestFielder gFieldingTargetX gFieldingTargetZ
    if (chaser != rBallFetcher) {
        if (gWorld[chaser][TARGET] == NONE) {
            if (gDifficulty == HARD || (gDifficulty == MEDIUM && not (random 3))) {
                gWorld[rBallFetcher][TARGET] = BALL-SHADOW
                rBallFetcher = chaser
            } else {
            }
            gWorld[chaser][TARGET-X] = gFieldingTargetX
            gWorld[chaser][TARGET-Z] = gFieldingTargetZ
            gWorld[chaser][TARGET] = BALL-SHADOW
        }
    }
    for f = FIELDER-LF to FIELDER-PITCHER + {
        if (gWorld[f][TARGET] == NONE) {
            start-script.rec smth_to_do_with_fielding_sometimes_infield f
        }
    }
    start-script CastHit chaser
    if (local13 < rAutoFieldeingDelay) {
        room37 = 1
    }
}

local-script StartDefense@2154 {
    if gEnableHumongousVision {
    } else {
        object.class 73 [160]
    }
    rDefenseSentiment = 0
    gWorld[FIELDER-LF][TARGET] = NONE
    gWorld[FIELDER-CF][TARGET] = NONE
    gWorld[FIELDER-RF][TARGET] = NONE
    gWorld[FIELDER-3B][TARGET] = NONE
    gWorld[FIELDER-2B][TARGET] = NONE
    gWorld[FIELDER-1B][TARGET] = NONE
    gWorld[FIELDER-SS][TARGET] = NONE
    gWorld[FIELDER-CACTHER][TARGET] = NONE
    gWorld[FIELDER-PITCHER][TARGET] = NONE
    rFieldingOrder = gTeamInfo[abs (gBattingTeamInfoIndex - 1)][TI-FIELDING-ORDER]
    gUserSelectedPlay = NONE
    if (gDefenseControlledBy == CB-USER) {
        if g_smth_play_may_continue {
            stop-script CursorLoop
            gInputHandlerScript = HandleInputDefense
            if (gGameInputDevice == INPUT-DEVICE-MOUSE) {
                start-script MouseCursorLoopDefense
                gCursorLoopScript = MouseCursorLoopDefense
                start-script smth_mouse_user_defense
            } else if (gGameInputDevice == INPUT-DEVICE-GAME-PAD) {
                start-script GamepadCursorLoopDefense
                gCursorLoopScript = GamepadCursorLoopDefense
            }
        }
        userput-on
        cursor-off
    } else {
        userput-on
        if (gUIInputDevice == INPUT-DEVICE-MOUSE) {
            cursor-on
        } else if (gCursorInputEnabled == 0) {
            stop-script GamePadCursorLoop
            start-script ReleaseSprite gGamePadCursorSprite
            gGamePadCursorSprite = 0
        } else {
            start-script ShowGamePadCursor
        }
    }
    start-script smth_actor_until_play_ends
    if rBaseClaims {
        undim rBaseClaims
    }
    dim-array.i16 rBaseClaims 4
    start-script SetBaseCorners 1
    gFielderWithBall = 0
    rBallFetcher = 0
    g_maybe_smth_play_is_alive = 1
    room6 = 0
    g_maybe_last_fielder_to_touch_ball = 0
    rCurrentPlay = NONE
    start-script smth_turns_loop
    if (gDefenseControlledBy != CB-NETWORK) {
        if g_smth_play_may_continue {
            if gBallWasHit {
                start-script StartFieldingAfterHit
            } else {
                start-script StartFieldingWithoutHit
            }
        }
    }
    break-until (gRanWorldTransform == true)
    if (gDefenseControlledBy != CB-NETWORK) {
        start-script.rec DoFielderLoop FIELDER-3B
        start-script.rec DoFielderLoop FIELDER-2B
        start-script.rec DoFielderLoop FIELDER-1B
        start-script.rec DoFielderLoop FIELDER-SS
        start-script.rec DoFielderLoop FIELDER-CACTHER
        start-script.rec DoFielderLoop FIELDER-PITCHER
        start-script.rec DoFielderLoop FIELDER-LF
        start-script.rec DoFielderLoop FIELDER-CF
        start-script.rec DoFielderLoop FIELDER-RF
    }
    if (gDefenseControlledBy != CB-NETWORK) {
        if g_smth_play_may_continue {
            start-script CountDownAutoFieldingDelay
            start-script FielderCollisionLoop
            start-script WatchForFielderTaggingRunnerOut
            start-script WatchForFoulBall
            if rBallWasHitHigh {
                if (gDefenseControlledBy == CB-USER) {
                    start-script DrawBallLandingCircle
                }
                start-script WatchForInfieldFly
            }
        }
    }
    start-script CommentaryLoop
    start-script maybe_record_replay_then_wait_to_cast_end_of_play
    start-script smth_wait_for_play_ended
}

local-script GamepadCursorLoopDefense@2155 {
    var local0 local1 local2 local3 local4 local5 local6

    do {
        local0 = call-script GetInputButtons BUTTONS-GAME-PAD
        case 1 {
            (band 16 local0 > 0) {
                if gFielderWithBall {
                    case 1 {
                        (band 4 local0 > 0) {
                            local6 = 2
                        }
                        (band 1 local0 > 0) {
                            local6 = 3
                        }
                        (band 8 local0 > 0) {
                            local6 = 0
                        }
                        (band 2 local0 > 0) {
                            local6 = 1
                        }
                        else {
                            local6 = 4
                        }
                    }
                    start-script maybe_smth_gamepad_defense local6
                }
                break-here.multi 3
            }
            (band 32 local0 > 0) {
                local4 = call-script FindClosestFielder gWorld[BALL-SHADOW][X] gWorld[BALL-SHADOW][Z]
                local1 = local4 - 30
                local2 = actor-get-x local1
                local3 = actor-get-y local1 - actor-get-elevation local1
                start-script smth_cursor_input_defense local2 local3
                break-here.multi 3
            }
            (band 64 local0 > 0) {
            }
            (band 128 local0 > 0) {
            }
            else {
                if room6 {
                    if (room6 == local5) {
                        if (band 15 local0) {
                            local1 = room6 - 30
                            local2 = actor-get-x local1
                            local3 = actor-get-y local1 - actor-get-elevation local1
                            if (band 1 local0 > 0) {
                                local2 -= 5
                            }
                            if (band 2 local0 > 0) {
                                local2 += 5
                            }
                            if (band 8 local0 > 0) {
                                local3 += 5
                            }
                            if (band 4 local0 > 0) {
                                local3 -= 5
                            }
                            start-script maybe_smth_gamepad_defense -1 local2 local3
                            break-here
                        }
                    } else {
                        gUserSelectedPlay = NONE
                        local5 = room6
                    }
                } else {
                    gUserSelectedPlay = NONE
                }
            }
        }
        break-here
    }
}

local-script GampadCursorLoopOffense@2156 {
    var local0 local1 local2 local3 local4 local5 local6

    gRunnerCursorIndex = NONE
    if gStealing {
        for local1 = 0 to 3 + {
            if (gRunners[local1][R-STATE] == R-STEALING) {
                gRunnerCursorIndex = local1
                local1 = 3 + 1
            }
        }
        gRunnerCursorDestinationBase = gRunners[gRunnerCursorIndex][R-DEST-BASE]
    } else {
        for local1 = 0 to 3 + {
            if (gRunners[local1][R-KID] == gBatterKid) {
                gRunnerCursorIndex = local1
                local1 = 3 + 1
            }
        }
        gRunnerCursorDestinationBase = FIRST
    }
    start-script DrawNameUnderRunner gRunnerCursorIndex
    do {
        local0 = call-script GetInputButtons BUTTONS-GAME-PAD
        if (band 16 local0 > 0) {
            if (gRunnerCursorIndex != NONE) {
                local2 = gRunnersExtra[gRunnerCursorIndex][RE-SPRINT]
                if local2 {
                    if (local2 == 1) {
                        local2 = 6
                    } else if (local2 < 30) {
                        local2 += 3
                    }
                } else {
                    local2 = 1
                }
                gRunnersExtra[gRunnerCursorIndex][RE-SPRINT] = local2
                break-here.multi 2
            }
        }
        if (band 32 local0 > 0) {
            if (gNumRunners >= 1) {
                if (gRunnerCursorIndex != NONE) {
                    local1 = 0
                    local3 = 0
                    while (gBases[local1][BASE-RUNNERIDX] != gRunnerCursorIndex) {
                        local1 = iif (local1 == 4) 0 (local1 + 1)
                        inc local3
                        if (local3 > 10) {
                            local1 = -1
                            jump L0160
                        }
                    }
                } else {
                    local1 = -1
                }
                do {
                    L0160:
                    local1 = iif (local1 == 4) 0 (local1 + 1)
                } until (gBases[local1][BASE-RUNNERIDX] != NONE)
                gRunnerCursorIndex = gBases[local1][BASE-RUNNERIDX]
                gRunnerCursorDestinationBase = gRunners[gRunnerCursorIndex][R-DEST-BASE]
                start-script DrawNameUnderRunner gRunnerCursorIndex
            } else {
            }
            break-here.multi 3
        }
        if (band 15 local0) {
            if (gRunnerCursorIndex != NONE) {
                local4 = gRunners[gRunnerCursorIndex][R-CUR-BASE]
                local5 = gRunners[gRunnerCursorIndex][R-DEST-BASE]
                if (local5 == 999) {
                    local5 = local4
                } else if (gRunners[gRunnerCursorIndex][R-DIRECTION] == BACKWARD) {
                    local5 = local4
                }
                case 1 {
                    (band 1 local0 > 0) {
                        local6 = 3
                    }
                    (band 2 local0 > 0) {
                        local6 = 1
                    }
                    (band 4 local0 > 0) {
                        local6 = 2
                    }
                    (band 8 local0 > 0) {
                        local6 = 4
                    }
                    else {
                    }
                }
                if gRunners[gRunnerCursorIndex][R-DIRECTION] {
                    if (local6 > local5 && gRunners[gRunnerCursorIndex][R-DIRECTION] != BACKWARD) {
                        jump L02b0
                    }
                    if (local6 < local5 && gRunners[gRunnerCursorIndex][R-DIRECTION] != FORWARD) {
                        jump L02b0
                    }
                }
                if (abs (local6 - local5) == 1) {
                    gRunnerCursorDestinationBase = local6
                    start-script maybe_handle_basepath_click 2
                }
            }
            L02b0:
            break-here.multi 3
        }
        break-here
    }
}

local-script smth_mouse_user_defense@2157 {
    var local0 local1 local2 local3 local4 local5

    if gNetplayActive {
    }
    break-here
    actor.init 21
    actor.new
    actor.costume costume562
    actor.ignore-boxes
    actor.animation-speed 2
    actor.shadow global424
    local1 = 999
    do {
        if (gUserSelectedPlay != NONE) {
            local0 = gUserSelectedPlay
        } else if (rCurrentPlay != NONE) {
            if (local1 == rCurrentPlay) {
                local0 = rCurrentPlay
            } else {
                local1 = 999
                local0 = 999
            }
        } else {
            local0 = 999
        }
        local2 = 0
        local3 = 0
        if (local0 != 999) {
            if (local0 >= 0 && local0 <= 3) {
                case local0 {
                    1 {
                        local3 = -21
                        local2 = 10
                    }
                    2 {
                        local2 = 15
                    }
                    3 {
                        local3 = 21
                        local2 = 10
                    }
                    else {
                    }
                }
                if (gBases[local0][BASE-TAGGED-WITH-BALL] == true) {
                    local0 = 999
                }
            } else if (local0 >= 37 && local0 <= 45) {
                if (gFielderWithBall == local0) {
                    local0 = 999
                }
            } else if (in local0 [46 47 48 49]) {
                if (gRunners[local0 - 46][R-STATE] == R-LEAVE-FIELD-WITH-OUT) {
                    local0 = 999
                }
            }
        }
        if (local0 != 999) {
            actor.init 21
            actor.scale (call-script CalcActorScale local0)
            local4 = gScreen[local0][X] + local3
            local5 = gScreen[local0][Y] + local2
            put-actor 21 local4 local5 3
            if (local1 != local0) {
                local1 = local0
                do-animation 21 7
            }
        } else {
            do-animation 21 1
        }
        break-here
    } until (not g_maybe_smth_play_is_alive)
    put-actor 21 0 0 0
}

local-script MouseCursorLoopDefense@2158 {
    var x y local2 local3 local4

    debug-string 0 "no trace"
    break-here
    actor.init 20
    actor.new
    actor.costume costume562
    actor.ignore-boxes
    actor.elevation 1000
    actor.shadow global424
    put-actor 20 0 0 3
    do {
        x = gMouseX
        y = gMouseY
        if gNetplayActive {
            local4 = 0
            local2 = find-sprite x y 0 0 []
            if local2 {
                local3 = sprite-get-variable local2 1
                if (local3 == 344) {
                    local4 = 1
                    cursor-on
                    if (g_maybe_operating_system == 2) {
                        cursor-color-image (4 + 2)
                        gCursorImage = 4 + 2
                    } else if (4 <= 76 || in 4 [82 85 91 88 79 95]) {
                        cursor-image (4 + 1)
                        gCursorImage = 4 + 1
                    } else if (gBlackAndWhiteCursors || 4 == 1) {
                        cursor-image (4 + 1)
                        gCursorImage = 4 + 1
                    } else {
                        cursor-color-image 4
                        gCursorImage = 4
                    }
                    put-actor 20 -500 -500 255
                }
            }
            if (not local4) {
                cursor-off
                jump L0102
            }
        } else {
            L0102:
            start-script TransformUserInputVector x y 1
            actor.init 20
            actor.scale (call-script CalcActorScale 58)
            put-actor 20 gScreen[LAST-HOVER-FIELDING][X] (gScreen[LAST-HOVER-FIELDING][Y] + 1000) 255
            do-animation 20 6
        }
        break-here
    } until (not g_maybe_smth_play_is_alive || in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-INFIELD-FLY PE-OUT-OF-PLAY] || gBallIsFoul)
    gUserSelectedPlay = NONE
    put-actor 20 0 0 0
    if gNetplayActive {
        cursor-on
        do {
            local2 = find-sprite x y 0 0 []
            if local2 {
                local3 = sprite-get-variable local2 1
                if (local3 == 344) {
                    if (g_maybe_operating_system == 2) {
                        cursor-color-image (4 + 2)
                        gCursorImage = 4 + 2
                    } else if (4 <= 76 || in 4 [82 85 91 88 79 95]) {
                        cursor-image (4 + 1)
                        gCursorImage = 4 + 1
                    } else if (gBlackAndWhiteCursors || 4 == 1) {
                        cursor-image (4 + 1)
                        gCursorImage = 4 + 1
                    } else {
                        cursor-color-image 4
                        gCursorImage = 4
                    }
                } else if (g_maybe_operating_system == 2) {
                    cursor-color-image (1 + 2)
                    gCursorImage = 1 + 2
                } else if (1 <= 76 || in 1 [82 85 91 88 79 95]) {
                    cursor-image (1 + 1)
                    gCursorImage = 1 + 1
                } else if (gBlackAndWhiteCursors || 1 == 1) {
                    cursor-image (1 + 1)
                    gCursorImage = 1 + 1
                } else {
                    cursor-color-image 1
                    gCursorImage = 1
                }
            }
            break-here
        }
    }
    debug-string 0 "trace on"
}

local-script smth_actor_until_play_ends@2159 {
    var local0 local1

    break-here
    actor.init 23
    actor.new
    actor.costume costume562
    actor.animation-speed 2
    actor.ignore-boxes
    actor.elevation 1000
    actor.shadow global424
    put-actor 23 0 0 3
    do {
        if (gFielderWithBall > 1) {
            local1 = gFielderWithBall - 30
            actor.init 23
            actor.scale (actor-get-scale local1)
            actor.elevation (actor-get-elevation local1 - 1)
            actor.at (actor-get-x local1) (actor-get-y local1 - 1)
            if (local0 != gFielderWithBall) {
                local0 = gFielderWithBall
                do-animation 23 8
            }
        } else {
            do-animation 23 1
        }
        break-here
    } until (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-INFIELD-FLY PE-OUT-OF-PLAY])
    put-actor 23 0 0 0
}

local-script LastClickedBaseOrRunner@2160 threshold {
    var local1 local2

    if (not threshold) {
        threshold = 192
    }
    local2 = -1
    for local1 = 0 to 4 + {
        if (rBaseClaims[local1] != gFielderWithBall) {
            if (line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[local1][X] gWorld[local1][Z] < threshold) {
                local2 = local1
                threshold = line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[local1][X] gWorld[local1][Z]
            }
        }
    }
    for local1 = 46 to 49 + {
        if (gRunners[local1 - 46][R-DIRECTION] != 0) {
            if (line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[local1][X] gWorld[local1][Z] < threshold) {
                if (gRunners[local1 - 46][R-DEST-BASE] != local2) {
                    local2 = local1
                    threshold = line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[local1][X] gWorld[local1][Z]
                }
            }
        }
    }
    return local2
}

local-script smth_cursor_input_defense@2161 x y arg2 {
    var local3 local4 fielder ball_fielder local7

    if (not x && not y) {
        start-script TransformUserInputVector gMouseX gMouseY
    } else {
        start-script TransformUserInputVector x y
    }
    if gFielderWithBall {
        if (gUserSelectedPlay != NONE) {
            stop-script 0
        }
        local7 = call-script LastClickedBaseOrRunner
        if (local7 != -1) {
            gUserSelectedPlay = local7
            stop-script 0
        }
        if (not arg2) {
            local4 = 192
            for local3 = 37 to 45 + {
                if (local3 != gFielderWithBall) {
                    if (line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[local3][X] gWorld[local3][Z] < local4) {
                        local4 = line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[local3][X] gWorld[local3][Z]
                        fielder = local3
                    }
                }
            }
        }
        if (fielder && fielder != gFielderWithBall) {
            gWorld[LAST-CLICK-FIELDING][X] = gWorld[fielder][X]
            gWorld[LAST-CLICK-FIELDING][Z] = gWorld[fielder][Z]
            if (gWorld[fielder][TARGET] == BALL-SHADOW) {
                gWorld[fielder][TARGET] = NONE
            }
            gUserSelectedPlay = fielder
        } else {
            if g_maybe_play_is_ready_to_end {
                if (line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[MOUND-CENTER][X] gWorld[MOUND-CENTER][Z] < 192) {
                    gUserSelectedPlay = MOUND
                    stop-script 0
                }
            }
            gUserSelectedPlay = LAST-CLICK-FIELDING
        }
    } else {
        if (call-script DistanceToBall2D LAST-CLICK-FIELDING < 192) {
            gUserSelectedPlay = BALL-SHADOW
            gFieldingTargetX = gWorld[BALL-SHADOW][X]
            gFieldingTargetZ = gWorld[BALL-SHADOW][Z]
            start-script.rec SendClosestFielderToTarget
            stop-script 0
        }
        for local3 = 0 to 3 + {
            if (line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[local3][X] gWorld[local3][Z] < 192) {
                gUserSelectedPlay = local3
                stop-script 0
            }
        }
        if (not arg2) {
            fielder = call-script FindClosestFielder gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z]
            ball_fielder = call-script FindClosestFielder gWorld[BALL-SHADOW][X] gWorld[BALL-SHADOW][Z]
            if (line-length.2d gWorld[LAST-CLICK-FIELDING][X] gWorld[LAST-CLICK-FIELDING][Z] gWorld[fielder][X] gWorld[fielder][Z] < 192 && fielder != ball_fielder) {
                gUserSelectedPlay = fielder
                if (gWorld[fielder][TARGET] == BALL-SHADOW) {
                    gWorld[fielder][TARGET] = NONE
                }
                stop-script 0
            }
        }
        gUserSelectedPlay = LAST-CLICK-FIELDING
        gFieldingTargetX = gWorld[LAST-CLICK-FIELDING][X]
        gFieldingTargetZ = gWorld[LAST-CLICK-FIELDING][Z]
        start-script.rec SendClosestFielderToTarget
    }
}

local-script maybe_smth_gamepad_defense@2162 arg0 x y {
    var local3

    if (arg0 != -1) {
        gUserSelectedPlay = arg0
    } else {
        start-script TransformUserInputVector x y
        if gFielderWithBall {
            local3 = call-script LastClickedBaseOrRunner 100
            if (local3 < 0 || local3 > 4) {
                local3 = -1
            }
            if (local3 != -1) {
                if (local3 == gWorld[gFielderWithBall][TARGET]) {
                } else {
                    gWorld[gFielderWithBall][TARGET] = local3
                }
            } else {
                gWorld[gFielderWithBall][TARGET] = NONE
            }
        }
        gUserSelectedPlay = LAST-CLICK-FIELDING
        gFieldingTargetX = gWorld[LAST-CLICK-FIELDING][X]
        gFieldingTargetZ = gWorld[LAST-CLICK-FIELDING][Z]
        start-script.rec SendClosestFielderToTarget
    }
}

local-script HandleInputDefense@2163 type key arg2 x y {
    var local5 local6

    if global596 {
        chain-script DefaultHandleInput type key arg2 x y
    }
    if (type == INPUT-TYPE-MOUSE) {
        if gNetplayActive {
            local5 = find-sprite gMouseX gMouseY 0 0 []
            if local5 {
                local6 = sprite-get-variable local5 1
                if (local6 == 344) {
                    start-script maybe_net_send_thumbs_up_or_down local5
                    stop-script 0
                }
            }
        }
        if (not g_maybe_smth_play_is_alive || in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-INFIELD-FLY PE-OUT-OF-PLAY] || gBallIsFoul) {
            stop-script 0
        }
        if (gGameInputDevice == INPUT-DEVICE-MOUSE) {
            start-script smth_cursor_input_defense
        }
    } else {
        if (type == INPUT-TYPE-KEYBOARD) {
            case key {
                ['1' '2' '3' '4'] {
                    start-script maybe_net_send_thumbs_up_or_down global579[key - 49 + 1]
                    stop-script 0
                }
                27 {
                    if (not gNetplayActive) {
                        if (in gPlayEndedReason [PE-HOME-RUN PE-GROUND-RULE-DOUBLE 9 PE-BASE-ON-BALLS 4 PE-OUT-OF-PLAY 6 7] || (r_smth_fly_caught_runners_must_return && gBallIsFoul)) {
                            start-script maybe_handle_esc_skip_play
                            stop-script 0
                        }
                    }
                }
                else {
                }
            }
        }
        chain-script DefaultHandleInput type key arg2 x y
    }
}

local-script DrawBallLandingCircle@2164 {
    var local0 local1 local2 fielder local4 local5 local6 local7 local8 local9 local10 local11 local12 local13 local14 local15 local16 local17

    local2 = 10000
    for local0 = 37 to 45 + {
        if (gWorld[local0][TARGET] == BALL-SHADOW) {
            local1 = call-script CalcFielderTimeRunToPoint local0 gSimFirstBounceX gSimFirstBounceZ 1
            if (local1 < local2) {
                local2 = local1
                fielder = local0
            }
        }
    }
    if (not fielder) {
        fielder = call-script FindClosestFielder gSimFirstBounceX gSimFirstBounceZ
    }
    if (gDifficulty == EASY && gDefenseControlledBy == CB-USER || (gDifficulty == HARD && gDefenseControlledBy == CB-COMPUTER)) {
        local4 = 1
    } else {
        local4 = call-script FielderBallPredictionCheck rFieldingOrder[fielder - 37]
    }
    local5 = random (2 * local4)
    local6 = random 359
    local7 = cos local6 * local5 / 100000 + gSimFirstBounceX
    local8 = sin local6 * local5 / 100000 + gSimFirstBounceZ
    local9 = 2 * local4 + 60
    gWorld[LANDING-CIRCLE-TOP-LEFT][X] = local7 - local9
    gWorld[LANDING-CIRCLE-TOP-LEFT][Y] = 0
    gWorld[LANDING-CIRCLE-TOP-LEFT][Z] = local8 + local9
    gWorld[LANDING-CIRCLE-TOP-RIGHT][X] = local7 + local9
    gWorld[LANDING-CIRCLE-TOP-RIGHT][Y] = 0
    gWorld[LANDING-CIRCLE-TOP-RIGHT][Z] = local8 + local9
    gWorld[LANDING-CIRCLE-BOTTOM-RIGHT][X] = local7 + local9
    gWorld[LANDING-CIRCLE-BOTTOM-RIGHT][Y] = 0
    gWorld[LANDING-CIRCLE-BOTTOM-RIGHT][Z] = local8 - local9
    gWorld[LANDING-CIRCLE-BOTTOM-LEFT][X] = local7 - local9
    gWorld[LANDING-CIRCLE-BOTTOM-LEFT][Y] = 0
    gWorld[LANDING-CIRCLE-BOTTOM-LEFT][Z] = local8 - local9
    break-here
    if (gScreen[LANDING-CIRCLE-TOP-LEFT][X] > gScreen[LANDING-CIRCLE-BOTTOM-LEFT][X]) {
        local10 = gScreen[LANDING-CIRCLE-BOTTOM-LEFT][X]
    } else {
        local10 = gScreen[LANDING-CIRCLE-TOP-LEFT][X]
    }
    if (gScreen[LANDING-CIRCLE-TOP-RIGHT][X] > gScreen[LANDING-CIRCLE-BOTTOM-RIGHT][X]) {
        local12 = gScreen[LANDING-CIRCLE-TOP-RIGHT][X]
    } else {
        local12 = gScreen[LANDING-CIRCLE-BOTTOM-RIGHT][X]
    }
    if (gScreen[LANDING-CIRCLE-TOP-LEFT][Y] > gScreen[LANDING-CIRCLE-TOP-RIGHT][Y]) {
        local11 = gScreen[LANDING-CIRCLE-TOP-RIGHT][Y]
    } else {
        local11 = gScreen[LANDING-CIRCLE-TOP-LEFT][Y]
    }
    if (gScreen[LANDING-CIRCLE-BOTTOM-RIGHT][Y] > gScreen[LANDING-CIRCLE-BOTTOM-LEFT][Y]) {
        local13 = gScreen[LANDING-CIRCLE-BOTTOM-RIGHT][Y]
    } else {
        local13 = gScreen[LANDING-CIRCLE-BOTTOM-LEFT][Y]
    }
    if (local10 < 0) {
        local10 = 0
    }
    if (local10 > 639 || local12 < 0) {
        stop-script 0
    }
    if (local12 > 639) {
        local12 = 639
    }
    if (local11 < 0) {
        local11 = 0
    }
    if (local11 > 479 || local13 < 0) {
        stop-script 0
    }
    local15 = local12 - local10
    local16 = local13 - local11
    image.init image495
    image.new
    image.width local15
    image.height local16
    image.end
    image.init image495
    image.draw-box 0 0 local15 local16 (palette-get-color 1 5)
    image.end
    image.init image496
    image.new
    image.width local15
    image.height local16
    image.end
    image.init image496
    image.draw-box 0 0 local15 local16 (palette-get-color 1 5)
    image.end
    set-polygon-local 2 0 0 local15 0 local15 local16 0 local16
    local17 = 2
    image.init image482
    image.polygon 2
    image.state local17
    image.render-target image495
    image.draw
    image.end
    image.init image482
    image.polygon 2
    image.state 1
    image.render-target image496
    image.draw
    image.end
    sprite.init 4
    sprite.new
    sprite.image image495
    sprite.at local10 local11
    sprite.order -1
    sprite.animation-type 0
    sprite.shadow global425
    sprite.update-type 0
    do {
        fielder = call-script FindClosestFielder gSimFirstBounceX gSimFirstBounceZ
        if (line-length.2d gWorld[fielder][X] gWorld[fielder][Z] (gSimFirstBounceX - gBallVelPhysX / 1000) (gSimFirstBounceZ - gBallVelPhysZ / 1000) < 36) {
            if (local14 != 1) {
                sprite.init 4
                sprite.image image496
                sprite.update-type 0
                sprite.shadow global424
                local14 = 1
            }
        } else if (local14 != 0) {
            sprite.init 4
            sprite.image image495
            sprite.update-type 0
            sprite.shadow global424
            local14 = 0
        }
        break-here
    } until (gFielderWithBall || gBallHasBounced)
    sprite.init 4
    sprite.new
    delete-one-polygon 2
}

local-script NetSendLoop@2165 {
    var local0 local1 local2 local3 local4 local5 local6 local7 local8 local9 local10

    do {
        local8 = 1 - local8
        if local8 {
            gNetStateBuffer[2][0] = actor-get-x 3
            gNetStateBuffer[2][1] = actor-get-y 3
            gNetStateBuffer[2][2] = actor-get-elevation 3
            gNetStateBuffer[2][3] = actor-get-scale 3
            gNetStateBuffer[3][0] = actor-get-x 4
            gNetStateBuffer[3][1] = actor-get-y 4
            gNetStateBuffer[3][2] = actor-get-elevation 4
            gNetStateBuffer[3][3] = actor-get-scale 4
            for local0 = 7 to 15 + {
                gNetStateBuffer[local0 - 3][0] = actor-get-x local0
                gNetStateBuffer[local0 - 3][1] = actor-get-y local0
                gNetStateBuffer[local0 - 3][2] = actor-get-elevation local0
                gNetStateBuffer[local0 - 3][3] = actor-get-scale local0
                local7 = kludge-call 1969 local0
                local7 >>= 16
                gNetStateBuffer[local0 - 3][4] = local7
                local7 = actor-get-variable local0 1 * 10 + actor-get-variable local0 2
                gNetStateBuffer[local0 - 3][5] = local7 << 8
                local7 = actor-get-property local0 0 2
                local7 /= 4
                gNetStateBuffer[local0 - 3][3] = gNetStateBuffer[local0 - 3][3] + local7 << 8
            }
            for local0 = 16 to 19 + {
                if (actor-get-room local0) {
                    gNetStateBuffer[local0 - 3][0] = actor-get-x local0
                    gNetStateBuffer[local0 - 3][1] = actor-get-y local0
                    gNetStateBuffer[local0 - 3][2] = actor-get-elevation local0
                    gNetStateBuffer[local0 - 3][3] = actor-get-scale local0
                    local7 = kludge-call 1969 local0
                    local7 >>= 16
                    gNetStateBuffer[local0 - 3][4] = local7
                    local7 = actor-get-variable local0 1 * 10 + actor-get-variable local0 2
                    gNetStateBuffer[local0 - 3][5] = local7 << 8
                    local7 = actor-get-property local0 0 2
                    local7 /= 4
                    gNetStateBuffer[local0 - 3][3] = gNetStateBuffer[local0 - 3][3] + local7 << 8
                }
            }
            gNetStateBuffer[21][5] = gBallIsFoul
            gNetStateBuffer[3][5] = gPlayEndedReason
            gNetStateBuffer[2][4] = g_maybe_net_fielders_dirty_mask
            gNetStateBuffer[18][5] = gNumOuts
            gNetStateBuffer[18 + 1][5] = gFielderWithBall
            if gRunners {
                for local0 = 0 to 3 + {
                    gNetStateBuffer[18 + local0][0] = gRunners[local0][R-DEST-X]
                    gNetStateBuffer[18 + local0][1] = gRunners[local0][R-DEST-Z]
                    local2 = gRunners[local0][R-CUR-BASE]
                    if (local2 == 999) {
                        local2 = 8
                    } else {
                    }
                    local1 = gRunners[local0][R-DEST-BASE]
                    if (local1 == 999) {
                        local1 = 8
                    } else {
                    }
                    local1 <<= 4
                    local3 = gRunners[local0][R-ENTITY]
                    local3 <<= 8
                    gNetStateBuffer[18 + local0][2] = local2 + local1 + local3
                    local6 = gRunners[local0][R-ORDER]
                    if (local6 == 999) {
                        local6 = 15
                    }
                    local6 <<= 1
                    if room28[local0] {
                        local6 += 32
                    }
                    if room29[local0] {
                        local6 += 64
                    }
                    local6 <<= 8
                    gNetStateBuffer[18 + local0][3] = gRunners[local0][R-KID] + local6
                    local4 = gRunners[local0][R-STATE]
                    local4 <<= 8
                    local5 = gRunners[local0][R-DIRECTION] << 4
                    gNetStateBuffer[18 + local0][4] = local4 + local5 + gRunners[local0][R-FORCED]
                }
            } else {
                array-assign-list gNetStateBuffer 18 (18 + 3) 0 0 [8]
            }
            if gBases {
                for local0 = 0 to 4 + {
                    local9 = gBases[local0][BASE-RUNNERIDX]
                    if (local9 == 999) {
                        local9 = 8
                    } else {
                    }
                    local9 <<= 8
                    local10 = gBases[local0][BASE-TAGGED-WITH-BALL]
                    if (local10 == 999) {
                        local10 = 8
                    } else {
                    }
                    gNetStateBuffer[17][local0] = local9 + local10
                }
            } else {
                array-assign-list gNetStateBuffer 17 17 0 4 [2048]
            }
            start-script.rec maybe_smth_net_send_array 20 1 gNetStateBuffer
            if (not global551) {
                dim-array-2d.i16 global551 21 5
            }
            array-assign-slice global551 gNetStateBuffer 0 21 0 5 0 21 0 5
            array-assign-list gNetStateBuffer 0 21 0 5 [0]
        }
        break-here
    }
}

local-script NetBeginSendLoop@2166 {
    if gNetplayActive {
        if (not gNetStateBuffer) {
            dim-array-2d.i16 gNetStateBuffer 21 5
        }
        if (g_net_smth_me == g_net_smth_master) {
            start-script.order 2165 3
        }
    }
}

local-script maybe_net_send_fatigue@2167 {
    var local0

    for local0 = 1 to gMaxUniqueKid + {
        if r_maybe_net_fatigue_dirty[local0] {
            r_maybe_net_fatigue_dirty[local0] = gKidData[local0][KD-fatigue]
        }
    }
    r_maybe_net_fatigue_dirty[0] = 95
    start-script.rec maybe_smth_net_send_array 40 1 r_maybe_net_fatigue_dirty
}

local-script lsc2168@2168 {
    var local0 local1 local2 local3 local4 local5 local6 local7 local8 local9 local10 local11 local12 local13 local14 local15 local16 local17 local18 local19 local20

    debug-string 0 "no trace"
    array-assign local19 [local2 local3 local4 local5 local6 local7 local8 local9 local10 local11 local12 local13 local14] 0
    local18 = array-get-length local19 - 1
    dim-array.i16 local20 local18
    localize local19
    localize local20
    for local17 = 0 to local18 + {
        if local19[local17] {
            local16 = call-script FindFreeActor
            actor.init local16
            actor.new
            actor.costume local1
            actor.shadow global423
            actor.order -10
            local20[local17] = local16
            put-actor local16 0 0 gCurrentRoom
        }
    }
    while 1 {
        for local17 = 0 to local18 + {
            if local20[local17] {
                local16 = local20[local17]
                local15 = local19[local17]
                actor.init local16
                actor.at (actor-get-x local15) (actor-get-y local15 + local0 - actor-get-elevation local15)
            }
        }
        break-here
    }
    debug-string 0 "trace on"
}

local-script DrawNameUnderKid@2169 kid actor smth_image arg3 {
    var sprite x_offset y_offset _ local8 local9 local10

    for local10 = 10 to 32 + {
        if (sprite-get-image local10 == 0) {
            sprite = local10
            local10 = 32 + 1
        }
    }
    sprite.init sprite
    sprite.new
    sprite.animation-type 0
    sprite.image smth_image
    sprite.update-type 0
    y_offset = 8
    if (in smth_image [114 113]) {
        y_offset = -64
        x_offset = image-get-width smth_image 0 / 2
        sprite.init sprite
        sprite.order 10
    } else {
        start-script GetKidName kid 1
        sprintf local8 "%s" gKidName
        localize local8
        local9 = call-script maybe_draw_text_to_image local8 435 smth_image 0 1
        x_offset = local9 / 2
        sprite.init sprite
        sprite.order -1
    }
    if (in smth_image [114 113]) {
        while (room26 != -1) {
            sprite.init sprite
            sprite.at (actor-get-x actor - x_offset) (actor-get-y actor + y_offset - actor-get-elevation actor)
            break-here
        }
    } else {
        while (room23 == arg3 || room6 == arg3) {
            sprite.init sprite
            sprite.at (actor-get-x actor - x_offset) (actor-get-y actor + y_offset - actor-get-elevation actor)
            break-here
        }
    }
    sprite.init sprite
    sprite.new
}

local-script SetActorFacing@2170 actor new_facing old_facing {
    if (old_facing != new_facing) {
        case old_facing {
            [5 6 4] {
                actor.init actor
                actor.condition [1]
            }
            3 {
                actor.init actor
                actor.condition [2]
            }
            [1 2 16] {
                actor.init actor
                actor.condition [3]
            }
            15 {
                actor.init actor
                actor.condition [4]
            }
            [13 14 12] {
                actor.init actor
                actor.condition [5]
            }
            11 {
                actor.init actor
                actor.condition [6]
            }
            [9 10 8] {
                actor.init actor
                actor.condition [7]
            }
            7 {
                actor.init actor
                actor.condition [8]
            }
            else {
            }
        }
    }
    case new_facing {
        [5 6 4] {
            actor.init actor
            actor.condition [129]
        }
        3 {
            actor.init actor
            actor.condition [130]
        }
        [1 2 16] {
            actor.init actor
            actor.condition [131]
        }
        15 {
            actor.init actor
            actor.condition [132]
        }
        [13 14 12] {
            actor.init actor
            actor.condition [133]
        }
        11 {
            actor.init actor
            actor.condition [134]
        }
        [9 10 8] {
            actor.init actor
            actor.condition [135]
        }
        7 {
            actor.init actor
            actor.condition [136]
        }
        else {
        }
    }
}

local-script ConvertAngleToFacing@2171 angle {
    var result

    case 1 {
        (angle < 23) {
            result = 1
        }
        (angle < 68) {
            result = 3
        }
        (angle < 113) {
            result = 5
        }
        (angle < 158) {
            result = 7
        }
        (angle < 203) {
            result = 9
        }
        (angle < 248) {
            result = 11
        }
        (angle < 293) {
            result = 13
        }
        (angle < 338) {
            result = 15
        }
        (angle < 361) {
            result = 1
        }
        else {
        }
    }
    return result
}

local-script TurnFacingStep@2172 to from arg2 arg3 {
    var result local5

    if (arg3 == 2) {
        local5 = -1 * (1 + arg2)
    } else {
        local5 = 1 * (1 + arg2)
    }
    if arg3 {
        case (abs (from - to)) {
            [0 1 2 14 15] {
                result = to
            }
            else {
                result = from + local5
            }
        }
    } else if (to == from) {
        return to
    } else if (to > from) {
        case (to - from) {
            [1 2 14 15] {
                result = to
            }
            [3 4 5 6 7 8] {
                result = from + local5
            }
            [9 10 11 12 13] {
                result = from - local5
            }
            else {
            }
        }
    } else {
        case (from - to) {
            [1 2 14 15] {
                result = to
            }
            [3 4 5 6 7 8] {
                result = from - local5
            }
            [9 10 11 12 13] {
                result = from + local5
            }
            else {
            }
        }
    }
    if (result > 16) {
        result -= 16
    }
    if (result < 1) {
        result += 16
    }
    return result
}

local-script DrawNameUnderFielder@2173 arg0 {
    if (gDefenseControlledBy != CB-USER) {
        stop-script 0
    }
    if (arg0 != room6) {
        room6 = arg0
        if arg0 {
            start-script.rec DrawNameUnderKid rFieldingOrder[arg0 - 37] (arg0 - 30) 111 room6
        }
    }
}

local-script smth_actor_do_anim@2174 _ actor animation {
    if gNetplayActive {
        if (g_net_smth_me == g_net_smth_master) {
            temp = 1 << (actor - 7)
            g_maybe_net_fielders_dirty_mask = bor g_maybe_net_fielders_dirty_mask temp
        }
    }
    do-animation actor animation
}

local-script HomeRunStuff@2175 {
    var _ local1 _ local3 local4 local5

    local5 = call-script AllocPalette
    palette.init local5
    palette.from-image 1550 0
    palette.end
    start-script smth_actor_palette_team_color (0 - local5) gBattingTeamInfoIndex 0 1
    local4 = call-script FindFreeSprite
    sprite.init local4
    sprite.new
    sprite.image image1550
    sprite.animation-type 0
    sprite.update-type 2
    sprite.order 10000
    sprite.palette local5
    sprite.group 11
    sprite.at 800 240
    local4 = call-script FindFreeSprite
    sprite.init local4
    sprite.new
    sprite.image image1551
    sprite.animation-type 1
    sprite.animation-speed 2
    sprite.update-type 2
    sprite.order 10001
    sprite.palette local5
    sprite.group 11
    sprite.at 800 240
    local4 = call-script FindFreeSprite
    sprite.init local4
    sprite.new
    sprite.image image1552
    sprite.animation-type 0
    sprite.update-type 2
    sprite.order 10000
    sprite.palette local5
    sprite.group 11
    sprite.shadow global423
    sprite.at 800 240
    break-here
    for local3 = 0 to 3 + {
        if (gRunners[local3][R-ORDER] == 3) {
            room21 = 1
        }
    }
    start-script PlayKidMusic gBatterKid 2
    break-here
    if room21 {
        start-script EnqueueComment DIALOGUE-HIT-GRAND-SLAM gBatterKid
    } else {
        start-script EnqueueComment DIALOGUE-HIT-HOME-RUN gBatterKid
    }
    for local1 = 1 to 470 + {
        group.init 11
        group.at (-2 * local1) 0
        if g_maybe_skipped_cutscene {
            local1 = 500
        }
        break-here
    }
    local4 = group-get-array 11
    if local4 {
        for local1 = 1 to local4[0] + {
            start-script ReleaseSprite local4[local1]
            local4[local1] = 0
        }
        undim local4
        group.init 11
        group.new
    }
    start-script FreePalette local5
    break-until (not (sound-running 10000))
}

local-script lsc2176@2176 {
    var local0

    for local0 = 1 to 32 + {
        sprite.init local0
        sprite.new
    }
}

local-script Nop@2177 {
}

local-script lsc2178@2178 {
    room35 = call-script AllocPalette
    room36 = call-script AllocPalette
}

local-script lsc2179@2179 {
    start-script FreePalette room35
    start-script FreePalette room36
}

enter {
    start-script lsc2178
    if gTeeBall {
        r_maybe_disable_powerups = 1
    }
    if g_maybe_disable_powerups {
        r_maybe_disable_powerups = 1
    }
    if (gGameInputDevice == INPUT-DEVICE-GAME-PAD) {
        stop-script GamePadInputLoop
        start-script HideGamePadCursor
    }
    if gNetplayActive {
        if (not gUserOnOffense) {
            if (g_net_smth_me != g_net_smth_master) {
                print-debug.start
                print-debug.string "I am now master!"
                g_net_smth_slave = g_net_smth_me
                g_net_smth_me = g_net_smth_master
            } else {
                print-debug.start
                print-debug.string "I am already master!"
            }
        } else if (g_net_smth_me == g_net_smth_master) {
            print-debug.start
            print-debug.string "I am no longer master!"
            g_net_smth_me = g_net_smth_slave
            g_net_smth_slave = g_net_smth_master
        } else {
            print-debug.start
            print-debug.string "I am already slave!"
        }
    }
    if gNetplayActive {
        global43 = 0
    }
    gBallIsFair = false
    gCommentaryIsIdle = 1
    rDrawnBallDistanceDecal = 0
    rSavedMinJiffies = gMinJiffies
    gMinJiffies = 3
    gGravity = 3
    global95 = 1
    dim-array.i16 rBaseCorners 3
    dim-array-2d.i16 rCommentQueue 4 1
    room13 = gNumOuts
    if (not (global348 == 1) || not gWorld) {
        start-script SetupVectorsAndCamera
    }
    g_he9_play_ended = 0
    g_maybe_he9_play_could_end_soon = 0
    gCollideStuckBoxNumber = 0
    gCollideStuckTickCounter = 0
    start-script smth_field_specific_hacks
    start-script scr273
    if gNetplayActive {
        if (not gNetStateBuffer) {
            dim-array-2d.i16 gNetStateBuffer 21 5
        }
        dim-array.u8 r_maybe_net_fatigue_dirty gMaxUniqueKid
    }
    if gNetplayActive {
        start-script scr343
    }
    if (MODE-BATTING-PRACTICE != gGameMode) {
        object.class 323 [160]
        object.class 324 [160]
        if (gField >= DIRT-YARDS) {
            image.init (485 + gField)
            image.at 0 0
            image.draw
            image.flags 1
            image.end
        }
        start-script lsc2168 0 10 (37 - 30) (38 - 30) (39 - 30) (40 - 30) (41 - 30) (43 - 30) (42 - 30) (44 - 30) (45 - 30) (46 - 30) (47 - 30) (48 - 30) (49 - 30)
        start-script RunHUDScoreboard
    } else {
        print-debug.start
        print-debug.printf "pover-capture-wiz width = %d" (image-get-width image551 0)
        if (image-get-width image551 0 <= 400) {
            image.init (485 + gField)
            image.at 0 0
            image.draw
            image.flags 1
            image.end
            start-script smth_batting_practice_kid_actors
        } else {
            image.init image551
            image.at 0 0
            image.draw
            image.end
        }
        object.class 323 [32]
        image.init image549
        image.at 496 400
        image.draw
        image.end
        if g_smth_play_may_continue {
            object.class 324 [160]
        } else if (not gNoPrinting) {
            object.class 324 [32]
            image.init image549
            image.state 1
            image.at 8 400
            image.draw
            image.end
        } else {
            object.class 324 [160]
        }
        userput-on
        if (gUIInputDevice == INPUT-DEVICE-MOUSE) {
            cursor-on
        } else if (gCursorInputEnabled == 0) {
            stop-script GamePadCursorLoop
            start-script ReleaseSprite gGamePadCursorSprite
            gGamePadCursorSprite = 0
        } else {
            start-script ShowGamePadCursor
        }
    }
}

exit {
    start-script lsc2179
    room26 = -1
    stop-script lsc2168
    if (gField == CEMENT-GARDENS) {
        put-actor global381 0 0 0
    }
    gMinJiffies = rSavedMinJiffies
    global95 = 0
    undim gBallPath
    undim rBaseClaims
    undim rBaseCorners
    undim rCommentQueue
    undim rRunnerStartingBases
    undim rRunnersWhenBallLastThrown
    undim r_runners_zeta
    undim gRunnerSpecialDestinations
    undim gRunnersExtra
    undim r_maybe_net_fatigue_dirty
    undim room28
    undim room29
    global504 = 0
    global565 = 0
    g_maybe_net_fielders_dirty_mask = 0
    gPlayEndedReason = 0
    array-assign-row gWorld 35 [0 0 0 0 0]
    array-assign-row gWorld 36 [0 0 0 0 0]
    gHitPosPhysX = 0
    gHitPosPhysY = 0
    gHitPosPhysZ = 0
    override-off-off
    global43 = 32
    if gNetplayActive {
        if (g_net_smth_me == g_net_smth_master && gNumOuts < 3) {
            gBases[0][BASE-RUNNERIDX] = gBases[0][BASE-RUNNERIDX] + 8000
            start-script.rec maybe_smth_net_send_array 40 1 gBases
            gBases[0][BASE-RUNNERIDX] = gBases[0][BASE-RUNNERIDX] - 8000
            gRunners[0][R-CUR-BASE] = gRunners[0][R-CUR-BASE] + 9000
            start-script.rec maybe_smth_net_send_array 40 1 gRunners
            gRunners[0][R-CUR-BASE] = gRunners[0][R-CUR-BASE] - 9000
        }
        undim gNetStateBuffer
        undim global551
    }
    start-script scr343 1
    if (gGameInputDevice == INPUT-DEVICE-GAME-PAD) {
        start-script GamePadInputLoop
        start-script ShowGamePadCursor
    }
    object.class 323 [160]
    object.class 324 [160]
    start-script lsc2176
    if global384 {
        start-script ReleaseActor global384
        global384 = 0
    }
    g_smth_play_may_continue = 0
    if (not (in gNextRoom [4 3])) {
        start-script SetAmbientSound 0
    }
}

obim {
    raw-block IMHD "overhed/object0073_IMHD.bin"
    im {
        smap "overhed/object73_01.bmp" [124 124 124 124 124 124 124 124 124 124 124 124 124 124 124 124]
        raw-block ZP01 "overhed/object0073_IM01_ZP01.bin"
    }
    im {
        smap "overhed/object73_02.bmp" [124 124 124 124 124 124 124 124 124 124 124 124 124 124 124 124]
        raw-block ZP01 "overhed/object0073_IM02_ZP01.bin"
    }
}
obim {
    raw-block IMHD `4a0000000100000010011001f800c8000000`
}
obim {
    raw-block IMHD `4b000000010000000001b800080198000000`
}
obim {
    raw-block IMHD `4c000000010000007800b800080198000000`
}
obim {
    raw-block IMHD `4d0000000100000078001001f800c8000000`
}
    raw-block OBIM "overhed/OBIM_000961ac.bin"
    raw-block OBIM "overhed/OBIM_0009755a.bin"
    raw-block OBIM "overhed/OBIM_000980ba.bin"
    raw-block OBIM "overhed/OBIM_0009897c.bin"
    raw-block OBIM "overhed/OBIM_0009911e.bin"
    raw-block OBIM "overhed/OBIM_000998bc.bin"
    raw-block OBIM "overhed/OBIM_0009a022.bin"
obim {
    raw-block IMHD `5700000001000000d8013001100010000000`
}
obim {
    raw-block IMHD `4301000001000000f0019001900050000000`
}
obim {
    raw-block IMHD `440100000100000000009001680050000000`
}
object object73@73 "" {
    raw-block CDHD `4900000100008000500000000000000002`
}
object object74@74 "ov-leg1" {
    raw-block CDHD `4a0010011001f800c80000000000000000`
}
object object75@75 "ov-leg2" {
    raw-block CDHD `4b000001b8000801980000000000000000`
}
object object76@76 "ov-leg3" {
    raw-block CDHD `4c007800b8000801980000000000000000`
}
object object77@77 "ov-leg4" {
    raw-block CDHD `4d0078001001f800c80000000000000000`
}
object object78@78 "" {
    raw-block CDHD `4e0000009001a800500000000000000002`
}
object object79@79 "" {
    raw-block CDHD `4f007800a8012000380000000000000002`
}
object object82@82 "" {
    raw-block CDHD `5200000090011800500000000000000002`
}
object object83@83 "" {
    raw-block CDHD `5300480098011000200000000000000002`
}
object object84@84 "" {
    raw-block CDHD `54004800b8011000200000000000000002`
}
object object85@85 "" {
    raw-block CDHD `5500600098011000200000000000000002`
}
object object86@86 "" {
    raw-block CDHD `56006000b8011000200000000000000002`
}
object object87@87 "" {
    raw-block CDHD `5700d80130011000100000000000000000`

    verb 1 {
    }
}
object object323@323 "" {
    raw-block CDHD `4301f00190019000500000000000000000`

    verb 1 {
        userput-off
        if (gUIInputDevice == INPUT-DEVICE-MOUSE) {
            cursor-off
        } else if (gCursorInputEnabled == 0) {
            stop-script GamePadCursorLoop
            start-script ReleaseSprite gGamePadCursorSprite
            gGamePadCursorSprite = 0
        } else {
            start-script ShowGamePadCursor
        }
        start-script PlayClickySound
        break-here
        if g_smth_play_may_continue {
            gMinJiffies = 0
        } else {
            current-room batview
        }
    }
}
object object324@324 "" {
    raw-block CDHD `4401000090016800500000000000000000`

    verb 1 {
        userput-off
        if (gUIInputDevice == INPUT-DEVICE-MOUSE) {
            cursor-off
        } else if (gCursorInputEnabled == 0) {
            stop-script GamePadCursorLoop
            start-script ReleaseSprite gGamePadCursorSprite
            gGamePadCursorSprite = 0
        } else {
            start-script ShowGamePadCursor
        }
        start-script PlayClickySound
        break-here
        print-image image551
        break-here
        userput-on
        if (gUIInputDevice == INPUT-DEVICE-MOUSE) {
            cursor-on
        } else if (gCursorInputEnabled == 0) {
            stop-script GamePadCursorLoop
            start-script ReleaseSprite gGamePadCursorSprite
            gGamePadCursorSprite = 0
        } else {
            start-script ShowGamePadCursor
        }
    }
}
akos costume10@10 {
    raw-block AKHD `010000802000010001001000`
    akpl "overhed/costume10/AKPL.bin"
    raw-block RGBS "overhed/costume10/RGBS.bin"
    raw-block AKSQ `c0210b010001f9fffeff00c0300000c0ff`
    raw-block AKCH "overhed/costume10/AKCH.bin"
    akcd byle "overhed/costume10/cel_0000_AKCD.bmp"
    raw-block AKLC `20000000`
    raw-block AKST `0000000000000000`
    raw-block AKCT "overhed/costume10/AKCT.bin"
}
awiz image111@111 {
    raw-block CNVS `10000000d0010000`
    raw-block RELO `08000000c8010000`
    wizh
    wizd 1 "overhed/image111.bmp"
}
awiz image112@112 {
    raw-block CNVS `10000000d0010000`
    raw-block RELO `08000000c8010000`
    wizh
    wizd 1 "overhed/image112.bmp"
}
awiz image113@113 {
    rgbs
    raw-block CNVS `80020000e0010000`
    raw-block RELO `2c010000b0000000`
    wizh
    wizd 1 "overhed/image113.bmp"
}
awiz image114@114 {
    rgbs
    raw-block CNVS `80020000e0010000`
    raw-block RELO `37010000b0000000`
    wizh
    wizd 1 "overhed/image114.bmp"
}
